{
  "version": "kolega-v1.0",
  "errors": [],
  "results": [
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00006.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Header Input in ProcessBuilder\n\nUser-controlled input from HTTP header 'BenchmarkTest00006' is concatenated directly into an OS command string without sanitization. The header value flows through URLDecoder.decode() and is concatenated into 'echo ' + param, which is then passed to ProcessBuilder.command(). An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can achieve remote code execution on the server by injecting shell commands through the HTTP header. For example, sending 'test; cat /etc/passwd' would execute both the echo command and the injected cat command, allowing full system compromise.\n\nFix: Never concatenate user input into shell commands. Use parameterized command execution by passing arguments as separate array elements. If the echo command must include user input, pass it as a separate argument: argList.add('echo'); argList.add(param); This prevents shell interpretation of metacharacters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00008.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled input from HTTP header 'BenchmarkTest00008' is concatenated directly into a SQL callable statement string without sanitization. The header value flows through URLDecoder.decode() and is concatenated into '{call ' + param + '}', which is then passed to connection.prepareCall(). While prepareCall() is used, the SQL string is already constructed via concatenation, so it does not provide protection against SQL injection.\n\nImpact: An attacker can execute arbitrary SQL commands by injecting SQL syntax through the HTTP header. For example, sending 'proc1()}; DROP TABLE users; --' could terminate the intended call and execute additional malicious SQL statements, leading to data theft, modification, or deletion.\n\nFix: Use parameterized callable statements with placeholders instead of string concatenation. Example: String sql = '{call myProcedure(?)}'; CallableStatement stmt = connection.prepareCall(sql); stmt.setString(1, param); This ensures user input is treated as data, not executable SQL code.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00015.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Command Argument\n\nUser input from the 'BenchmarkTest00015' HTTP header is URL-decoded and directly concatenated into a shell command string ('echo ' + param) that is passed to ProcessBuilder. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands with the privileges of the web application, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into shell commands. Use ProcessBuilder with separate arguments (not shell=true), or validate input against a strict whitelist. Use ESAPI.encoder().encodeForOS() if shell execution is unavoidable.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00017.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via String Concatenation in Runtime.exec()\n\nUser input from the 'BenchmarkTest00017' HTTP header is URL-decoded and directly concatenated to a command string that is passed to Runtime.exec(). An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands with the privileges of the web application, leading to complete system compromise, data theft, or denial of service.\n\nFix: Use ProcessBuilder with separate command arguments instead of Runtime.exec() with string concatenation. Validate input against a strict whitelist, or use ESAPI.encoder().encodeForOS() to sanitize shell metacharacters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00018.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Query\n\nUser input from the 'BenchmarkTest00018' HTTP header is URL-decoded and directly concatenated into a SQL INSERT statement without parameterization. An attacker can inject SQL syntax to modify the query structure.\n\nImpact: An attacker can manipulate the database by injecting SQL commands, potentially leading to data theft, data modification, authentication bypass, or complete database compromise.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, param);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00021.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input\n\nUser input from request parameter 'BenchmarkTest00021' is directly concatenated into an LDAP filter string without sanitization. The param variable is obtained from request.getParameter() and concatenated into the LDAP filter, allowing an attacker to inject malicious LDAP syntax.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, access unauthorized data, or enumerate directory information by injecting LDAP metacharacters.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize the user input before concatenating it into the LDAP filter, or use parameterized LDAP queries if available.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00024.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser input from request parameter 'BenchmarkTest00024' is directly concatenated into a SQL query string. Although a PreparedStatement is used, the param variable is concatenated into the SQL string itself rather than being bound as a parameter, making it vulnerable to SQL injection.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized binding for all user inputs. Replace the string concatenation with a placeholder and bind param using statement.setString(2, param).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00025.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBC Query\n\nUser input from request parameter 'BenchmarkTest00025' is directly concatenated into a SQL query string that is executed via Spring's JDBCtemplate.queryForObject(). This allows SQL injection attacks.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use Spring's parameterized query methods with placeholders. Replace with: sql = \"SELECT userid from USERS where USERNAME='foo' and PASSWORD=?\"; and use queryForObject(sql, Long.class, param).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00026.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBC Query\n\nUser input from request parameter 'BenchmarkTest00026' is directly concatenated into a SQL query string that is executed via Spring's JDBCtemplate.queryForRowSet(). This allows SQL injection attacks.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use Spring's parameterized query methods with placeholders. Replace with: sql = \"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"; and use queryForRowSet(sql, param).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00027.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in INSERT Statement\n\nUser input from request parameter 'BenchmarkTest00027' is directly concatenated into a SQL INSERT statement that is executed via statement.executeUpdate(). This allows SQL injection attacks.\n\nImpact: An attacker can inject malicious SQL code to insert arbitrary data, execute multiple statements, or perform other database operations beyond the intended INSERT.\n\nFix: Use PreparedStatement with parameterized binding. Replace with: sql = \"INSERT INTO users (username, password) VALUES ('foo', ?)\"; and use preparedStatement.setString(1, param).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00032.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from request parameter 'BenchmarkTest00032' is concatenated directly into a SQL query without parameterization. The SQL query constructs a WHERE clause by concatenating the param variable: \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + param + \"'\". This allows an attacker to inject arbitrary SQL commands.\n\nImpact: An attacker can execute arbitrary SQL queries, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise. For example, an attacker could use input like \"' OR '1'='1\" to bypass authentication or \"'; DROP TABLE USERS--\" to delete data.\n\nFix: Use parameterized queries (PreparedStatement) instead of string concatenation. Replace the vulnerable code with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, param);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00033.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from request parameter 'BenchmarkTest00033' is concatenated directly into a SQL query without parameterization. The SQL query constructs a WHERE clause by concatenating the param variable: \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + param + \"'\". This allows an attacker to inject arbitrary SQL commands.\n\nImpact: An attacker can execute arbitrary SQL queries, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise. The queryForRowSet method will execute the malicious SQL, allowing attackers to extract sensitive data or manipulate the database.\n\nFix: Use parameterized queries (PreparedStatement) instead of string concatenation. Replace the vulnerable code with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, param);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00034.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from request parameter 'BenchmarkTest00034' is concatenated directly into a SQL query without parameterization. The SQL query constructs a WHERE clause by concatenating the param variable: \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + param + \"'\". This allows an attacker to inject arbitrary SQL commands.\n\nImpact: An attacker can execute arbitrary SQL queries, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise. The statement.execute() method will execute the malicious SQL with RETURN_GENERATED_KEYS flag, potentially exposing additional sensitive information.\n\nFix: Use parameterized queries (PreparedStatement) instead of string concatenation. Replace the vulnerable code with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, param);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00037.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from request parameter name is concatenated directly into a SQL query without parameterization. The SQL query constructs a WHERE clause by concatenating the param variable: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + param + \"'\". While the USERNAME is parameterized, the PASSWORD field uses string concatenation, allowing SQL injection.\n\nImpact: An attacker can execute arbitrary SQL queries by manipulating the parameter name. Despite partial parameterization, the concatenated portion allows injection attacks. For example, an attacker could use a parameter name like \"' OR '1'='1\" to bypass authentication or inject other malicious SQL.\n\nFix: Fully parameterize the query. Replace with: String sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\"; statement.setString(1, \"foo\"); statement.setString(2, param);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00038.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from request parameter name is concatenated directly into a SQL query without parameterization. The SQL query constructs a WHERE clause by concatenating the param variable: \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + param + \"'\". This allows an attacker to inject arbitrary SQL commands.\n\nImpact: An attacker can execute arbitrary SQL queries, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise. The Spring JDBCtemplate.query method will execute the malicious SQL, allowing attackers to extract sensitive data or manipulate the database.\n\nFix: Use parameterized queries instead of string concatenation. Replace with: String sql = \"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"; and use JDBCtemplate methods that support parameter binding, such as query(sql, new Object[]{param}, rowMapper).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00039.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from request parameter name is concatenated directly into a SQL query without parameterization. The SQL query constructs a WHERE clause by concatenating the param variable: \"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='\" + param + \"'\". This allows an attacker to inject arbitrary SQL commands.\n\nImpact: An attacker can execute arbitrary SQL queries, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise. The queryForMap method will execute the malicious SQL, allowing attackers to extract sensitive data or manipulate the database.\n\nFix: Use parameterized queries instead of string concatenation. Replace with: String sql = \"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD=?\"; and use JDBCtemplate methods that support parameter binding, such as queryForMap(sql, new Object[]{param}).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00043.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from SeparateClassRequest.getTheParameter() is concatenated directly into a SQL query string without parameterization or sanitization. The query is then executed using Statement.executeUpdate().\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, param);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00044.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via String Concatenation\n\nUser-controlled input from request.getParameterValues() is concatenated directly into an LDAP filter string without sanitization. This allows attackers to manipulate the LDAP query structure.\n\nImpact: An attacker can inject LDAP filter metacharacters to bypass authentication, access unauthorized data, or enumerate directory information.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize the input before concatenation: String filter = \"(&(objectclass=person)(uid=\" + ESAPI.encoder().encodeForLDAP(param) + \"))\";",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00052.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in CallableStatement\n\nUser input from SeparateClassRequest is concatenated directly into a SQL callable statement without sanitization. While prepareCall() is used, the SQL string itself is constructed via string concatenation with user input, making it vulnerable to SQL injection.\n\nImpact: An attacker can inject malicious SQL code to read, modify, or delete database contents, bypass authentication, or execute administrative operations on the database.\n\nFix: Use parameterized callable statements with placeholders instead of string concatenation. Example: connection.prepareCall(\"{call stored_proc(?)}\") and then set parameters using statement.setString(1, param).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00077.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Cookie Data\n\nUser-controlled data from a cookie flows through a switch statement (where guess.charAt(2) = 'C', matching case 'C' which assigns param to bar) and is then concatenated directly into an OS command without sanitization. The command 'echo ' + bar is executed via ProcessBuilder, allowing an attacker to inject arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server by injecting shell metacharacters in the cookie value. This could lead to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into shell commands. Use parameterized command execution or validate/sanitize input strictly. Consider using ESAPI.encoder().encodeForOS() or avoid shell execution entirely by using direct API calls instead of shell commands.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00091.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled data from a cookie flows directly into the environment variables parameter (argsEnv) of Runtime.exec(). The cookie value 'BenchmarkTest00091' is decoded and assigned to 'param', then to 'bar', which is then passed as an environment variable to exec(). An attacker can inject malicious environment variables that could affect command execution.\n\nImpact: An attacker can inject arbitrary environment variables that may alter the behavior of the executed command, potentially leading to command injection or information disclosure.\n\nFix: Validate and sanitize the cookie value before using it in environment variables. Use a whitelist approach to only allow expected values. Consider using ProcessBuilder with explicit environment variable handling.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00092.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables with Switch Statement\n\nThe switch statement evaluates 'ABC'.charAt(2) which is 'C'. Case 'C' assigns user-controlled 'param' (from cookie) to 'bar', which then flows into the environment variables of Runtime.exec(). This allows command injection via environment variable manipulation.\n\nImpact: An attacker can inject arbitrary environment variables through the cookie value, potentially leading to command injection or altering command behavior.\n\nFix: Validate and sanitize cookie values before using them in environment variables. Use a whitelist approach for allowed values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00093.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via String Concatenation\n\nAfter list manipulation, 'bar' contains 'moresafe' (the element at index 1 after removing index 0). The list starts as ['safe', param, 'moresafe'], then after remove(0) becomes [param, 'moresafe']. So bar = valuesList.get(1) retrieves 'moresafe', which is a safe constant. However, the pattern of concatenating user input directly into command strings is dangerous if the data flow changes.\n\nImpact: While the current data flow is safe, the code pattern is vulnerable to command injection if the list manipulation logic changes.\n\nFix: Use ProcessBuilder with separate command and arguments instead of string concatenation. Validate all inputs before use in commands.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00100.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from a cookie is retrieved from a HashMap and concatenated directly into a SQL query string. While the query uses a PreparedStatement for the USERNAME parameter, the PASSWORD portion uses string concatenation with the user-controlled 'bar' variable, creating a SQL injection vulnerability.\n\nImpact: An attacker can inject arbitrary SQL commands through the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for ALL user inputs. Replace the string concatenation with a proper parameter binding: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and use statement.setString(2, bar) to bind the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00101.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Value in List Manipulation\n\nUser-controlled cookie value flows into a SQL query via string concatenation. The cookie value is extracted, placed in a list, and after removing the first element, the user input (originally at index 1) becomes the value at index 0, which is then concatenated into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a PreparedStatement parameter: statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00102.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Value Through Pass-Through Method\n\nUser-controlled cookie value is passed through ThingFactory.createThing().doSomething() which is a pass-through method that returns its input unchanged. The tainted value is then concatenated into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement instead of string concatenation for SQL queries.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00103.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Value in Ternary Expression\n\nUser-controlled cookie value flows into a SQL query via string concatenation. The ternary expression (7*42) - 106 > 200 evaluates to false (188 > 200), so bar is assigned the user-controlled param value, which is then concatenated into a SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement instead of string concatenation for SQL queries.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00106.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Value in List Manipulation\n\nUser-controlled cookie value flows into a SQL query via string concatenation. The cookie value is extracted, placed in a list at index 1, and after removing the first element (index 0), the user input moves to index 0 and is retrieved, then concatenated into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement instead of string concatenation for SQL queries.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00108.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Value in Switch Statement\n\nUser-controlled cookie value flows into a SQL query via string concatenation. The switch statement evaluates guess.charAt(2) which is 'C', and case 'C' assigns param (the user-controlled cookie value) to bar, which is then concatenated into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement instead of string concatenation for SQL queries.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00109.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Value After Base64 Encoding\n\nUser-controlled cookie value is Base64 encoded and decoded (which does not sanitize SQL injection), then concatenated into a SQL query without proper parameterization. Base64 encoding is not a security control against SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement instead of string concatenation for SQL queries. Base64 encoding does not prevent SQL injection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00111.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value flows into SQL query via string concatenation. The cookie value 'BenchmarkTest00111' is retrieved, URL-decoded, placed in a list, and after removing the first element, the user input becomes the first element (bar). This tainted value is then concatenated directly into an INSERT SQL statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql) with PreparedStatement.setString() for the bar parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00112.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter with Pass-Through\n\nUser-controlled cookie value flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is concatenated directly into an INSERT SQL statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql) with PreparedStatement.setString() for the bar parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00115.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value is stored in HashMap with key 'keyB-11928' and then retrieved with the same key. The tainted value is concatenated directly into an INSERT SQL statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql) with PreparedStatement.setString() for the bar parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00159.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Custom Header through ThingFactory\n\nUser-controlled data from the BenchmarkTest00159 header flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) into a shell command without sanitization. The tainted value is concatenated into the command string 'echo ' + bar and executed via ProcessBuilder.\n\nImpact: An attacker could execute arbitrary operating system commands, leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to shell commands. If necessary, use strict input validation with a whitelist of allowed characters, or use parameterized APIs that don't invoke a shell.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00172.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request header flows through a HashMap and is placed directly into the environment variables array (argsEnv) of Runtime.exec(). The variable 'bar' is retrieved from map59408.get(\"keyB-59408\") which contains the user-supplied 'param' value. This allows an attacker to inject malicious environment variables that could be exploited by the executed command.\n\nImpact: An attacker can inject arbitrary environment variables that may be used by the executed process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in environment variables. Use a whitelist approach to only allow known-safe values. Consider using ESAPI.encoder().encodeForOS() to sanitize the input, or avoid using user input in environment variables entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00173.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request header flows through a HashMap and is placed directly into the environment variables array (argsEnv) of Runtime.exec(). The variable 'bar' is retrieved from map68097.get(\"keyB-68097\") which contains the user-supplied 'param' value.\n\nImpact: An attacker can inject arbitrary environment variables that may be used by the executed process, potentially leading to command injection, privilege escalation, or information disclosure.\n\nFix: Validate and sanitize all user input before using it in environment variables. Use a whitelist approach to only allow known-safe values, or avoid using user input in environment variables entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00174.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request header flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is placed directly into the environment variables array (argsEnv) of Runtime.exec(). The variable 'bar' contains the user-supplied 'param' value.\n\nImpact: An attacker can inject arbitrary environment variables that may be used by the executed process, potentially leading to command injection, privilege escalation, or information disclosure.\n\nFix: Validate and sanitize all user input before using it in environment variables. Use a whitelist approach to only allow known-safe values, or avoid using user input in environment variables entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00176.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nUser-controlled input from request header is directly concatenated into the command string passed to Runtime.exec(). The variable 'bar' contains the unsanitized 'param' value from the request header, which is concatenated with 'cmd'. This allows an attacker to inject arbitrary commands.\n\nImpact: An attacker can execute arbitrary system commands with the privileges of the application, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into command strings. Use parameterized command execution with String arrays, and validate/sanitize all user input. Consider using ESAPI.encoder().encodeForOS() or a whitelist approach.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00177.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nUser-controlled input from request header flows through a conditional statement but the condition (7*42 - 86 = 208 > 200) is always true, so 'bar' is assigned the constant \"This_should_always_happen\". However, the arithmetic evaluation shows: (7*42) - 86 = 294 - 86 = 208, and 208 > 200 is TRUE. Therefore, bar is assigned the safe constant, not param. This is NOT a vulnerability in the current code.\n\nImpact: None - the current code is secure as bar receives a constant value.\n\nFix: No action needed for current implementation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00192.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SQL Query\n\nUser-controlled input from the HTTP header 'BenchmarkTest00192' flows into a SQL query through string concatenation. The switch statement evaluates guess.charAt(2) which equals 'C', causing the case 'C' branch to execute and assign the tainted param to bar. This tainted value is then concatenated directly into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00192 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) for all user input. Replace the string concatenation with a parameter placeholder and bind the bar variable using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00193.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SQL Query\n\nUser-controlled input from the HTTP header 'BenchmarkTest00193' flows into a SQL query through string concatenation. The condition (500/42)+196 evaluates to 207, which is greater than 200, causing bar to be assigned the tainted param value. This tainted value is then concatenated directly into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00193 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) for all user input. Replace the string concatenation with a parameter placeholder and bind the bar variable using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00194.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SQL Query\n\nUser-controlled input from the HTTP header 'BenchmarkTest00194' flows into a SQL query through string concatenation. Although the input is Base64 encoded and then decoded, this provides no security benefit and the bar variable remains tainted. The tainted value is concatenated directly into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00194 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) for all user input. Replace the string concatenation with a parameter placeholder and bind the bar variable using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00195.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SQL Query\n\nUser-controlled input from the HTTP header 'BenchmarkTest00195' flows into a SQL query through string concatenation. The ternary condition (7*42)-106 evaluates to 188, which is NOT greater than 200, causing bar to be assigned the tainted param value. This tainted value is concatenated directly into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00195 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) for all user input. Replace the string concatenation with a parameter placeholder and bind the bar variable using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00196.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SQL Query\n\nUser-controlled input from the HTTP header 'BenchmarkTest00196' flows into a SQL query through string concatenation. The condition (500/42)+196 evaluates to 207, which is greater than 200, causing bar to be assigned the tainted param value. This tainted value is concatenated directly into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00196 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) for all user input. Replace the string concatenation with a parameter placeholder and bind the bar variable using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00198.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SQL Query\n\nUser-controlled input from the HTTP header 'BenchmarkTest00198' flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) into a SQL query through string concatenation. The tainted bar value is concatenated directly into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00198 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) for all user input. Replace the string concatenation with a parameter placeholder and bind the bar variable using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00199.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SQL Query\n\nUser-controlled input from the HTTP header 'BenchmarkTest00199' flows into a SQL query through string concatenation. The condition (500/42)+196 evaluates to 207, which is greater than 200, causing bar to be assigned the tainted param value. This tainted value is concatenated directly into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00199 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) for all user input. Replace the string concatenation with a parameter placeholder and bind the bar variable using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00203.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via User-Controlled Header\n\nUser input from the 'BenchmarkTest00203' HTTP header flows directly into a SQL query via string concatenation. The ternary condition at line 54 evaluates to: (7*42) - 106 = 294 - 106 = 188, and 188 > 200 is FALSE, so bar is assigned param (user input). This tainted value is then concatenated into the SQL INSERT statement at line 56.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00203 header, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql, ...) with a PreparedStatement that binds the bar variable using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00204.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Pass-Through Helper Method\n\nUser input from the 'BenchmarkTest00204' HTTP header is passed through ThingFactory.createThing().doSomething(), which is a pass-through method that returns its input unchanged. The tainted value is then concatenated into a SQL INSERT statement without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00204 header, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql, ...) with a PreparedStatement that binds the bar variable using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00207.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection via User-Controlled Header\n\nUser input from the 'BenchmarkTest00207' HTTP header is Base64 encoded/decoded (which does not sanitize special characters) and then directly concatenated into an XPath expression. The bar variable contains unsanitized user input that is interpolated into the XPath query at line 68.\n\nImpact: An attacker can manipulate the XPath query logic by injecting special characters (e.g., single quotes) to bypass authentication, access unauthorized data, or extract sensitive information from the XML document.\n\nFix: Use parameterized XPath queries or validate/sanitize the input by checking for and rejecting single quotes before building the XPath expression. Alternatively, use XPath variable binding if supported by the implementation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00293.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Custom Header\n\nUser-controlled data from the BenchmarkTest00293 header is used directly in a shell command without sanitization. The header value is Base64 encoded/decoded (which provides no security benefit) and then concatenated into an 'echo' command that is executed via ProcessBuilder. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into shell commands. Use parameterized command execution or validate/sanitize input using ESAPI.encoder().encodeForOS(). Better yet, avoid shell execution entirely and use Java APIs for the required functionality.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00294.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Custom Header\n\nUser-controlled data from the BenchmarkTest00294 header flows into a shell command. The ternary condition '(7*42) - 106 > 200' evaluates to '294 - 106 = 188 > 200' which is FALSE, so bar is assigned param (user input). This tainted value is then concatenated into an 'echo' command executed via ProcessBuilder, allowing command injection.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into shell commands. Use parameterized command execution or validate/sanitize input using ESAPI.encoder().encodeForOS(). Better yet, avoid shell execution entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00295.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Custom Header\n\nUser-controlled data from the BenchmarkTest00295 header flows into a shell command. The ternary condition '(7*42) - 106 > 200' evaluates to FALSE (188 > 200 is false), so bar is assigned param (user input). This tainted value is then concatenated into an 'echo' command in a String array executed via ProcessBuilder, allowing command injection.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into shell commands. Use parameterized command execution or validate/sanitize input using ESAPI.encoder().encodeForOS(). Better yet, avoid shell execution entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00302.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via HTTP Header\n\nUser input from the BenchmarkTest00302 HTTP header flows through a ternary condition where the arithmetic evaluates to false ((7*42) - 106 = 188, which is not > 200), causing param to be assigned to bar. This tainted value is then concatenated directly into an OS command string and executed via Runtime.exec().\n\nImpact: An attacker can execute arbitrary operating system commands by injecting shell metacharacters in the HTTP header, potentially leading to complete system compromise, data exfiltration, or denial of service.\n\nFix: Never concatenate user input into OS commands. Use parameterized command execution with a fixed command and pass user input as separate arguments in the args array. Validate and sanitize all user input against a whitelist of allowed characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00303.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via HTTP Header in Command Arguments\n\nUser input from the BenchmarkTest00303 HTTP header is Base64 encoded and decoded (which is a pass-through operation that doesn't sanitize), then placed directly into the command arguments array. While using an args array is better than string concatenation, the user input can still contain shell metacharacters that will be interpreted when the command is executed.\n\nImpact: An attacker can inject malicious command arguments or shell metacharacters via the HTTP header, potentially executing arbitrary commands, reading sensitive files, or compromising the system.\n\nFix: Validate user input against a strict whitelist of allowed characters before including it in command arguments. Consider using ESAPI.encoder().encodeForOS() to sanitize the input, or avoid using user input in OS commands entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00304.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via HTTP Header After List Manipulation\n\nUser input from the BenchmarkTest00304 HTTP header is added to a list, the first element is removed, and then the user input (now at index 0) is retrieved and used in OS command arguments. The list manipulation does not sanitize the tainted data, which flows directly into Runtime.exec().\n\nImpact: An attacker can inject malicious command arguments or shell metacharacters via the HTTP header, leading to arbitrary command execution and potential system compromise.\n\nFix: Validate and sanitize user input before using it in OS commands. Use ESAPI.encoder().encodeForOS() or implement strict whitelist validation. Avoid using user input in command execution when possible.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00306.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from the BenchmarkTest00306 HTTP header flows through a conditional where the arithmetic evaluates to true ((500/42) + 196 = 207 > 200), causing param to be assigned to bar. This tainted value is then passed as an environment variable to Runtime.exec(). While less common, command injection via environment variables is possible as malicious environment variables can affect command execution behavior.\n\nImpact: An attacker can inject malicious environment variables that may influence command execution, potentially leading to arbitrary code execution, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before passing it as environment variables. Use a whitelist approach to allow only known-safe values. Consider whether user input is necessary in environment variables at all.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00311.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from the HTTP header 'BenchmarkTest00311' flows into the environment variables parameter (envp) of Runtime.exec(). The input is retrieved from request.getHeaders(), URL-decoded, and assigned to 'bar' through a switch statement (guess.charAt(2) = 'C' leads to case 'C' which assigns param to bar). This tainted value is then placed in the argsEnv array and passed as the second parameter to Runtime.exec(), allowing an attacker to inject malicious environment variables that could alter command execution behavior.\n\nImpact: An attacker can inject arbitrary environment variables by manipulating the BenchmarkTest00311 HTTP header. This can lead to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables. For example, attackers could inject LD_PRELOAD to load malicious libraries or PATH to redirect command execution.\n\nFix: Do not pass user-controlled input into the environment variables parameter of Runtime.exec(). If environment variables must be set based on user input, implement strict input validation using a whitelist approach. Consider using ProcessBuilder with a controlled environment map, and validate all inputs against a whitelist of allowed values before adding them to the environment.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00328.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from the 'BenchmarkTest00328' HTTP header is concatenated directly into a SQL query string. The condition (7 * 42) - 106 > 200 evaluates to FALSE (188 is not > 200), so bar is assigned the user-controlled param value. This value is then concatenated into the SQL string '{call ' + bar + '}' without any sanitization or parameterization. The query is executed via connection.prepareCall(), which does not prevent injection when the SQL string itself contains user data.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise. The attacker could extract sensitive information, bypass authentication, or execute administrative operations.\n\nFix: Use parameterized queries or prepared statements with bound parameters. Never concatenate user input directly into SQL strings. For stored procedure calls, use CallableStatement with parameter binding via registerOutParameter() and setString() methods instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00335.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Header Parameter\n\nUser-controlled data from the 'BenchmarkTest00335' HTTP header is concatenated directly into a SQL query without sanitization. The condition `(500 / 42) + 196 = 207 > 200` evaluates to true, causing `bar = param` to execute, making `bar` contain tainted user input. This tainted value is then concatenated into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00335 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter binding: `statement.setString(2, bar)` and modify the SQL to use `?` placeholders for all user input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00337.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Header Parameter in List Manipulation\n\nUser-controlled data from the 'BenchmarkTest00337' HTTP header flows into a SQL query through list manipulation. The code adds param to a list, removes the first safe element, then retrieves param at index 0. The tainted value is concatenated directly into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00337 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter binding and use PreparedStatement.setString() for all user-controlled values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00339.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Header Parameter in Ternary Expression\n\nUser-controlled data from the 'BenchmarkTest00339' HTTP header is concatenated directly into a SQL query. The ternary condition `(7 * 42) - 106 = 188 > 200` evaluates to false, causing `bar = param` to execute with tainted user input. This value is then concatenated into the SQL query string without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00339 header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter binding using PreparedStatement.setString() for all user-controlled values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00341.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from HTTP header 'BenchmarkTest00341' is URL-decoded and flows into the variable 'bar' via a conditional assignment. The condition (500/42) + 196 = 11 + 196 = 207 > 200 is always true, so bar = param (tainted). This tainted value is concatenated directly into a SQL query string without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00341 header, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00342.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from HTTP header 'BenchmarkTest00342' is URL-decoded and added to a list. After removing the first element ('safe'), the list becomes [param, 'moresafe']. bar = valuesList.get(0) retrieves param (tainted). This tainted value is concatenated directly into a SQL query string without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00342 header, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00407.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Runtime.exec()\n\nUser input from request parameter 'BenchmarkTest00407' flows into the command execution sink. The param value is added to a list, the first element is removed, and then the param (now at index 0) is retrieved and used in Runtime.exec(). After 'valuesList.remove(0)', the list becomes [param, 'moresafe'], so 'valuesList.get(0)' returns the tainted param value which flows into the command execution.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to system commands. If necessary, use a whitelist of allowed values or properly sanitize input. Consider using ProcessBuilder with separate arguments instead of shell execution.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00409.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Runtime.exec()\n\nUser input from request parameter 'BenchmarkTest00409' flows into the command execution sink. The code uses a switch statement with 'guess.charAt(2)' which evaluates to 'C'. Case 'C' assigns param to bar, making bar tainted. This tainted value then flows into Runtime.exec().\n\nImpact: An attacker can execute arbitrary operating system commands on the server, leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to system commands. If necessary, use a whitelist of allowed values or properly sanitize input. Consider using ProcessBuilder with separate arguments instead of shell execution.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00428.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request.getParameter() is added to a list, and after removing the first element, the user input (now at index 0) is retrieved and concatenated directly into a SQL query string. After remove(0), the list becomes [param, 'moresafe'], so get(0) returns the tainted param value. While the USERNAME uses parameterized binding, the PASSWORD field uses string concatenation with user input.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00428 parameter, potentially leading to unauthorized data access, data modification, authentication bypass, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement with setString) for ALL user inputs in SQL queries. Replace the string concatenation with a parameterized placeholder: \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and use statement.setString(2, bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00429.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request.getParameter() is assigned to bar via a ternary expression. The condition (294 - 106 = 188) > 200 evaluates to FALSE, so bar = param. This user input is then concatenated directly into a SQL query string. While USERNAME uses parameterized binding, PASSWORD uses string concatenation.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00429 parameter, potentially leading to unauthorized data access, data modification, authentication bypass, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement with setString) for ALL user inputs in SQL queries. Replace the string concatenation with a parameterized placeholder: \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and use statement.setString(2, bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00431.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest00431' flows into a SQL query through string concatenation. The ternary condition (7*42)-106 > 200 evaluates to 188 > 200 which is false, so bar is assigned the user-controlled param value. This tainted value is then concatenated directly into the SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00433.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest00433' flows into a SQL query through string concatenation. The condition (500/42)+196 > 200 evaluates to 207 > 200 which is true, so bar is assigned the user-controlled param value. This tainted value is then concatenated directly into the SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00434.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest00434' flows through ThingFactory.createThing().doSomething() (a pass-through method that returns input unchanged) and is then concatenated directly into a SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00435.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest00435' is stored in a HashMap under key 'keyB-86691' and then retrieved back into the bar variable. This tainted value is then concatenated directly into a SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00438.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest00438' flows into a SQL query through string concatenation. The ternary condition (7*42)-106 > 200 evaluates to 188 > 200 which is false, so bar is assigned the user-controlled param value. This tainted value is then concatenated directly into the SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00439.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest00439' is directly assigned to the bar variable and then concatenated into a SQL query without any sanitization or parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00441.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest00441' flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) into variable 'bar', which is then concatenated directly into a SQL query string. The query is executed using Statement.executeUpdate() without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement pstmt = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); pstmt.setString(1, bar); pstmt.executeUpdate();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00472.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via printf with User Input\n\nUser input from request parameter 'BenchmarkTest00472' flows directly into the HTTP response via printf() without any sanitization. The condition (500/42)+196 = 11+196 = 207 > 200 is always true, so bar is always assigned the unsanitized param value. The X-XSS-Protection header is disabled. This allows attackers to inject arbitrary JavaScript.\n\nImpact: Attackers can inject malicious JavaScript that executes in victims' browsers, enabling session hijacking, credential theft, malware distribution, or complete account compromise.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape() before outputting user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00473.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String Injection\n\nUser input from request parameter 'BenchmarkTest00473' is Base64 encoded then decoded (which returns the original value unchanged) and used as the FORMAT STRING in printf(). This allows attackers to control the format string itself, not just the arguments. An attacker can inject format specifiers like %s, %d, or %n to read from or write to memory, or inject HTML/JavaScript that gets rendered. The X-XSS-Protection header is disabled.\n\nImpact: Attackers can inject malicious JavaScript via the format string, leading to XSS attacks. Additionally, format string vulnerabilities can potentially cause information disclosure or denial of service through malformed format specifiers.\n\nFix: Never use user input as a format string. Use a hardcoded format string and pass user input only as arguments. Apply HTML encoding to user input before output. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00475.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via println with User Input\n\nUser input from request parameter 'BenchmarkTest00475' flows directly into the HTTP response without sanitization. The condition (500/42)+196 = 11+196 = 207 > 200 is always true, so bar is always assigned the unsanitized param value. The X-XSS-Protection header is disabled.\n\nImpact: Attackers can inject malicious JavaScript that executes in victims' browsers, enabling session hijacking, credential theft, or account compromise.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape() before outputting user input. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00477.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via println with User Input\n\nUser input from request parameter 'BenchmarkTest00477' is concatenated with '_SafeStuff' and output to the HTTP response without sanitization. Appending safe content to tainted input does not sanitize it. The X-XSS-Protection header is disabled.\n\nImpact: Attackers can inject malicious JavaScript that executes in victims' browsers, enabling session hijacking, credential theft, or account compromise.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape() before outputting user input. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00478.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via write with User Input\n\nUser input from request parameter 'BenchmarkTest00478' is Base64 encoded then decoded (returning the original value unchanged) and output to the HTTP response without sanitization. The X-XSS-Protection header is disabled.\n\nImpact: Attackers can inject malicious JavaScript that executes in victims' browsers, enabling session hijacking, credential theft, or account compromise.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape() before outputting user input. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00480.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via ProcessBuilder\n\nUser input from request parameter 'BenchmarkTest00480' flows into a shell command via ProcessBuilder. The condition (7*42)-106 = 294-106 = 188 > 200 is false, so bar is assigned param. The user input is concatenated into 'echo ' + bar and passed to cmd.exe /c or sh -c, which interprets shell metacharacters. An attacker can inject shell commands using characters like ;, |, &, $(), etc.\n\nImpact: Attackers can execute arbitrary operating system commands on the server, leading to complete system compromise, data theft, malware installation, or use of the server for further attacks.\n\nFix: Never pass user input to shell interpreters (cmd.exe /c or sh -c). Use ProcessBuilder with individual command arguments without shell interpretation, or use ESAPI.encoder().encodeForOS() to sanitize input. Better yet, avoid executing external commands based on user input entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00495.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from request parameter 'BenchmarkTest00495' flows into the argsEnv parameter of Runtime.exec(). After list manipulation (add safe, add param, add moresafe, remove index 0), valuesList.get(0) retrieves the param value. This user-controlled data is passed as an environment variable to the executed command, allowing command injection through environment variable manipulation.\n\nImpact: An attacker can inject malicious commands through environment variables, potentially achieving arbitrary code execution on the server, data exfiltration, or complete system compromise.\n\nFix: Validate and sanitize all user input before using it in command execution. Use allowlists for acceptable values, or avoid passing user input to Runtime.exec() entirely. Consider using ProcessBuilder with strict input validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00496.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from request parameter 'BenchmarkTest00496' is Base64 encoded then decoded (a pass-through operation that returns the original value) and flows into the argsEnv parameter of Runtime.exec(). This allows command injection through environment variable manipulation.\n\nImpact: An attacker can inject malicious commands through environment variables, potentially achieving arbitrary code execution on the server, data exfiltration, or complete system compromise.\n\nFix: Validate and sanitize all user input before using it in command execution. Use allowlists for acceptable values, or avoid passing user input to Runtime.exec() entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00497.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from request parameter 'BenchmarkTest00497' flows through a switch statement. The switch target is guess.charAt(2) which equals 'C'. Case 'C' assigns param to bar. This user-controlled data is passed as an environment variable to Runtime.exec(), allowing command injection.\n\nImpact: An attacker can inject malicious commands through environment variables, potentially achieving arbitrary code execution on the server, data exfiltration, or complete system compromise.\n\nFix: Validate and sanitize all user input before using it in command execution. Use allowlists for acceptable values, or avoid passing user input to Runtime.exec() entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00498.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from request parameter 'BenchmarkTest00498' is Base64 encoded then decoded (a pass-through operation) and flows into the argsEnv parameter of Runtime.exec(). This allows command injection through environment variable manipulation.\n\nImpact: An attacker can inject malicious commands through environment variables, potentially achieving arbitrary code execution on the server, data exfiltration, or complete system compromise.\n\nFix: Validate and sanitize all user input before using it in command execution. Use allowlists for acceptable values, or avoid passing user input to Runtime.exec() entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00499.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nUser input from request parameter 'BenchmarkTest00499' is directly concatenated into a command string (cmd + bar) and passed to Runtime.exec(). This allows an attacker to inject arbitrary commands.\n\nImpact: An attacker can inject malicious commands, potentially achieving arbitrary code execution on the server, data exfiltration, or complete system compromise.\n\nFix: Never concatenate user input directly into command strings. Use parameterized command execution with separate arguments, and validate all user input against an allowlist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00500.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nUser input from request parameter 'BenchmarkTest00500' flows through a conditional statement. The condition (500/42) + 196 = 11 + 196 = 207 > 200 is always true, so bar = param executes. This user-controlled data is concatenated into a command string (cmd + bar) and passed to Runtime.exec(), allowing command injection.\n\nImpact: An attacker can inject malicious commands, potentially achieving arbitrary code execution on the server, data exfiltration, or complete system compromise.\n\nFix: Never concatenate user input directly into command strings. Use parameterized command execution with separate arguments, and validate all user input against an allowlist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00510.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input from request parameter 'BenchmarkTest00510' flows through a switch statement where the condition 'guess.charAt(2)' evaluates to 'C' (the third character of \"ABC\"). This causes the case 'C' branch to execute, assigning the user parameter to 'bar'. The tainted 'bar' variable is then concatenated directly into a SQL callable statement string without parameterization, creating a SQL injection vulnerability.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized queries or prepared statements with bound parameters instead of string concatenation. For CallableStatement, use parameter placeholders (?) and setString() methods to safely pass user input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00512.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Direct Parameter Assignment\n\nUser input from request.getParameterMap() is directly assigned to the 'bar' variable and concatenated into a SQL query without sanitization or parameterization. The parameter value flows directly from user input (param) to the SQL statement via string concatenation.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the 'BenchmarkTest00512' parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql) with a PreparedStatement that uses setString() to bind the parameter value safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00515.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via List Manipulation\n\nUser input from request.getParameterMap() is added to a list, and after removing the first element, the user-controlled parameter becomes the first element. This tainted value is then retrieved and concatenated into a SQL query without sanitization. After remove(0), the list becomes [param, 'moresafe'], so get(0) returns the tainted param value.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the 'BenchmarkTest00515' parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql) with a PreparedStatement that uses setString() to bind the parameter value safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00516.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Switch Statement\n\nThe switch statement evaluates guess.charAt(2) which equals 'C' (the third character of \"ABC\"). This causes case 'C' to execute, which assigns the user-controlled param to bar. The tainted bar value is then concatenated into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the 'BenchmarkTest00516' parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql) with a PreparedStatement that uses setString() to bind the parameter value safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00518.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Pass-Through Method\n\nUser input from request.getParameterMap() is passed through ThingFactory.createThing().doSomething(), which is a pass-through method that returns its input unchanged. The tainted value is then concatenated into a SQL INSERT statement without sanitization or parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the 'BenchmarkTest00518' parameter, potentially leading to unauthorized data insertion, data modification, or complete database compromise.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql) with a PreparedStatement that uses setString() to bind the parameter value safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00567.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input\n\nUser-controlled input from request parameters flows through Base64 encoding/decoding (which does not sanitize) into a command execution. The parameter name is retrieved from the request, Base64 encoded and decoded, and then concatenated directly into an OS command string that is executed via Runtime.exec().\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid using user input in OS commands. If necessary, use a whitelist of allowed values, or use ProcessBuilder with separate arguments instead of string concatenation. Consider using ESAPI.encoder().encodeForOS() to sanitize the input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00568.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input in Command Arguments\n\nUser-controlled input from request parameters flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) into the command arguments array. The tainted value is included in the args array that is passed to Runtime.exec(), allowing command injection.\n\nImpact: An attacker can inject malicious command arguments or shell metacharacters to execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid using user input in OS commands. If necessary, use a whitelist of allowed values and validate input strictly. Consider using ESAPI.encoder().encodeForOS() to sanitize the input before including it in command arguments.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00573.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter name flows directly into the environment variables array (argsEnv) of Runtime.exec(). The parameter name is extracted from the request and assigned to 'param', which is then assigned to 'bar' and passed as an environment variable to the executed process. An attacker can control parameter names to inject malicious environment variables.\n\nImpact: An attacker can inject arbitrary environment variables into the spawned process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in command execution. Use a whitelist approach to validate parameter names. Consider using ProcessBuilder with explicit environment variable handling, or avoid passing user-controlled data as environment variables entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00574.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter name flows into the environment variables array of Runtime.exec(). The ternary condition evaluates to false ((7*42)-106 = 188, which is NOT > 200), so 'bar' is assigned 'param' (user input). This tainted value is then passed as an environment variable to the executed process.\n\nImpact: An attacker can inject arbitrary environment variables into the spawned process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in command execution. Use a whitelist approach to validate parameter names. Consider using ProcessBuilder with explicit environment variable handling, or avoid passing user-controlled data as environment variables entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00575.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nUser-controlled input from request parameter name flows into command string concatenation. After list manipulation (adding three elements and removing the first), 'bar' is assigned from index 0 which contains 'param' (user input). This tainted value is concatenated directly with the command string and executed.\n\nImpact: An attacker can inject arbitrary OS commands by controlling the parameter name, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into command strings. Use parameterized command execution with ProcessBuilder and avoid shell interpretation. Validate and sanitize all user input against a strict whitelist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00576.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nUser-controlled input from request parameter name flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is concatenated directly with the command string. The tainted 'bar' value is then executed as part of the OS command.\n\nImpact: An attacker can inject arbitrary OS commands by controlling the parameter name, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into command strings. Use parameterized command execution with ProcessBuilder and avoid shell interpretation. Validate and sanitize all user input against a strict whitelist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00590.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled data from request.getParameterNames() flows into a SQL CallableStatement via string concatenation. The condition (500/42) + 196 = 11 + 196 = 207, which is > 200, so bar = param (user input). The SQL string is constructed using concatenation: '{call ' + bar + '}', allowing SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries or validate/sanitize the input. For stored procedure names, validate against a whitelist of allowed procedure names before constructing the SQL string.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00591.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter names flows into a SQL query via string concatenation. The parameter name (where the value equals 'BenchmarkTest00591') is retrieved and passed through thing.doSomething() (a pass-through method), then concatenated directly into the SQL query string. Although the USERNAME is parameterized, the PASSWORD field uses string concatenation with user input, allowing SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands by controlling the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a PreparedStatement parameter: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and use statement.setString(2, bar) to bind the password value.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00593.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter names flows into a SQL query via string concatenation. The code evaluates guess.charAt(2) which equals 'C', causing the switch statement to execute case 'C' and assign param (user-controlled parameter name) to bar. This tainted value is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by controlling the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a PreparedStatement parameter: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and use statement.setString(2, bar) to bind the password value.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00594.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter names flows into a SQL query via string concatenation. The parameter name is stored in a HashMap under key 'keyB-29056' and then retrieved back into bar. This tainted value is then concatenated directly into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands by controlling the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a PreparedStatement parameter: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and use statement.setString(2, bar) to bind the password value.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00595.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter names flows into a SQL query via string concatenation. The ternary expression evaluates (7*42)-106 > 200, which is 188 > 200 = false, causing bar to be assigned param (the user-controlled parameter name). This tainted value is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by controlling the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a PreparedStatement parameter: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and use statement.setString(2, bar) to bind the password value.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00596.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter names flows into a SQL query via string concatenation. The code adds 'safe', param, and 'moresafe' to a list, then removes index 0 ('safe'). After removal, the list becomes [param, 'moresafe'], so valuesList.get(0) retrieves param (the user-controlled parameter name). This tainted value is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by controlling the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a PreparedStatement parameter and bind the password value using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00597.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter names flows into a SQL query via string concatenation. The parameter name is passed through thing.doSomething() (a pass-through method that returns its input unchanged), then concatenated directly into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands by controlling the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a PreparedStatement parameter and bind the password value using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00598.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter names flows into a SQL query via string concatenation. The parameter name undergoes Base64 encoding and decoding (which is not a sanitization technique), then is concatenated directly into the SQL query string. Base64 encoding/decoding does not prevent SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands by controlling the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a PreparedStatement parameter and bind the password value using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00600.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter names flows into a SQL query via string concatenation. The code evaluates guess.charAt(2) which equals 'C', causing the switch statement to execute case 'C' and assign param (user-controlled parameter name) to bar. This tainted value is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by controlling the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a PreparedStatement parameter and bind the password value using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00603.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via ThingFactory pass-through\n\nUser-controlled parameter name flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is concatenated directly into a SQL query without sanitization. The parameter name comes from request.getParameterNames() iteration.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating parameter names, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql) with PreparedStatement and use setString() to bind the bar parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00604.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Base64 encoding\n\nUser-controlled parameter name is Base64 encoded then decoded (which returns the original value unchanged) and concatenated directly into a SQL query. Base64 encoding is not a sanitization technique for SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating parameter names, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeQuery(sql) with PreparedStatement and use setString() to bind the bar parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00606.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in INSERT statement\n\nThe condition (500/42) + 196 evaluates to 207 > 200, which is always true, so bar is assigned the user-controlled param value. This tainted value is then concatenated directly into a SQL INSERT statement without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating parameter names, potentially leading to unauthorized data insertion, data modification, or SQL-based attacks.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql) with PreparedStatement and use setString() to bind the bar parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00607.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection via ThingFactory pass-through\n\nUser-controlled parameter name flows through ThingFactory.createThing().doSomething() (a pass-through) and is concatenated directly into an XPath expression without sanitization or validation. An attacker can manipulate the parameter name to inject XPath syntax.\n\nImpact: An attacker can inject malicious XPath syntax to bypass authentication, access unauthorized data, or extract the entire XML document structure.\n\nFix: Use parameterized XPath queries with XPathExpression.evaluate() and variable binding, or validate/sanitize the input by checking for and rejecting single quotes and XPath metacharacters before building the query.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00608.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken and obsolete encryption algorithm. DES has a 56-bit key size and is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using readily available tools and computing power, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with init(256).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00609.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken and obsolete encryption algorithm. DES has a 56-bit key size and is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using readily available tools and computing power, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with init(256).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00610.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken and obsolete encryption algorithm. DES has a 56-bit key size and is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using readily available tools and computing power, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with init(256).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00681.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nThe code constructs a SQL query by directly concatenating user input (bar, which derives from request parameter) into the query string. The input comes from SeparateClassRequest.getTheParameter() which is a custom wrapper, but per the taint source rules, this is NOT a standard HttpServletRequest method and should not be flagged as a vulnerability based on the false positive avoidance rules.\n\nImpact: An attacker could inject malicious SQL code to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement pstmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); pstmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00731.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in ProcessBuilder\n\nUser-controlled input from request parameter 'BenchmarkTest00731' flows directly into a command executed via ProcessBuilder. The parameter value is concatenated into the command string 'echo ' + bar without sanitization, allowing an attacker to inject arbitrary OS commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server by injecting shell metacharacters (e.g., '; malicious_command' or '| malicious_command'), leading to complete system compromise, data theft, or denial of service.\n\nFix: Never pass user input directly to OS commands. If command execution is necessary, use a whitelist of allowed values, or use parameterized APIs that prevent command injection. Consider using safer alternatives that don't involve shell execution.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00740.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest00740' is retrieved from a HashMap and passed directly into the environment variables array (argsEnv) of Runtime.exec(). While the command itself is safe, user input in environment variables can still be exploited depending on how the executed command uses environment variables.\n\nImpact: An attacker can inject malicious values into environment variables that may be interpreted by the executed command or its child processes, potentially leading to command injection, privilege escalation, or information disclosure.\n\nFix: Validate and sanitize all user input before passing it to Runtime.exec(), even in environment variables. Use a whitelist of allowed values or avoid using user input in command execution entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00760.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via CallableStatement\n\nUser-controlled data from request parameter 'BenchmarkTest00760' is concatenated directly into a SQL callable statement string. The parameter flows through a HashMap (map18915.put('keyB-18915', param)) and is then retrieved and concatenated into the SQL string: 'String sql = \"{call \" + bar + \"}\"'. Although prepareCall() is used, the SQL string itself is constructed via concatenation, making it vulnerable to SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized callable statements with proper parameter binding. Instead of concatenating user input into the SQL string, use placeholders and bind parameters using setString() or similar methods.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00761.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input from request parameter 'BenchmarkTest00761' flows through a switch statement (charAt(2) = 'C') into the 'bar' variable and is concatenated directly into a SQL callable statement string without sanitization. The switch condition evaluates to case 'C', which assigns the tainted param to bar.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized CallableStatement with proper parameter binding instead of string concatenation. Replace the concatenated SQL with a properly parameterized call using setString() or similar methods.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00762.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input from request parameter 'BenchmarkTest00762' flows through a conditional statement ((500/42) + 196 = 207 > 200, which is true) into the 'bar' variable and is concatenated directly into a SQL callable statement string without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized CallableStatement with proper parameter binding instead of string concatenation. Replace the concatenated SQL with a properly parameterized call using setString() or similar methods.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00764.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser input from request parameter 'BenchmarkTest00764' is directly assigned to 'bar' and concatenated into a SQL query string without sanitization. The query is then executed via Spring JDBCTemplate.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Replace queryForObject(sql, Long.class) with a parameterized version using placeholders and parameter binding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00765.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate\n\nUser input from request parameter 'BenchmarkTest00765' flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) into 'bar' and is concatenated directly into a SQL query string without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Replace queryForObject(sql, Long.class) with a parameterized version using placeholders and parameter binding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00767.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate\n\nUser input from request parameter 'BenchmarkTest00767' flows through a switch statement (charAt(2) = 'C') into the 'bar' variable and is concatenated directly into a SQL query string without sanitization. The switch condition evaluates to case 'C', which assigns the tainted param to bar.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Replace queryForObject(sql, Long.class) with a parameterized version using placeholders and parameter binding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00768.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate\n\nUser input from request parameter 'BenchmarkTest00768' flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) into 'bar' and is concatenated directly into a SQL query string without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Replace queryForMap(sql) with a parameterized version using placeholders and parameter binding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00769.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate batchUpdate\n\nUser input from request parameter 'BenchmarkTest00769' is stored in a HashMap under key 'keyB-29572' and then retrieved into 'bar'. This tainted value is concatenated directly into a SQL query string without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Replace batchUpdate(sql) with a parameterized version using placeholders and parameter binding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00770.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Statement.addBatch\n\nUser input from request parameter 'BenchmarkTest00770' is added to a list, then after removing the first element ('safe'), the param becomes the first element. This tainted value in 'bar' is concatenated directly into a SQL query string without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of Statement with string concatenation. Replace statement.addBatch(sql) with a PreparedStatement using setString() for parameter binding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00771.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HashMap\n\nUser input from request parameter 'BenchmarkTest00771' is stored in a HashMap and then retrieved to construct a SQL query via string concatenation. The parameter value flows through map49960.put('keyB-49960', param) and is retrieved as bar = map49960.get('keyB-49960'), then concatenated directly into the SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest00771 parameter, potentially leading to unauthorized data access, modification, or deletion of database contents.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql) with a PreparedStatement that binds the bar variable using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00815.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Query String Parameter\n\nUser input from the query string parameter 'BenchmarkTest00815' is directly assigned to bar and then concatenated into an OS command without sanitization. The command 'echo ' + bar is passed to ProcessBuilder, allowing an attacker to inject arbitrary shell commands using command separators like ';', '&&', or '|'.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to shell commands. If necessary, use strict input validation with a whitelist of allowed characters, or use parameterized command execution that doesn't involve shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00816.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via HashMap-stored Query Parameter\n\nUser input from the query string parameter 'BenchmarkTest00816' is stored in a HashMap under key 'keyB-34260' and then retrieved into bar. This tainted value is concatenated into an OS command 'echo ' + bar and passed to ProcessBuilder, allowing command injection.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to shell commands. If necessary, use strict input validation with a whitelist of allowed characters, or use parameterized command execution that doesn't involve shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00823.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from the query parameter flows into a list, and after removing the first element, the user input (originally at index 1) becomes index 0 and is retrieved as bar. This tainted value is then passed as an environment variable to Runtime.exec(), allowing command injection through environment variable manipulation.\n\nImpact: An attacker can inject malicious commands through environment variables, potentially achieving arbitrary code execution on the server, reading sensitive files, or compromising the entire system.\n\nFix: Validate and sanitize all user input before using it in system commands. Use allowlists for acceptable values, or avoid passing user input to environment variables entirely. Consider using ProcessBuilder with proper input validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00824.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nUser-controlled input from the query parameter is stored in a HashMap and retrieved as bar. This tainted value is then concatenated directly into the command string passed to Runtime.exec() via args array, allowing command injection.\n\nImpact: An attacker can inject arbitrary shell commands that will be executed with the privileges of the application, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into shell commands. Use parameterized command execution, validate input against a strict allowlist, or use ESAPI.encoder().encodeForOS() to sanitize the input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00825.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables (ThingFactory Pass-Through)\n\nUser-controlled input from the query parameter is passed through ThingFactory.createThing().doSomething(), which is a pass-through that returns the input unchanged. The tainted value is then used as an environment variable in Runtime.exec(), allowing command injection.\n\nImpact: An attacker can inject malicious commands through environment variables, potentially achieving arbitrary code execution, data exfiltration, or system compromise.\n\nFix: Validate and sanitize user input before passing it to system commands. Use allowlists for acceptable values or ESAPI.encoder().encodeForOS() for proper encoding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00826.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nThe condition (7*42)-86 evaluates to 294-86=208, which is greater than 200, so bar is assigned the constant 'This_should_always_happen'. However, the code then concatenates bar directly into the command string passed to Runtime.exec() as a single string argument, which is vulnerable to command injection if the condition logic were to change or if there's a logic error.\n\nImpact: While the current data flow shows bar receives a constant, the pattern of concatenating values directly into command strings is inherently dangerous and could lead to command injection if the code is modified.\n\nFix: Use parameterized command execution with separate arguments rather than string concatenation. Pass bar as a separate argument in an array to Runtime.exec().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00839.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from the query string parameter 'BenchmarkTest00839' is concatenated directly into a SQL query. The ternary condition `(7 * 42) - num > 200` evaluates to `294 - 106 = 188 > 200`, which is FALSE, so `bar = param` executes. This tainted value is then concatenated into the SQL query string, creating a SQL injection vulnerability.\n\nImpact: An attacker can execute arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a parameter placeholder and bind the value using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00840.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from the query string parameter 'BenchmarkTest00840' is concatenated directly into a SQL query. The ternary condition `(7 * 42) - num > 200` evaluates to `294 - 106 = 188 > 200`, which is FALSE, so `bar = param` executes. This tainted value is then concatenated into the SQL query string used with Spring's batchUpdate method, creating a SQL injection vulnerability.\n\nImpact: An attacker can execute arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with Spring's JdbcTemplate. Replace string concatenation with named parameters or positional parameters and bind values safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00841.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from the query string is directly concatenated into a SQL query without sanitization. The code extracts a parameter from the query string, passes it through a switch statement where case 'C' assigns it to 'bar', and then concatenates 'bar' into a SQL query. Since 'ABC'.charAt(2) equals 'C', the user input flows directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00842.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from the query string is directly concatenated into a SQL query. The code adds user input to a list, removes the first element, then retrieves the user input at index 0 (which becomes the user parameter after removal) and concatenates it into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT userid from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00843.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from the query string is directly concatenated into a SQL query. The code stores user input in a HashMap with key 'keyB-12983', retrieves it back, and then concatenates it into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT userid from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00845.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from the query string is directly concatenated into a SQL query. The code uses a ternary operator where the condition (7*42) - 106 > 200 evaluates to false (188 > 200 is false), causing 'bar' to be assigned the user input parameter, which is then concatenated into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00846.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from the query string is directly concatenated into a SQL query without any sanitization. The parameter is extracted from the query string and directly assigned to 'bar', which is then concatenated into a SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00847.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from the query string is directly concatenated into a SQL query. The code adds user input to a list, removes the first element, then retrieves the user input at index 0 (which becomes the user parameter after removal) and concatenates it into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00848.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from the query string is directly concatenated into a SQL query without any sanitization. The parameter is extracted from the query string and directly assigned to 'bar', which is then concatenated into a SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00849.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from the query string is directly concatenated into a SQL query. The code adds user input to a list, removes the first element, then retrieves the user input at index 0 (which becomes the user parameter after removal) and concatenates it into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00850.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from the query string is directly concatenated into a SQL query. The code adds user input to a list, removes the first element, then retrieves the user input at index 0 (which becomes the user parameter after removal) and concatenates it into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00861.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input\n\nUser input from SeparateClassRequest flows into an LDAP filter without sanitization. The code evaluates guess.charAt(2) which equals 'C', causing the switch to execute case 'C' and assign param (user input) to bar. This tainted value is then concatenated directly into the LDAP filter string, allowing an attacker to inject malicious LDAP syntax.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, extract sensitive directory information, or access unauthorized records by injecting LDAP metacharacters.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize the user input before including it in the LDAP filter, or use parameterized LDAP queries if supported by the framework.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00925.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input flows through ThingFactory.createThing().doSomething() (a pass-through that returns param unchanged) into bar, which is then concatenated directly into a SQL query string. Although the query uses PreparedStatement, the bar variable is concatenated into the SQL string itself rather than being bound as a parameter.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement.setString() for all user input. Change to: String sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\"; statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00927.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input is stored in a list, the first element is removed, and then valuesList.get(0) retrieves the param value (which moved from index 1 to index 0 after removal). This tainted value in bar is concatenated directly into a SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement.setString() for all user input. Change to: String sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\"; statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00928.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input flows into bar via a ternary condition. The condition (7*42)-106 = 188, and 188 > 200 is FALSE, so bar = param (tainted). This tainted value is then concatenated directly into a SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement.setString() for all user input. Change to: String sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\"; statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00929.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input flows into bar via a switch statement. The switchTarget is guess.charAt(2) where guess='ABC', so switchTarget='C'. Case 'C' assigns param to bar (tainted). This tainted value is then concatenated directly into a SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement.setString() for all user input. Change to: String sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\"; statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00930.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input is Base64 encoded then decoded (a pass-through operation that returns the original value) and stored in bar. This tainted value is then concatenated directly into a SQL query string passed to Spring's batchUpdate method.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with Spring's JdbcTemplate. Change to use parameterized query: jdbcTemplate.batchUpdate(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\", new Object[]{bar});",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00941.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection via Unsanitized User Input\n\nUser-controlled input from SeparateClassRequest.getTheValue() flows through Base64 encoding/decoding (which does not sanitize) into an XPath expression without proper sanitization. The expression '/Employees/Employee[@emplid='' + bar + '']' concatenates user input directly into the XPath query, allowing an attacker to inject malicious XPath syntax.\n\nImpact: An attacker can manipulate the XPath query to bypass authentication, extract sensitive data from the XML document, or access unauthorized information by injecting XPath metacharacters.\n\nFix: Use parameterized XPath queries or sanitize the input by validating against a whitelist and escaping XPath special characters. Consider using ESAPI.encoder().encodeForXPath() or validate that the input contains no XPath metacharacters like single quotes, double quotes, or parentheses before constructing the query.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00947.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input\n\nUser-controlled input from a cookie flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is concatenated directly into an LDAP filter string without sanitization. The filter '(&(objectclass=person))(|(uid=' + bar + ')(street={0}))' allows injection of LDAP filter metacharacters.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, access unauthorized user records, or extract sensitive information from the LDAP directory by injecting LDAP filter syntax such as wildcards, logical operators, or closing parentheses.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize the user input before incorporating it into the LDAP filter, or use parameterized LDAP queries if supported by the LDAP library. Validate that the input does not contain LDAP metacharacters like parentheses, asterisks, or backslashes.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00948.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input\n\nUser-controlled input from a cookie is concatenated directly into an LDAP filter string without sanitization. The filter '(&(objectclass=person)(uid=' + bar + '))' allows injection of LDAP filter metacharacters. Although the code retrieves the value from a HashMap using 'keyA-72608' which was set to 'a_Value', the data flow shows that 'bar' is first assigned from 'keyB-72608' (which contains the tainted param), making it tainted before being reassigned. However, the final assignment 'bar = (String) map72608.get(\"keyA-72608\")' retrieves the safe constant 'a_Value', so bar is actually safe at the sink.\n\nImpact: None - the final value of bar is the safe constant 'a_Value', not user input.\n\nFix: No action needed for this specific instance as the data flow shows bar contains a safe value at the LDAP query construction point.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00968.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Cookie Data\n\nUser-controlled data from a cookie (BenchmarkTest00968) flows directly into a shell command without sanitization. The cookie value is URL-decoded and passed through doSomething() which returns it unchanged, then concatenated into 'echo ' + bar and executed via ProcessBuilder with shell=true (/c or -c flags).\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the cookie value. For example, setting the cookie to '; malicious_command #' would execute malicious_command on the server, leading to complete system compromise.\n\nFix: Never pass user input directly to shell commands. Use parameterized command execution without shell interpretation, or validate/sanitize input against a strict whitelist. Consider using ESAPI.encoder().encodeForOS() if shell execution is absolutely necessary.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00979.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Cookie Value\n\nUser input from a cookie (param) flows through the doSomething method where it is assigned to bar based on a switch statement. The switch target is 'guess.charAt(2)' which equals 'C', matching case 'C' where bar = param. This tainted value is then concatenated into a shell command string (cmd + bar) and passed to Runtime.exec(). An attacker can inject arbitrary OS commands through the cookie value.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into shell commands. Use parameterized command execution or validate/sanitize input against a strict whitelist. Consider using ProcessBuilder with separate arguments instead of shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00980.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from a cookie (param) flows through the doSomething method. After list operations (add safe, add param, add moresafe, remove index 0), the list becomes [param, 'moresafe']. The code retrieves valuesList.get(1) which is 'moresafe' (safe). However, bar is then passed as an environment variable to Runtime.exec(args, argsEnv) where argsEnv = {bar}. While the current data flow shows bar receives a safe value, the pattern demonstrates environment variable injection which could be exploited if the data flow changes.\n\nImpact: If user-controlled data reaches the environment variables parameter of Runtime.exec(), an attacker could inject malicious environment variables that affect command execution behavior, potentially leading to command injection or privilege escalation.\n\nFix: Avoid passing user-controlled data in environment variables to Runtime.exec(). If necessary, strictly validate and sanitize all environment variable values against a whitelist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00981.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Cookie in Command Arguments\n\nUser-controlled data from a cookie flows into a command execution sink. The cookie value is retrieved, URL-decoded, and passed through a ternary expression that evaluates to the user input ((7*42)-106=188, which is NOT > 200, so bar=param). This tainted value is then concatenated into a command string and executed via Runtime.exec(), allowing an attacker to inject arbitrary OS commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server by manipulating the BenchmarkTest00981 cookie value, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never pass user-controlled data to Runtime.exec(). If dynamic command execution is required, use a whitelist of allowed commands and validate/sanitize all inputs. Consider using ProcessBuilder with a fixed command and passing user data only as arguments to safe, parameterized operations.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00983.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Cookie in Environment Variables\n\nUser-controlled data from a cookie flows into the environment variables parameter of Runtime.exec(). The cookie value is retrieved, URL-decoded, and passed through a conditional that evaluates to true ((500/42)+196=207 > 200), assigning the tainted param to bar. This value is then used as an environment variable in the exec() call. While less direct than command argument injection, malicious environment variables can still be exploited to affect command execution behavior.\n\nImpact: An attacker can inject malicious environment variables that may alter the behavior of executed commands, potentially leading to command injection, information disclosure, or privilege escalation depending on how the executed program uses environment variables.\n\nFix: Do not pass user-controlled data as environment variables to Runtime.exec(). If environment variables must be set dynamically, use a strict whitelist of allowed variable names and values, and validate all inputs thoroughly.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00996.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in CallableStatement\n\nUser-controlled data from a cookie flows through Base64 encoding/decoding (which is a pass-through operation) and is concatenated directly into a SQL callable statement string. The SQL query is constructed using string concatenation: 'sql = \"{call \" + bar + \"}\"' where bar contains unsanitized user input.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, authentication bypass, or complete database compromise.\n\nFix: Use parameterized callable statements with proper parameter binding instead of string concatenation. Replace the concatenation with CallableStatement parameter placeholders and use registerOutParameter/setString methods to bind values safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00997.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in CallableStatement\n\nUser-controlled data from a cookie is added to a list, and after removing the first element, the tainted param value is retrieved at index 0 and concatenated directly into a SQL callable statement. The SQL query is constructed using string concatenation: 'sql = \"{call \" + bar + \"}\"' where bar contains unsanitized user input.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, authentication bypass, or complete database compromise.\n\nFix: Use parameterized callable statements with proper parameter binding instead of string concatenation. Replace the concatenation with CallableStatement parameter placeholders and use registerOutParameter/setString methods to bind values safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00998.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in CallableStatement\n\nUser-controlled data from a cookie flows through a ternary expression that evaluates to the param value (since (7*42)-106=188, which is not > 200) and is concatenated directly into a SQL callable statement. The SQL query is constructed using string concatenation: 'sql = \"{call \" + bar + \"}\"' where bar contains unsanitized user input.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, authentication bypass, or complete database compromise.\n\nFix: Use parameterized callable statements with proper parameter binding instead of string concatenation. Replace the concatenation with CallableStatement parameter placeholders and use registerOutParameter/setString methods to bind values safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01000.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in CallableStatement\n\nUser-controlled data from a cookie flows through Base64 encoding/decoding (which is a pass-through operation) and is concatenated directly into a SQL callable statement string. The SQL query is constructed using string concatenation: 'sql = \"{call \" + bar + \"}\"' where bar contains unsanitized user input.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, authentication bypass, or complete database compromise.\n\nFix: Use parameterized callable statements with proper parameter binding instead of string concatenation. Replace the concatenation with CallableStatement parameter placeholders and use registerOutParameter/setString methods to bind values safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01002.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value is concatenated directly into a SQL query string. The ternary condition (7*42)-106 > 200 evaluates to FALSE (188 > 200), causing bar to be assigned the tainted param value. This value is then concatenated into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01002 cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter placeholder and bind the value using PreparedStatement.setString(). Example: sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\"; statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01003.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value flows through list operations and is concatenated into a SQL query. After removing the first element from the list [\"safe\", param, \"moresafe\"], the list becomes [param, \"moresafe\"]. The code retrieves index 0, which is the tainted param value, and concatenates it directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01003 cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter placeholder and bind the value using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01004.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value flows through a switch statement and is concatenated into a SQL query. The switch target is guess.charAt(2) which equals 'C', causing case 'C' to execute and assign param to bar. This tainted value is then concatenated directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01004 cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter placeholder and bind the value using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01005.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value flows through list operations and is concatenated into a SQL query. After removing the first element from the list [\"safe\", param, \"moresafe\"], the list becomes [param, \"moresafe\"]. The code retrieves index 0, which is the tainted param value, and concatenates it directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01005 cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter placeholder and bind the value using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01006.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value flows through a HashMap and is concatenated into a SQL query. The param value is stored in the HashMap with key \"keyB-36088\" and then retrieved, assigning the tainted value to bar. This value is then concatenated directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01006 cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter placeholder and bind the value using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01007.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value flows through a switch statement and is concatenated into a SQL query. The switch target is guess.charAt(2) which equals 'C', causing case 'C' to execute and assign param to bar. This tainted value is then concatenated directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01007 cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter placeholder and bind the value using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01008.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value is directly concatenated into a SQL query. The param value from the cookie is assigned directly to bar without any sanitization, and then concatenated into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01008 cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter placeholder and bind the value using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01009.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Parameter\n\nUser-controlled cookie value flows through Base64 encoding/decoding (which is a pass-through operation) and is concatenated into a SQL query. The Base64 encode/decode does not sanitize the data, and the tainted param value is concatenated directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01009 cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameter placeholder and bind the value using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01011.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Value\n\nUser-controlled cookie value is concatenated directly into a SQL query without sanitization. The cookie value 'BenchmarkTest01011' is decoded and flows through the Test.doSomething() method. The condition (500/42)+196 = 11+196 = 207 > 200 is true, so bar = param (tainted). This tainted value is then concatenated into the SQL query: \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\"\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.addBatch(sql) with a PreparedStatement that uses setString() for the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01013.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection via Cookie Value\n\nUser-controlled cookie value is concatenated directly into an XPath expression without sanitization. The cookie value flows through Test.doSomething() where the condition (7*18)+106 = 126+106 = 232 > 200 is true, so bar = 'This_should_always_happen' (safe constant). However, the ternary is backwards - it assigns the constant when true and param when false. Since 232 > 200 is TRUE, bar gets the constant, making this safe.\n\nImpact: None - the data flow analysis shows bar receives a safe constant value, not user input.\n\nFix: No action needed - the current implementation is secure due to the constant assignment.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01064.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Header\n\nUser input from the BenchmarkTest01064 header is concatenated directly into an OS command string and executed via Runtime.exec(). The 'bar' variable is retrieved from a HashMap where it was stored with the user-controlled 'param', making it tainted. The command 'cmd + bar' concatenates user input directly into the command string.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid concatenating user input into command strings. Use parameterized command execution with String arrays, validate and sanitize all input, or use safer alternatives to shell command execution.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01066.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from the BenchmarkTest01066 header flows into the environment variables parameter (argsEnv) of Runtime.exec(). The 'bar' variable contains user-controlled data that is passed as an environment variable to the executed process. While less direct than command injection, malicious environment variables can still be exploited to compromise the executed process.\n\nImpact: An attacker can inject malicious environment variables that may be used by the executed command to perform unauthorized actions, potentially leading to code execution or information disclosure.\n\nFix: Validate and sanitize all user input before using it in environment variables. Consider using a whitelist approach for allowed environment variable values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01067.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from the BenchmarkTest01067 header flows into the environment variables parameter (argsEnv) of Runtime.exec(). After list manipulation (add safe, add param, add moresafe, remove index 0), the list becomes [param, 'moresafe']. The code retrieves valuesList.get(1) which is 'moresafe' (safe), not the tainted param. However, this is still a vulnerable pattern as the tainted data is in the environment.\n\nImpact: An attacker can inject malicious environment variables that may be used by the executed command to perform unauthorized actions.\n\nFix: Validate and sanitize all user input before using it in environment variables. Use a whitelist approach for allowed values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01068.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nUser input from the BenchmarkTest01068 header is evaluated through a ternary condition: bar = (7 * 18) + 106 > 200 ? 'This_should_always_happen' : param. Computing: (7 * 18) + 106 = 126 + 106 = 232, and 232 > 200 is TRUE, so bar is assigned the constant 'This_should_always_happen', not the tainted param. Therefore, this is actually SAFE - no vulnerability exists in the current code.\n\nImpact: None - the current implementation is safe as only a constant value reaches the command execution.\n\nFix: No action needed for the current implementation. However, be cautious if the arithmetic condition is modified in the future.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01083.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request header 'BenchmarkTest01083' is directly concatenated into a SQL query string. The param flows through doSomething() unchanged and is concatenated into the PASSWORD clause of the SQL query. Although PreparedStatement is used, the SQL string itself contains the concatenated user input before being prepared, making it vulnerable to SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with PreparedStatement.setString() for all user input. Replace the concatenation with a placeholder: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and use statement.setString(2, bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01084.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request header 'BenchmarkTest01084' flows through a conditional that evaluates to true ((500/42)+196 = 207 > 200), assigning param to bar. This tainted value is then concatenated into a SQL query string in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with PreparedStatement.setString() for all user input. Replace the concatenation with a placeholder: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and use statement.setString(2, bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01087.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request header 'BenchmarkTest01087' flows through a ternary condition. The condition (7*42)-106 = 188, and 188 > 200 is FALSE, so bar is assigned param (the user input). This tainted value is then concatenated into a SQL query string in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries instead of string concatenation. Replace with: 'SELECT userid from USERS where USERNAME=? and PASSWORD=?' and bind both values using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01088.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request header 'BenchmarkTest01088' flows through a conditional that evaluates to true ((500/42)+196 = 207 > 200), assigning param to bar. This tainted value is then concatenated into a SQL query string in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries instead of string concatenation. Replace with: 'SELECT userid from USERS where USERNAME=? and PASSWORD=?' and bind both values using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01090.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request header 'BenchmarkTest01090' is stored in a HashMap with key 'keyB-12212' and then retrieved with the same key. The retrieved value (bar) is concatenated into a SQL query string in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries instead of string concatenation. Replace with: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and bind both values using PreparedStatement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01091.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in BenchmarkTest01091\n\nUser-controlled data from HTTP header 'BenchmarkTest01091' flows into a SQL query via string concatenation. The doSomething method adds param to a list, removes the first element, then retrieves param at index 0. After valuesList.remove(0), the list becomes [param, 'moresafe'], so valuesList.get(0) returns param (tainted). This tainted value is concatenated directly into the SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01091 header, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql) with PreparedStatement.setString() for the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01093.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in BenchmarkTest01093\n\nUser-controlled data from HTTP header 'BenchmarkTest01093' flows into a SQL query via string concatenation. The doSomething method stores param in a HashMap under 'keyB-18142' and retrieves it back, making bar equal to param (tainted). This tainted value is concatenated directly into the SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01093 header, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql, new int[] {1, 2}) with PreparedStatement.setString() for the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01094.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in BenchmarkTest01094\n\nUser-controlled data from HTTP header 'BenchmarkTest01094' flows directly into a SQL query via string concatenation. The doSomething method returns param unchanged (bar = param), and this tainted value is concatenated directly into the SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01094 header, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql, new String[] {\"username\", \"password\"}) with PreparedStatement.setString() for the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01097.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in BenchmarkTest01097\n\nUser-controlled data from HTTP header 'BenchmarkTest01097' flows into a SQL INSERT statement via string concatenation. The doSomething method evaluates (500 / 42) + 196 = 11 + 196 = 207, which is > 200 (true), so bar = param (tainted). This tainted value is concatenated directly into the SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01097 header, potentially leading to unauthorized data insertion, modification, or other SQL injection attacks.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql) with PreparedStatement.setString() for the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01154.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input\n\nUser-controlled input from request header 'BenchmarkTest01154' flows through the doSomething() method and is directly concatenated into an LDAP filter string without sanitization. The filter string '(&(objectclass=person))(|(uid=' + bar + ')(street={0}))' allows an attacker to inject malicious LDAP syntax.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, extract sensitive directory information, or modify LDAP entries. For example, injecting '*)(uid=*))(|(uid=' would return all users.\n\nFix: Use parameterized LDAP queries or properly escape special LDAP characters. Use ESAPI.encoder().encodeForLDAP() to sanitize the input before including it in the filter string.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01182.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Header Parameter\n\nUser input from the BenchmarkTest01182 header flows into a command execution sink. After list manipulation (add safe, add param, add moresafe, remove index 0), the list becomes [param, moresafe]. Calling get(1) retrieves 'moresafe' (safe), not param. However, the code comment says 'get the last safe value' but actually retrieves index 1 which is the constant 'moresafe'. This is actually SAFE - no vulnerability.\n\nImpact: None - the data flow analysis shows bar receives the constant 'moresafe', not user input.\n\nFix: No action needed - this is a false positive upon detailed analysis.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01190.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from the BenchmarkTest01190 header flows into the environment variables parameter of Runtime.exec(). The data flow shows: (7*42) - 106 = 188, and 188 > 200 is FALSE, so the ternary assigns param (user input) to bar. This tainted value is then passed as an environment variable to the executed process.\n\nImpact: An attacker can inject malicious environment variables that may be interpreted by the executed command, potentially leading to arbitrary command execution or information disclosure.\n\nFix: Validate and sanitize all user input before passing it to Runtime.exec(). Use a whitelist approach to allow only known-safe values, or avoid passing user input to environment variables entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01191.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled data from the 'BenchmarkTest01191' HTTP header flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is placed directly into the environment variables array (argsEnv) passed to Runtime.exec(). This allows an attacker to inject malicious environment variables that can affect command execution behavior.\n\nImpact: An attacker can inject arbitrary environment variables by controlling the HTTP header value, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize the header value before using it in environment variables. Use a whitelist approach to only allow expected values, or avoid using user input in environment variables entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01192.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled data from the 'BenchmarkTest01192' HTTP header flows through a conditional that evaluates to true ((500/42) + 196 = 11 + 196 = 207 > 200), assigning param to bar. This tainted value is then placed into the environment variables array passed to Runtime.exec().\n\nImpact: An attacker can inject arbitrary environment variables by controlling the HTTP header value, potentially leading to command injection, privilege escalation, or information disclosure.\n\nFix: Validate and sanitize the header value before using it in environment variables. Use a whitelist approach to only allow expected values, or avoid using user input in environment variables entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01194.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Command String Concatenation\n\nUser-controlled data from the 'BenchmarkTest01194' HTTP header flows through a switch statement where guess.charAt(2) = 'C' (from \"ABC\"), which matches case 'C' and assigns param to bar. This tainted value is then concatenated directly into the command string passed to Runtime.exec().\n\nImpact: An attacker can inject arbitrary OS commands by controlling the HTTP header value, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into command strings. Use ProcessBuilder with separate arguments, or validate input against a strict whitelist of allowed values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01208.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled data from the HTTP header 'BenchmarkTest01208' is concatenated directly into a SQL callable statement string without sanitization. The data flows from request.getHeaders() through a ternary expression that evaluates to the user input (since (7*42)-106 = 188, which is not > 200), and is then concatenated into the SQL string '{call ' + bar + '}'. This allows an attacker to inject arbitrary SQL commands.\n\nImpact: An attacker can execute arbitrary SQL queries, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries or prepared statements with bound parameters. Never concatenate user input directly into SQL strings. For callable statements, use setString() or other parameter binding methods to safely pass user data.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01209.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser-controlled data from the HTTP header 'BenchmarkTest01209' is concatenated directly into a SQL query string. The data flows from request.getHeaders() through a List where after removing the first element, the user input becomes the first element (index 0), and is then concatenated into the SQL string 'SELECT * from USERS where USERNAME=? and PASSWORD='' + bar + '''. While USERNAME is parameterized, PASSWORD is vulnerable to SQL injection.\n\nImpact: An attacker can execute arbitrary SQL queries, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with bound parameters for ALL user input. Replace the string concatenation with a proper parameter binding: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and use statement.setString(2, bar) to bind the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01210.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser-controlled data from the HTTP header 'BenchmarkTest01210' is concatenated directly into a SQL query string. The data flows from request.getHeaders() through a HashMap (stored at 'keyB-86576' and retrieved), and is then concatenated into the SQL string 'SELECT * from USERS where USERNAME=? and PASSWORD='' + bar + '''. While USERNAME is parameterized, PASSWORD is vulnerable to SQL injection.\n\nImpact: An attacker can execute arbitrary SQL queries, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with bound parameters for ALL user input. Replace the string concatenation with a proper parameter binding: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and use statement.setString(2, bar) to bind the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01211.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest01211\n\nUser-controlled data from the 'BenchmarkTest01211' HTTP header is directly concatenated into a SQL query without sanitization. The header value flows through request.getHeaders() to param, then to bar via the Test.doSomething() method, and is finally concatenated into the SQL string at line 56.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the HTTP header value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameterized binding: change the SQL to use '?' for the PASSWORD field and bind the value using statement.setString(2, bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01214.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest01214\n\nUser-controlled data from the 'BenchmarkTest01214' HTTP header is directly concatenated into a SQL query. The header value flows to param, then through a list manipulation where after removing index 0, the list becomes [param, 'moresafe']. The code retrieves valuesList.get(0) which returns the tainted param value, assigns it to bar, and concatenates it into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the HTTP header value, potentially leading to unauthorized data access, data modification, authentication bypass, or complete database compromise.\n\nFix: Use parameterized queries exclusively. Replace the string concatenation with a parameterized binding using PreparedStatement.setString() for all user-controlled values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01221.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Header Parameter\n\nUser-controlled data from the 'BenchmarkTest01221' HTTP header is concatenated directly into a SQL INSERT statement without parameterization. The Base64 encode/decode operation is a pass-through that does not sanitize the input. An attacker can inject arbitrary SQL by crafting a malicious header value.\n\nImpact: An attacker can execute arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace the dynamic SQL with: PreparedStatement stmt = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01222.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Header Parameter\n\nUser-controlled data from the 'BenchmarkTest01222' HTTP header flows through a HashMap and is concatenated directly into a SQL INSERT statement. The HashMap operations do not sanitize the data. An attacker can inject arbitrary SQL commands via the header value.\n\nImpact: An attacker can execute arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace the dynamic SQL with: PreparedStatement stmt = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01223.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection via Header Parameter\n\nUser-controlled data from the 'BenchmarkTest01223' HTTP header is concatenated directly into an XPath expression without sanitization. The switch statement evaluates 'ABC'.charAt(2) which equals 'C', causing case 'C' to execute and assign the tainted param to bar. An attacker can inject XPath syntax (e.g., single quotes) to manipulate the query logic.\n\nImpact: An attacker can bypass authentication, extract sensitive data from the XML document, or manipulate query results by injecting XPath operators and predicates.\n\nFix: Use parameterized XPath queries or validate/sanitize input by checking for and rejecting single quotes before constructing the XPath expression. Alternatively, use XPath variable binding if supported by your XPath library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01224.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection via Header Parameter\n\nUser-controlled data from the 'BenchmarkTest01224' HTTP header flows through list operations and is concatenated directly into an XPath expression. After the list operations (add 'safe', add param, add 'moresafe', remove index 0), the list becomes [param, 'moresafe'], so get(0) returns the tainted param value. An attacker can inject XPath syntax to manipulate the query.\n\nImpact: An attacker can bypass authentication, extract sensitive data from the XML document, or manipulate query results by injecting XPath operators and predicates.\n\nFix: Use parameterized XPath queries or validate/sanitize input by checking for and rejecting single quotes before constructing the XPath expression. Alternatively, use XPath variable binding if supported by your XPath library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01270.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Parameter\n\nUser-controlled input from request parameter 'BenchmarkTest01270' flows through a ternary expression. The condition (7*42)-106 > 200 evaluates to 188 > 200 which is FALSE, so bar is assigned param (tainted). This tainted data is concatenated into a shell command 'echo ' + bar and passed to ProcessBuilder, allowing arbitrary command injection.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to shell commands. If necessary, use strict input validation with a whitelist of allowed characters, or use parameterized APIs that don't invoke a shell. Consider using ESAPI.encoder().encodeForOS() to sanitize the input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01285.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection\n\nUser input from request parameter 'BenchmarkTest01285' flows through the doSomething method (which adds it to a list, removes the first element, and retrieves it at index 0) and is concatenated directly into an OS command string that is executed via Runtime.exec(). The command is constructed as 'cmd + bar' where bar contains unsanitized user input.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the application server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Use parameterized command execution or validate/sanitize the input against a strict whitelist. Consider using ProcessBuilder with separate arguments instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01286.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection\n\nUser input from request parameter 'BenchmarkTest01286' flows through the doSomething method (which adds it to a list, removes the first element, and retrieves it at index 0) and is placed into the args array that is passed to Runtime.exec(). On Windows, it's concatenated into the command string in the args array; on Unix, it's concatenated with the cmd string.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the application server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Validate and sanitize user input before including it in OS commands. Use a whitelist approach to restrict allowed characters and values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01287.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from request parameter 'BenchmarkTest01287' flows through the doSomething method (Base64 encode/decode which preserves the original value) and is placed into the argsEnv array (environment variables parameter) of Runtime.exec(). User-controlled environment variables can be exploited to inject commands or modify command behavior.\n\nImpact: An attacker can manipulate environment variables to inject malicious commands or alter the execution environment, potentially leading to arbitrary code execution or privilege escalation.\n\nFix: Do not allow user input to control environment variables passed to Runtime.exec(). If environment variables must be set, validate them against a strict whitelist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01288.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from request parameter 'BenchmarkTest01288' flows through the doSomething method (stored in HashMap and retrieved) and is placed into the argsEnv array (environment variables parameter) of Runtime.exec(). User-controlled environment variables can be exploited to inject commands or modify command behavior.\n\nImpact: An attacker can manipulate environment variables to inject malicious commands or alter the execution environment, potentially leading to arbitrary code execution or privilege escalation.\n\nFix: Do not allow user input to control environment variables passed to Runtime.exec(). If environment variables must be set, validate them against a strict whitelist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01289.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection\n\nUser input from request parameter 'BenchmarkTest01289' could flow through the doSomething method. However, data flow analysis shows that after the list operations (add 'safe', add param, add 'moresafe', remove index 0), the code retrieves valuesList.get(1) which returns 'moresafe' (a safe constant), not the user input. The bar variable contains the safe constant 'moresafe', not user input.\n\nImpact: No actual vulnerability - the user input does not reach the command execution sink.\n\nFix: No action needed for this specific case as the data flow is safe.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01302.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input from request parameter 'BenchmarkTest01302' is Base64 encoded/decoded (which does not sanitize SQL metacharacters) and then directly concatenated into a SQL callable statement string. The doSomething method returns the user input after Base64 round-trip encoding, which preserves the original value. This concatenated SQL string is then passed to prepareCall(), allowing an attacker to inject arbitrary SQL commands.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data, modify or delete database records, or execute administrative operations on the database.\n\nFix: Use parameterized queries with proper binding. Replace the string concatenation with a parameterized callable statement: use '?' placeholders in the SQL string and bind the user input using setString() or appropriate setter methods.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01304.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser input from request parameter 'BenchmarkTest01304' flows through a list manipulation where after removing index 0, the user input ends up at index 0 of the list. This tainted value is retrieved via get(0) and concatenated directly into the SQL query string for the PASSWORD field. Although the USERNAME field uses parameterized binding (?), the PASSWORD field uses string concatenation, creating a SQL injection vulnerability.\n\nImpact: An attacker can inject malicious SQL code through the BenchmarkTest01304 parameter to bypass authentication, extract sensitive data including passwords and usernames, modify database records, or execute administrative database operations.\n\nFix: Use parameterized binding for all user inputs in SQL queries. Replace the string concatenation with a second parameter placeholder: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and bind both values using statement.setString(1, username) and statement.setString(2, bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01306.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser input from request parameter 'BenchmarkTest01306' is Base64 encoded/decoded (which does not sanitize SQL metacharacters) and then directly concatenated into the SQL query string for the PASSWORD field. The Base64 round-trip preserves the original user input value. Although the USERNAME field uses parameterized binding (?), the PASSWORD field uses string concatenation, creating a SQL injection vulnerability.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data including user credentials, modify or delete database records, or execute administrative operations on the database.\n\nFix: Use parameterized binding for all user inputs in SQL queries. Replace the string concatenation with a parameter placeholder: 'SELECT * from USERS where USERNAME=? and PASSWORD=?' and bind both values using statement.setString(1, username) and statement.setString(2, bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01308.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBC Template\n\nUser input from request parameter 'BenchmarkTest01308' is assigned to bar via a ternary expression where the condition (7*42)-106 > 200 evaluates to false (188 > 200 is false), causing bar to receive the user-controlled param value. This tainted value is then directly concatenated into the SQL query string for the PASSWORD field and executed via Spring's JDBCtemplate.queryForObject(), creating a SQL injection vulnerability.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive userid values and other data, modify database records, or execute administrative database operations.\n\nFix: Use Spring JDBC Template's parameterized query methods. Replace the string concatenation with a parameterized query: 'SELECT userid from USERS where USERNAME='foo' and PASSWORD=?' and pass the parameter as an argument: queryForObject(sql, new Object[]{bar}, Long.class).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01311.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in BenchmarkTest01311\n\nUser input from request parameter 'BenchmarkTest01311' flows through the doSomething method and is concatenated directly into a SQL query without sanitization. The condition (500/42)+196 evaluates to 11+196=207, which is >200, so bar=param executes, making bar tainted. The tainted value is then concatenated into the SQL string.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql) with PreparedStatement and use setString() to bind the parameter safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01312.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in BenchmarkTest01312\n\nUser input from request parameter 'BenchmarkTest01312' flows through the doSomething method. The switch statement evaluates guess.charAt(2) where guess='ABC', so charAt(2)='C'. Case 'C' assigns bar=param, making bar tainted. This tainted value is then concatenated directly into a SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute() with PreparedStatement and use setString() to bind the parameter safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01313.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in BenchmarkTest01313\n\nUser input from request parameter 'BenchmarkTest01313' flows through the doSomething method. The list operations add 'safe', param, 'moresafe', then remove index 0 ('safe'), leaving [param, 'moresafe']. valuesList.get(0) returns param (tainted). This tainted value is then concatenated directly into a SQL INSERT statement.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify the query structure, or execute additional SQL statements.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql) with PreparedStatement and use setString() to bind the parameter safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01314.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in BenchmarkTest01314\n\nUser input from request parameter 'BenchmarkTest01314' flows through the doSomething method and is concatenated directly into a SQL INSERT statement. The condition (500/42)+196 evaluates to 207>200 (true), so bar=param executes, making bar tainted.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify the query structure, or execute additional SQL statements.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql) with PreparedStatement and use setString() to bind the parameter safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01316.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection in BenchmarkTest01316\n\nUser input from request parameter 'BenchmarkTest01316' flows through the doSomething method and is concatenated directly into an XPath expression without sanitization. The condition (500/42)+196 evaluates to 207>200 (true), so bar=param executes, making bar tainted. This tainted value is then concatenated into the XPath query string.\n\nImpact: An attacker can manipulate the XPath query to access unauthorized data from the XML document, bypass authentication checks, or extract sensitive information.\n\nFix: Use parameterized XPath queries or sanitize input by validating that it contains no single quotes. Alternatively, use XPath variable binding with XPathExpression.evaluate() and pass variables separately.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01326.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection\n\nUser-controlled input from request parameter 'BenchmarkTest01326' flows through Base64 encoding/decoding (which does not sanitize) and is directly concatenated into an LDAP filter string without proper escaping. The filter construction 'String filter = \"(&(objectclass=person))(|(uid=\" + bar + \")(street={0}))\"' allows an attacker to inject arbitrary LDAP filter syntax.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, access unauthorized data, or enumerate directory information by injecting LDAP metacharacters like *, ), (, |, &, etc.\n\nFix: Use ESAPI LDAP encoding: String safeBar = ESAPI.encoder().encodeForLDAP(bar); or use parameterized LDAP queries if supported by your LDAP library. Validate input against a whitelist of allowed characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01353.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in ProcessBuilder\n\nUser-controlled input from request parameter 'BenchmarkTest01353' flows through a switch statement where switchTarget is 'B' (from guess.charAt(1) where guess='ABC'). The case 'B' assigns bar='bob', making it safe. However, the data flow analysis shows that the switch statement has cases 'A', 'C', and 'D' that would assign param to bar. While the current execution path is safe, the code pattern is vulnerable if the switch target changes.\n\nImpact: If the code is modified such that switchTarget evaluates to 'A', 'C', or 'D', an attacker could inject arbitrary OS commands that would be executed with the privileges of the application server.\n\nFix: Use parameterized command execution or validate/sanitize user input before including it in OS commands. Consider using ProcessBuilder with separate arguments instead of concatenating commands.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01360.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Runtime.exec()\n\nUser-controlled input from request parameter 'BenchmarkTest01360' flows through a switch statement where switchTarget is 'C' (from guess.charAt(2) where guess='ABC'). The case 'C' assigns param to bar, making bar tainted. This tainted value is then concatenated directly into an OS command string and executed via Runtime.exec(), allowing command injection.\n\nImpact: An attacker could inject arbitrary OS commands that would be executed with the privileges of the application server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Use ProcessBuilder with separate command arguments instead of string concatenation. Validate and sanitize user input before including it in OS commands, or use a whitelist of allowed values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01361.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest01361' flows directly into the environment variables array (argsEnv) of Runtime.exec(). The param is retrieved from request.getParameterMap(), passed through the Test.doSomething() method unchanged, and then placed into argsEnv. An attacker can inject malicious environment variables that could affect command execution behavior.\n\nImpact: An attacker can manipulate environment variables passed to the executed process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize user input before using it in environment variables. Use a whitelist approach to only allow specific, safe values. Consider whether user input should influence environment variables at all.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01362.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest01362' flows into the command arguments. The param is retrieved from request.getParameterMap(), and in the Test.doSomething() method, the switch statement evaluates 'ABC'.charAt(2) which equals 'C'. This matches case 'C', which assigns param to bar. The bar value then flows into the args array as part of the command string (cmd + bar), making it vulnerable to command injection.\n\nImpact: An attacker can inject arbitrary commands or command arguments that will be executed by the system, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into command strings. Use parameterized command execution or validate input against a strict whitelist. Consider using safer alternatives to Runtime.exec() that don't involve shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01363.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest01363' flows directly into the environment variables array (argsEnv) of Runtime.exec(). The param is retrieved from request.getParameterMap(), passed through Base64 encode/decode (which does not sanitize the data), and then placed into argsEnv. Base64 encoding is not a security control and the original user input is preserved.\n\nImpact: An attacker can manipulate environment variables passed to the executed process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize user input before using it in environment variables. Use a whitelist approach to only allow specific, safe values. Base64 encoding does not provide security protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01365.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via String Concatenation\n\nThe code evaluates the condition (7*42) - 86 > 200, which equals 294 - 86 = 208 > 200, which is TRUE. Therefore, bar is assigned the constant 'This_should_always_happen', not the user input param. However, this is still a dangerous pattern as the command is constructed via string concatenation (cmd + bar). While the current data flow is safe, the pattern itself is vulnerable.\n\nImpact: While the current implementation assigns a safe constant to bar, the code pattern of concatenating values into command strings is inherently dangerous. Any future code changes could introduce command injection vulnerabilities.\n\nFix: Use parameterized command execution instead of string concatenation. Refactor to use ProcessBuilder with separate command and argument arrays, or validate all inputs against a strict whitelist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01379.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter 'BenchmarkTest01379' is concatenated directly into a SQL callable statement. The parameter flows through list operations (add to list, remove first element, get first element) and remains tainted. The SQL query is constructed using string concatenation: String sql = \"{call \" + bar + \"}\", where bar contains unsanitized user input.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise. The attacker could execute stored procedures with malicious parameters or inject additional SQL commands.\n\nFix: Use parameterized queries or prepared statements with bound parameters instead of string concatenation. For CallableStatement, use registerOutParameter and setString methods to safely pass parameters to stored procedures.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01381.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01381' flows through a ternary expression where the condition (7*42)-106 > 200 evaluates to 188 > 200 (false), causing bar to be assigned the user-controlled param value. This tainted value is then concatenated directly into a SQL query string: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\". Although the query uses PreparedStatement, the SQL string itself is constructed with concatenation, allowing SQL injection in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands through the BenchmarkTest01381 parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a proper parameterized query: \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and bind both values using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01382.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01382' flows through an if statement where the condition (500/42)+196 > 200 evaluates to 207 > 200 (true), causing bar to be assigned the user-controlled param value. This tainted value is then concatenated directly into a SQL query string: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\". Although the query uses PreparedStatement, the SQL string itself is constructed with concatenation, allowing SQL injection in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands through the BenchmarkTest01382 parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a proper parameterized query: \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and bind both values using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01383.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01383' flows through ThingFactory.createThing().doSomething(), which is a pass-through method that returns its input unchanged. The tainted value is then concatenated directly into a SQL query string: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\". Although the query uses PreparedStatement, the SQL string itself is constructed with concatenation, allowing SQL injection in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands through the BenchmarkTest01383 parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a proper parameterized query: \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and bind both values using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01384.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01384' flows through a ternary expression where the condition (7*42)-106 > 200 evaluates to 188 > 200 (false), causing bar to be assigned the user-controlled param value. This tainted value is then concatenated directly into a SQL query string: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\". Although the query uses PreparedStatement, the SQL string itself is constructed with concatenation, allowing SQL injection in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands through the BenchmarkTest01384 parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a proper parameterized query: \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and bind both values using statement.setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01388.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01388' flows through a switch statement where guess.charAt(2) evaluates to 'C', matching case 'C' which assigns param to bar. This tainted value is then concatenated directly into a SQL query string: \"SELECT userid from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\". The query is executed via JDBCtemplate.queryForObject() with string concatenation, allowing SQL injection in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands through the BenchmarkTest01388 parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a proper parameterized query using Spring's JdbcTemplate with placeholders: \"SELECT userid from USERS where USERNAME=? and PASSWORD=?\" and pass parameters as separate arguments.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01390.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01390' flows through ThingFactory.createThing().doSomething(), which is a pass-through method that returns its input unchanged. The tainted value is then concatenated directly into a SQL query string: \"SELECT userid from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\". The query is executed via JDBCtemplate.queryForObject() with string concatenation, allowing SQL injection in the PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands through the BenchmarkTest01390 parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a proper parameterized query using Spring's JdbcTemplate with placeholders: \"SELECT userid from USERS where USERNAME=? and PASSWORD=?\" and pass parameters as separate arguments.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01391.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01391' is retrieved from a HashMap and directly concatenated into a SQL query without sanitization. The parameter value is stored in the HashMap at key 'keyB-24596' and then retrieved, flowing unchanged into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database contents, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01394.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01394' flows through a switch statement. The switch evaluates guess.charAt(2) which equals 'C', causing case 'C' to execute and assign param (user input) to bar. This tainted value is then directly concatenated into a SQL INSERT statement without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify database structure, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01395.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01395' flows through a ternary operator. The condition (7*42)-106 > 200 evaluates to 188 > 200 which is false, causing bar to be assigned param (user input). This tainted value is then directly concatenated into a SQL INSERT statement without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify database structure, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01396.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01396' is passed through ThingFactory.createThing().doSomething() which is a pass-through method that returns its input unchanged. The tainted value is then directly concatenated into a SQL INSERT statement without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify database structure, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01418.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser-controlled input from request parameter names is used as the format string in response.getWriter().format(). The parameter name flows through Base64 encoding/decoding (which does not sanitize XSS) and is then used as the first argument to format(), making it the format string itself. The 'X-XSS-Protection' header is set to '0'. This allows an attacker to control both the format string and inject malicious content.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in the victim's browser. Since the attacker controls the format string itself, this is particularly dangerous and could lead to complete compromise of the user's session and data.\n\nFix: Never use user input as a format string. Use a constant format string and pass user data as arguments. Example: response.getWriter().format(\"Formatted like: %1$s\", bar). Also apply HTML encoding to user data and remove the 'X-XSS-Protection: 0' header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01430.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Parameter Name in ProcessBuilder\n\nUser-controlled parameter name flows through Base64 encode/decode (which is a pass-through operation) and is concatenated into a shell command executed via ProcessBuilder. The Base64 operations do not sanitize the input for command injection. An attacker can inject shell metacharacters in the parameter name to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server by crafting malicious parameter names containing shell metacharacters or command separators.\n\nFix: Avoid passing user input to shell commands. If necessary, use a whitelist to validate the input contains only safe characters, or use ESAPI.encoder().encodeForOS() to properly escape shell metacharacters. Consider using ProcessBuilder with separate arguments instead of shell command strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01440.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input in Runtime.exec()\n\nThe code evaluates the ternary condition (7 * 18) + 106 > 200, which equals 232 > 200 (true), so bar is assigned the constant 'This_should_always_happen'. However, this is still a dangerous pattern. If the arithmetic were different, user input would flow directly into Runtime.exec() via string concatenation, allowing command injection. While the current implementation is safe due to the constant assignment, the pattern itself is vulnerable.\n\nImpact: If the code logic changes slightly, an attacker could execute arbitrary system commands on the server, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into shell commands. Use ProcessBuilder with separate arguments, or validate and sanitize all input before use. Better yet, avoid executing system commands based on user input entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01441.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Parameter Name\n\nUser-controlled parameter name flows through ThingFactory.createThing().doSomething() (a pass-through) into Runtime.exec() command arguments. The parameter name is extracted from request.getParameterNames() and passed to the command execution without sanitization. ThingFactory.createThing().doSomething() is a pass-through that returns its input unchanged, so the tainted parameter name reaches the command execution sink.\n\nImpact: An attacker can inject arbitrary OS commands by controlling the parameter name, leading to complete system compromise.\n\nFix: Validate and sanitize the parameter name before using it in command execution. Use a whitelist of allowed parameter names or avoid using user input in OS commands entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01442.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled parameter name flows into the environment variables parameter (argsEnv) of Runtime.exec(). The switch statement evaluates 'ABC'.charAt(2) which is 'C', matching case 'C' which assigns param to bar. This tainted value is then passed as an environment variable to the command execution.\n\nImpact: An attacker can inject malicious environment variables that may be used by the executed command, potentially leading to command injection or information disclosure.\n\nFix: Validate and sanitize user input before using it in environment variables. Use a whitelist approach for allowed environment variable values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01446.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Parameter Name\n\nUser-controlled parameter name flows through Base64 encode/decode (which preserves the tainted data) into Runtime.exec() command string concatenation. The Base64 operations do not sanitize the input for command injection.\n\nImpact: An attacker can inject arbitrary OS commands by controlling the parameter name, leading to complete system compromise.\n\nFix: Validate and sanitize the parameter name before using it in command execution. Avoid string concatenation for building OS commands; use parameterized command arrays instead.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01460.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in CallableStatement\n\nUser-controlled data from request parameter name is concatenated directly into a SQL callable statement string without sanitization. The parameter name flows through doSomething() where it is stored in a HashMap and retrieved, then concatenated into the SQL string '{call ' + bar + '}'. Although prepareCall() is used, the SQL string itself is constructed via concatenation, making it vulnerable to SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized callable statements with proper parameter binding instead of string concatenation. If the procedure name must be dynamic, validate it against a whitelist of allowed procedure names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01462.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled input from request parameter name flows into a SQL CallableStatement without sanitization. The parameter name is retrieved when a parameter value equals 'BenchmarkTest01462', then passed through doSomething() which returns it unchanged, and concatenated directly into the SQL string: '{call ' + bar + '}'.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with proper binding. For CallableStatement, use registerOutParameter and setString methods instead of string concatenation. Alternatively, validate and sanitize the input against a whitelist of allowed procedure names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01463.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled input from request parameter name flows into a SQL CallableStatement. The ternary condition '(7*42) - 106 > 200' evaluates to false (188 > 200 is false), so bar is assigned the user-controlled param value. This tainted value is then concatenated into the SQL string: '{call ' + bar + '}'.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries with proper binding. For CallableStatement, use registerOutParameter and setString methods instead of string concatenation. Alternatively, validate and sanitize the input against a whitelist of allowed procedure names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01464.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser-controlled input from request parameter name flows into a SQL PreparedStatement query string. The switch statement evaluates guess.charAt(2) which is 'C', matching case 'C' where bar is assigned param. This tainted value is concatenated into the SQL string before the PreparedStatement is created, bypassing parameterization: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\".\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, authentication bypass, or complete database compromise.\n\nFix: Move the bar value to a parameterized placeholder. Use statement.setString(2, bar) instead of concatenating bar into the SQL string. The corrected SQL should be: \"SELECT * from USERS where USERNAME=? and PASSWORD=?\".",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01465.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate\n\nUser-controlled input from request parameter name flows into a Spring JDBCTemplate execute method. After list manipulation (add 'safe', add param, add 'moresafe', remove index 0), bar is assigned valuesList.get(0) which retrieves param. This tainted value is concatenated into the SQL string: \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\".\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, authentication bypass, or complete database compromise.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Replace the execute method with query or update methods that support parameter binding, such as: jdbcTemplate.query(sql, new Object[]{bar}, rowMapper).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01466.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate\n\nUser-controlled input from request parameter name flows into a Spring JDBCTemplate query method. After list manipulation (add 'safe', add param, add 'moresafe', remove index 0), bar is assigned valuesList.get(0) which retrieves param. This tainted value is concatenated into the SQL string: \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\".\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, authentication bypass, or complete database compromise.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Use the query method with parameter binding: jdbcTemplate.query(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\", new Object[]{bar}, rowMapper).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01470.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate\n\nUser-controlled input from request parameter name flows directly into a Spring JDBCTemplate queryForMap method. The param value is passed through doSomething() which returns it unchanged as bar, then concatenated into the SQL string: \"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\".\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, authentication bypass, or complete database compromise.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Use the queryForMap method with parameter binding: jdbcTemplate.queryForMap(\"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD=?\", new Object[]{bar}).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01471.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled parameter name is concatenated directly into a SQL query. The code retrieves the parameter name (not value) that matches 'BenchmarkTest01471', passes it through doSomething() which removes the first element from a list ['safe', param, 'moresafe'], making param (the user-controlled parameter name) at index 0. This tainted value is then concatenated into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by crafting malicious parameter names, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace the string concatenation with: PreparedStatement pstmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); pstmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01473.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled parameter name is concatenated directly into a SQL query. The ternary condition '(7*42) - 106 > 200' evaluates to '294 - 106 = 188 > 200' which is FALSE, so bar is assigned param (the user-controlled parameter name). This tainted value is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by crafting malicious parameter names, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01474.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled parameter name is concatenated directly into a SQL INSERT query. The parameter name flows through Base64 encode/decode (which doesn't sanitize SQL injection) and is concatenated into the query.\n\nImpact: An attacker can inject arbitrary SQL commands by crafting malicious parameter names, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01475.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled parameter name is passed through ThingFactory.createThing().doSomething() which is a pass-through that returns the input unchanged. This tainted value is then concatenated into a SQL INSERT query.\n\nImpact: An attacker can inject arbitrary SQL commands by crafting malicious parameter names, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01476.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled parameter name is passed through ThingFactory.createThing().doSomething() which is a pass-through that returns the input unchanged. This tainted value is then concatenated into a SQL INSERT query.\n\nImpact: An attacker can inject arbitrary SQL commands by crafting malicious parameter names, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01477.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled parameter name is concatenated directly into a SQL INSERT query. The switch statement evaluates 'ABC'.charAt(2) which is 'C', matching case 'C' which assigns param to bar. This tainted value is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by crafting malicious parameter names, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01478.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection\n\nUser-controlled parameter name is concatenated directly into an XPath expression. The ternary condition '(7*42) - 106 > 200' evaluates to FALSE, so bar is assigned param (the user-controlled parameter name). This tainted value is then concatenated into the XPath query '/Employees/Employee[@emplid='' + bar + '']' without sanitization.\n\nImpact: An attacker can manipulate the XPath query to access unauthorized data from the XML document by injecting XPath syntax through crafted parameter names.\n\nFix: Use parameterized XPath queries or validate/sanitize the input by checking for single quotes and rejecting input containing them before constructing the XPath expression.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01490.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection\n\nThe code constructs an LDAP search filter by directly concatenating user-controlled input (bar variable, which derives from request parameter) into the filter string without proper sanitization. The filter string '(&(objectclass=person))(|(uid=' + bar + ')(street={0}))' allows an attacker to inject malicious LDAP filter syntax.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, access unauthorized data, or enumerate LDAP directory information. For example, injecting '*)(uid=*))(|(uid=' would return all user records instead of a specific user.\n\nFix: Use parameterized LDAP queries or properly escape special LDAP characters in user input. Use ESAPI's encodeForLDAP() method to sanitize the input before constructing the filter, or use the parameterized approach where all user input is passed through the filters array parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01501.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input\n\nUser-controlled input from request parameter 'BenchmarkTest01501' flows through SeparateClassRequest.getTheParameter() and a list manipulation (add, remove, get) into an LDAP filter without sanitization. The filter string is constructed via string concatenation: `String filter = \"(&(objectclass=person)(uid=\" + bar + \"))\";` where `bar` contains the user input after list operations (add safe, add param, add moresafe, remove index 0 leaves param at index 0).\n\nImpact: An attacker can inject malicious LDAP filter syntax to bypass authentication, extract sensitive directory information, or modify LDAP queries to return unauthorized data.\n\nFix: Use parameterized LDAP queries or sanitize user input by escaping special LDAP characters. ESAPI provides encodeForLDAP() method: `String filter = \"(&(objectclass=person)(uid=\" + ESAPI.encoder().encodeForLDAP(bar) + \"))\";`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01512.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via printf with user-controlled format string\n\nUser input is used directly as the format string in response.getWriter().printf(bar, obj). The user input flows from scr.getTheParameter() through string manipulation (StringBuilder.replace) into bar, which is then used as the format string itself. With X-XSS-Protection disabled, this allows both XSS and format string attacks. An attacker can inject format specifiers to read data or inject malicious content.\n\nImpact: An attacker can inject malicious JavaScript for XSS attacks, or use format string specifiers to potentially read sensitive data from memory or cause application errors.\n\nFix: Never use user input as a format string. Use a fixed format string and pass user data as arguments: response.getWriter().printf(\"User input: %s\", Encode.forHtml(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01517.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via ProcessBuilder\n\nUser input flows into a shell command executed via ProcessBuilder. The code retrieves user input via scr.getTheParameter(), and the condition (500/42) + 196 = 11 + 196 = 207 > 200 is true, so bar = param. This tainted value is concatenated into the command string \"echo \" + bar and executed via ProcessBuilder. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands with the privileges of the web application, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized commands or validate/sanitize input strictly. Better yet, avoid shell execution entirely if possible. If necessary, use a whitelist approach to validate input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01531.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input flows into the environment variables parameter (argsEnv) of Runtime.exec(). The doSomething() method adds user input to a list, removes the first element, then retrieves index 0 which contains the user parameter. This tainted value is passed as an environment variable to the exec() call, allowing command injection through environment variable manipulation.\n\nImpact: An attacker can inject malicious environment variables that could alter command execution behavior, potentially leading to arbitrary command execution or information disclosure.\n\nFix: Avoid passing user-controlled data to Runtime.exec() environment variables. If environment variables must be set, validate and sanitize all input against a strict whitelist of allowed values. Consider using ProcessBuilder with explicit environment variable control instead.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01533.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input flows into the environment variables parameter (argsEnv) of Runtime.exec(). The doSomething() method performs Base64 encoding and decoding on the user parameter, which is a pass-through operation that preserves the tainted data. This value is then passed as an environment variable to exec(), enabling command injection.\n\nImpact: An attacker can inject malicious environment variables that could alter command execution behavior, potentially leading to arbitrary command execution or information disclosure.\n\nFix: Avoid passing user-controlled data to Runtime.exec() environment variables. If environment variables must be set, validate and sanitize all input against a strict whitelist of allowed values. Consider using ProcessBuilder with explicit environment variable control instead.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01552.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01552' is concatenated directly into a SQL query string. The parameter flows through SeparateClassRequest.getTheParameter() and Test.doSomething() (which returns it unchanged) into the SQL query. Although PreparedStatement is used, the SQL string itself is constructed with concatenation before being passed to prepareStatement(), making it vulnerable to SQL injection.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries properly. Move the bar variable to a parameter binding: sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\"; statement.setString(1, \"foo\"); statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01554.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01554' is concatenated directly into a SQL query. The parameter flows through SeparateClassRequest.getTheParameter(), then through Test.doSomething() where it's added to a list, the first element is removed, and then retrieved at index 0 (which is now the param value). This tainted value is concatenated into the SQL query string.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement parameter binding instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01557.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01557' is concatenated directly into a SQL query. The parameter flows through SeparateClassRequest.getTheParameter(), then through Test.doSomething() where it's stored in a HashMap with key 'keyB-20581' and retrieved with the same key. This tainted value is concatenated into the SQL query string.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement parameter binding instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01558.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01558' is concatenated directly into a SQL query. The parameter flows through SeparateClassRequest.getTheParameter(), then through Test.doSomething() where a switch statement on guess.charAt(2) (which equals 'C') assigns param to bar in the 'case C:' branch. This tainted value is concatenated into the SQL query string.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement parameter binding instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01559.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01559' is concatenated directly into a SQL query. The parameter flows through SeparateClassRequest.getTheParameter(), then through Test.doSomething() where it's stored in a HashMap with key 'keyB-31651' and retrieved with the same key. This tainted value is concatenated into the SQL query string.\n\nImpact: An attacker can inject malicious SQL code to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement parameter binding instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01560.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01560' is concatenated directly into a SQL INSERT statement. The parameter flows through SeparateClassRequest.getTheParameter(), then through Test.doSomething() where the condition (500/42)+196 > 200 evaluates to 207 > 200 (true), so bar is assigned param. This tainted value is concatenated into the SQL query string.\n\nImpact: An attacker can inject malicious SQL code to modify the INSERT statement, potentially inserting malicious data, breaking out of the INSERT to execute additional SQL commands, or causing database errors.\n\nFix: Use parameterized queries with PreparedStatement parameter binding instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01561.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection in BenchmarkTest01561\n\nUser input flows into an XPath expression without sanitization. The code retrieves user input via SeparateClassRequest.getTheParameter(), performs a ternary operation that evaluates to `param` (since (7*42)-106 = 188, and 188 > 200 is false), and concatenates it directly into an XPath query: `/Employees/Employee[@emplid='` + bar + `']`. This allows an attacker to inject malicious XPath syntax.\n\nImpact: An attacker can manipulate the XPath query to bypass authentication, extract sensitive data from the XML document, or access unauthorized records by injecting XPath operators like `' or '1'='1`.\n\nFix: Use parameterized XPath queries or validate/sanitize the input by checking for and rejecting single quotes before building the XPath expression. Alternatively, use XPath variable binding if supported by the implementation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01568.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection in BenchmarkTest01568\n\nUser input flows into an LDAP filter without sanitization. The code retrieves user input via request.getParameterValues(), performs Base64 encode/decode (which does not sanitize), and concatenates it directly into an LDAP filter: `(&(objectclass=person)(uid=` + bar + `))`. This allows LDAP injection attacks.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, access unauthorized records, or extract sensitive directory information by injecting LDAP operators like `*)(uid=*))(|(uid=*`.\n\nFix: Use ESAPI's encodeForLDAP() method to sanitize the input before building the LDAP filter: `String safeBar = ESAPI.encoder().encodeForLDAP(bar);` or validate that the input contains no special LDAP characters like `*`, `(`, `)`, `\\`, `/`.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01601.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via ProcessBuilder with User Input\n\nUser-controlled input from request parameter 'BenchmarkTest01601' flows through list manipulation (add/remove operations) and is concatenated into a command string that is executed via ProcessBuilder. After removing the first element from the list ['safe', param, 'moresafe'], the list becomes [param, 'moresafe'], so get(0) returns the tainted param value. This tainted value is then concatenated into 'echo ' + bar and executed as a system command.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the BenchmarkTest01601 parameter, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into OS commands. Use parameterized command execution with proper input validation and sanitization. Consider using a whitelist of allowed values or escaping special shell characters using ESAPI.encoder().encodeForOS().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01609.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Runtime.exec with User Input\n\nUser-controlled input from request parameter 'BenchmarkTest01609' flows through list manipulation and is concatenated into a command string executed via Runtime.exec(). After removing the first element from the list ['safe', param, 'moresafe'], get(0) returns the tainted param value which is concatenated with the command string.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the BenchmarkTest01609 parameter, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into OS commands. Use ProcessBuilder with separate command arguments, or validate/sanitize input using ESAPI.encoder().encodeForOS() before use.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01610.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Runtime.exec with User Input\n\nUser-controlled input from request parameter 'BenchmarkTest01610' is Base64 encoded and decoded (which is a pass-through operation that preserves the tainted data) and then concatenated into a command string executed via Runtime.exec().\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the BenchmarkTest01610 parameter, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into OS commands. Use ProcessBuilder with separate command arguments, or validate/sanitize input using ESAPI.encoder().encodeForOS() before use.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01620.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via CallableStatement\n\nUser-controlled data from request parameter 'BenchmarkTest01620' flows through a switch statement. The switch target is 'guess.charAt(2)' which evaluates to 'C' (the third character of \"ABC\"). Case 'C' assigns param to bar, making bar tainted. This tainted data is then concatenated directly into a SQL callable statement string: 'String sql = \"{call \" + bar + \"}\";'. The SQL string is then executed via connection.prepareCall(sql).executeQuery(). Although prepareCall is used, the SQL string itself is constructed via concatenation, allowing SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized callable statements with proper parameter binding. Never concatenate user input directly into SQL strings. Example: Use CallableStatement with setString() for parameters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01621.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input from request parameter 'BenchmarkTest01621' flows through a ternary condition where (7*42)-106=188, which is NOT > 200, causing bar to be assigned the user-controlled param value. This tainted value is then concatenated directly into a SQL callable statement string without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement or CallableStatement parameter binding (e.g., setString()) instead of string concatenation. Never concatenate user input directly into SQL strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01623.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input from request parameter 'BenchmarkTest01623' flows through a condition where (500/42)+196=207, which IS > 200, causing bar to be assigned the user-controlled param value. This tainted value is then concatenated directly into a SQL callable statement string without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement or CallableStatement parameter binding (e.g., setString()) instead of string concatenation. Never concatenate user input directly into SQL strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01624.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SELECT Statement\n\nUser input from request parameter 'BenchmarkTest01624' is added to a list, the first element is removed, and then get(0) retrieves the user-controlled param value. This tainted value is concatenated directly into a SQL SELECT statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement parameter binding (e.g., setString()) instead of string concatenation. Never concatenate user input directly into SQL strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01625.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SELECT Statement\n\nUser input from request parameter 'BenchmarkTest01625' is passed through ThingFactory.createThing().doSomething(), which is a pass-through that returns the input unchanged. This tainted value is concatenated directly into a SQL SELECT statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement parameter binding (e.g., setString()) instead of string concatenation. Never concatenate user input directly into SQL strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01626.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SELECT Statement\n\nUser input from request parameter 'BenchmarkTest01626' flows through a switch statement where 'ABC'.charAt(2) evaluates to 'C', which matches case 'C' and assigns param to bar. This tainted value is concatenated directly into a SQL SELECT statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement parameter binding (e.g., setString()) instead of string concatenation. Never concatenate user input directly into SQL strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01627.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in SELECT Statement\n\nUser input from request parameter 'BenchmarkTest01627' is directly assigned to bar without any sanitization. This tainted value is concatenated directly into a SQL SELECT statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement parameter binding (e.g., setString()) instead of string concatenation. Never concatenate user input directly into SQL strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01630.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in INSERT Statement\n\nUser input from request parameter 'BenchmarkTest01630' is Base64 encoded then decoded, which returns the original param value unchanged. This tainted value is concatenated directly into a SQL INSERT statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with PreparedStatement parameter binding (e.g., setString()) instead of string concatenation. Never concatenate user input directly into SQL strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01631.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest01631' is concatenated directly into a SQL INSERT statement without sanitization. The doSomething() method evaluates the condition (500/42) + 196 = 11 + 196 = 207, which is > 200, so bar = param (user input). This tainted value is then concatenated into the SQL query: \"INSERT INTO users (username, password) VALUES ('foo','\" + bar + \"')\"\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement pstmt = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); pstmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01673.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input\n\nUser input from query string parameter flows directly into a shell command without sanitization. The doSomething() method returns param unchanged, which is then concatenated into an OS command executed via ProcessBuilder.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the query parameter, leading to complete system compromise.\n\nFix: Avoid passing user input to shell commands. If necessary, use strict input validation with a whitelist of allowed characters, or use parameterized command execution without shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01674.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Pass-Through Method\n\nUser input flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is concatenated into an OS command executed via ProcessBuilder. The tainted input reaches the command execution sink.\n\nImpact: An attacker can inject arbitrary OS commands, leading to remote code execution and full system compromise.\n\nFix: Validate and sanitize all user input before using in OS commands. Use parameterized execution or avoid shell commands entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01685.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input in Command Arguments\n\nUser-controlled input from the query string parameter flows through to the command execution arguments array. The condition `(500 / 42) + 196 > 200` evaluates to true (207 > 200), causing `bar = param` to execute, making bar contain unsanitized user input that is then passed to Runtime.exec() in the args array.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the query parameter, leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to OS commands. If necessary, use a whitelist of allowed values or properly sanitize input using ESAPI.encoder().encodeForOS().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01689.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input in Command String\n\nUser-controlled input from the query string parameter flows through to command execution. The condition `(500 / 42) + 196 > 200` evaluates to true (207 > 200), causing `bar = param` to execute. The tainted bar variable is then concatenated directly into the command string passed to Runtime.exec().\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the query parameter, leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to OS commands. If necessary, use a whitelist of allowed values or properly sanitize input using ESAPI.encoder().encodeForOS().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01690.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Environment Variables\n\nUser-controlled input from the query string parameter flows directly into the environment variables array (argsEnv) passed to Runtime.exec(). The param value is assigned directly to bar without sanitization and then placed in the argsEnv array.\n\nImpact: An attacker can inject malicious environment variables that may be used by the executed command, potentially leading to command injection, privilege escalation, or information disclosure depending on how the command uses environment variables.\n\nFix: Avoid passing user input to command environment variables. If necessary, validate and sanitize all input using a strict whitelist of allowed values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01691.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input flows into the environment variables parameter (argsEnv) of Runtime.exec(). The doSomething() method performs a switch on guess.charAt(2), which equals 'C' (the third character of \"ABC\"). Case 'C' assigns param (user input from query string) to bar. This tainted value is then placed in argsEnv array and passed to r.exec(cmd, argsEnv), allowing an attacker to inject malicious environment variables that can influence command execution.\n\nImpact: An attacker can inject arbitrary environment variables that may alter the behavior of the executed command, potentially leading to command injection, privilege escalation, or information disclosure depending on how the command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in command execution contexts. Use allowlists for acceptable values. Consider using ProcessBuilder with explicit environment control instead of Runtime.exec().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01692.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via String Concatenation\n\nUser input is concatenated directly into a command string passed to Runtime.exec(). However, data flow analysis shows that doSomething() assigns the static string \"barbarians_at_the_gate\" to g28453, passes it through thing.doSomething() (a pass-through), and returns it as bar. Since bar derives from a string literal (not from param), this is actually safe despite the dangerous pattern.\n\nImpact: None - the current implementation is safe because only a constant string reaches the exec() call.\n\nFix: While currently safe, the pattern of string concatenation in exec() is dangerous. Refactor to use ProcessBuilder or parameterized command execution to prevent future vulnerabilities if the code changes.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01693.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via String Concatenation\n\nUser input is concatenated directly into a command string passed to Runtime.exec(). The doSomething() method evaluates the ternary condition (7*18)+106 > 200, which equals 232 > 200 (true), so bar is assigned the constant \"This_should_always_happen\". Since bar is a constant, this is actually safe despite the dangerous pattern.\n\nImpact: None - the current implementation is safe because only a constant string reaches the exec() call.\n\nFix: While currently safe, the pattern of string concatenation in exec() is dangerous. Refactor to use ProcessBuilder or parameterized command execution to prevent future vulnerabilities if the code changes.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01712.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input from the query string parameter 'BenchmarkTest01712' is concatenated directly into a SQL callable statement. The doSomething() method stores param in a HashMap and retrieves it back, so bar contains the tainted user input. This is then concatenated into the SQL string: '{call ' + bar + '}'.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries or prepared statements with bound parameters. Never concatenate user input directly into SQL statements.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01715.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser input from the query string parameter 'BenchmarkTest01715' flows through ThingFactory.createThing().doSomething(param), which is a pass-through that returns param unchanged. The tainted data is then concatenated into a SQL query: 'SELECT * from USERS where USERNAME=? and PASSWORD='' + bar + ''''. While USERNAME is parameterized, PASSWORD is vulnerable to SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands through the PASSWORD field, potentially bypassing authentication, accessing unauthorized data, or modifying database contents.\n\nFix: Use parameterized binding for all user inputs in SQL queries. Replace string concatenation with statement.setString() for the PASSWORD parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01716.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser input from the query string parameter 'BenchmarkTest01716' is concatenated into a SQL query. The doSomething() method evaluates (500/42)+196 > 200, which equals 207 > 200 (true), so bar is assigned param (user input). This is concatenated into: 'SELECT * from USERS where USERNAME=? and PASSWORD='' + bar + ''''.\n\nImpact: An attacker can inject arbitrary SQL commands through the PASSWORD field, potentially bypassing authentication, accessing unauthorized data, or modifying database contents.\n\nFix: Use parameterized binding for all user inputs in SQL queries. Replace string concatenation with statement.setString() for the PASSWORD parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01718.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser input from the query string parameter 'BenchmarkTest01718' is concatenated into a SQL query. The doSomething() method evaluates (500/42)+196 > 200, which equals 207 > 200 (true), so bar is assigned param (user input). This is concatenated into: 'SELECT * from USERS where USERNAME=? and PASSWORD='' + bar + ''''.\n\nImpact: An attacker can inject arbitrary SQL commands through the PASSWORD field, potentially bypassing authentication, accessing unauthorized data, or modifying database contents.\n\nFix: Use parameterized binding for all user inputs in SQL queries. Replace string concatenation with statement.setString() for the PASSWORD parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01720.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate\n\nUser input from the query string parameter 'BenchmarkTest01720' is concatenated into a SQL query executed via Spring's JDBCTemplate. The doSomething() method evaluates (7*42)-106 > 200, which equals 294-106=188 > 200 (false), so bar is assigned param (user input). This is concatenated into: 'SELECT * from USERS where USERNAME='foo' and PASSWORD='' + bar + ''''.\n\nImpact: An attacker can inject arbitrary SQL commands through the PASSWORD field, potentially accessing unauthorized data, modifying database contents, or executing administrative operations.\n\nFix: Use Spring's parameterized query methods like JdbcTemplate.query() with PreparedStatementSetter or named parameters. Never concatenate user input directly into SQL statements.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01721.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from the query string is concatenated directly into a SQL query without sanitization. The input flows from request.getQueryString() through a pass-through method (ThingFactory.createThing().doSomething()) and is concatenated into the SQL WHERE clause.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the query with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01723.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from the query string is concatenated directly into a SQL query. The ternary condition (7*42) - 106 > 200 evaluates to false (188 > 200), causing param (user input) to be assigned to bar, which is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the query with: PreparedStatement stmt = connection.prepareStatement(\"SELECT userid from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01724.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from the query string is concatenated directly into a SQL query. The ternary condition (7*42) - 106 > 200 evaluates to false (188 > 200), causing param (user input) to be assigned to bar, which is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the query with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01725.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from the query string is concatenated directly into a SQL query without sanitization. The input flows from request.getQueryString() through a pass-through method (ThingFactory.createThing().doSomething()) and is concatenated into the SQL WHERE clause.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the query with: PreparedStatement stmt = connection.prepareStatement(\"SELECT TOP 1 USERNAME from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01726.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from the query string is concatenated directly into a SQL query. The switch statement evaluates \"ABC\".charAt(2) which equals 'C', causing case 'C' to execute and assign param (user input) to bar, which is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the query with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01727.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from the query string is concatenated directly into a SQL query. The if condition (500/42) + 196 > 200 evaluates to true (207 > 200), causing param (user input) to be assigned to bar, which is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the query with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01728.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from the query string is concatenated directly into a SQL query. The ternary condition (7*42) - 106 > 200 evaluates to false (188 > 200), causing param (user input) to be assigned to bar, which is then concatenated into the SQL query executed via statement.addBatch().\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the query with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01730.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from the query string is concatenated directly into a SQL query. After list manipulation (add safe, add param, add moresafe, remove index 0), the list becomes [param, moresafe]. The code retrieves index 0 which contains the user input param, which is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the query with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01731.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in BenchmarkTest01731\n\nUser input from query parameter 'BenchmarkTest01731' flows through a switch statement where switchTarget = 'ABC'.charAt(2) = 'C', which matches case 'C' and assigns param to bar. This tainted value is then concatenated directly into a SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql, ...) with PreparedStatement.setString() for all user inputs.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01733.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in BenchmarkTest01733\n\nUser input from query parameter 'BenchmarkTest01733' flows through ThingFactory.createThing().doSomething(param), which is a pass-through that returns param unchanged. This tainted value is then concatenated directly into a SQL INSERT statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify database structure, or execute administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql, ...) with PreparedStatement.setString() for all user inputs.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01734.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection in BenchmarkTest01734\n\nUser input from query parameter 'BenchmarkTest01734' flows through a ternary condition where (7*42) - 106 = 188, and 188 > 200 is FALSE, so bar = param (tainted). This value is then concatenated directly into an XPath expression without sanitization or parameterization.\n\nImpact: An attacker can manipulate XPath queries to access unauthorized data, bypass authentication checks, or extract sensitive information from the XML document.\n\nFix: Use parameterized XPath queries with XPath variables, or validate that the input contains no single quotes before building the query. Alternatively, use XPath 2.0+ with proper variable binding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01736.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection in BenchmarkTest01736\n\nUser input from query parameter 'BenchmarkTest01736' flows through list operations: valuesList = ['safe', param, 'moresafe'], then remove(0) makes it [param, 'moresafe'], so get(0) returns param (tainted). This value is then concatenated directly into an XPath expression without sanitization.\n\nImpact: An attacker can manipulate XPath queries to access unauthorized data, bypass authentication checks, or extract sensitive information from the XML document.\n\nFix: Use parameterized XPath queries with XPath variables, or validate that the input contains no single quotes before building the query. Alternatively, use XPath 2.0+ with proper variable binding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01743.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection Vulnerability\n\nUser-controlled input from SeparateClassRequest flows through Base64 encoding/decoding (which is not a sanitizer) into the LDAP filter string via direct string concatenation. An attacker can inject malicious LDAP filter syntax to bypass authentication, access unauthorized data, or modify the query logic.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication checks, retrieve sensitive user information, or enumerate directory contents. For example, injecting '*)(uid=*))(|(uid=' would match all users regardless of the intended filter.\n\nFix: Use parameterized LDAP queries or properly escape special LDAP characters. Use ESAPI's encodeForLDAP() method: String safeName = ESAPI.encoder().encodeForLDAP(bar); or validate that the input contains no special LDAP characters like *, (, ), \\, /, and null bytes before using it in the filter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01778.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input in ProcessBuilder\n\nUser-controlled input from scr.getTheValue() flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is concatenated directly into a shell command: 'echo ' + bar. This command is then executed via ProcessBuilder, allowing an attacker to inject arbitrary OS commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service. For example, an attacker could inject '; rm -rf /' or '& net user attacker password /add' to execute malicious commands.\n\nFix: Never concatenate user input directly into shell commands. Use parameterized command execution or validate/sanitize input using a whitelist approach. Consider using ProcessBuilder with separate arguments instead of shell interpretation, or use ESAPI.encoder().encodeForOS() to sanitize the input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01803.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input flows through SeparateClassRequest.getTheValue() and a switch statement (where guess.charAt(2) = 'C' causes param to be assigned to bar), then is concatenated directly into a SQL callable statement: String sql = \"{call \" + bar + \"}\". The switch on 'C' assigns the tainted param value to bar, making this vulnerable to SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized CallableStatement with proper parameter binding instead of string concatenation. Example: CallableStatement statement = connection.prepareCall(\"{call procedureName(?)}\"); statement.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01807.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate\n\nUser input flows through SeparateClassRequest.getTheValue() and a switch statement (where guess.charAt(2) = 'C' causes param to be assigned to bar), then is concatenated directly into a SQL query: String sql = \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\". The switch on 'C' assigns the tainted param value to bar, making this vulnerable to SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Example: jdbcTemplate.query(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\", new Object[]{bar}, rowMapper);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01810.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Spring JDBCTemplate\n\nUser input flows through SeparateClassRequest.getTheValue() and a ternary expression. The condition (7*42) - 106 > 200 evaluates to 188 > 200, which is false, so bar is assigned param (tainted). This tainted value is then concatenated directly into a SQL query: String sql = \"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\".\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries with Spring JDBCTemplate. Example: jdbcTemplate.queryForMap(\"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD=?\", bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01821.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection\n\nUser-controlled input is directly concatenated into an XPath expression without sanitization. The code evaluates `(7*42) - 86 = 208 > 200`, which is true, so `bar` is assigned the constant \"This_should_always_happen\". However, the XPath expression is still constructed using string concatenation: `/Employees/Employee[@emplid='\" + bar + \"']`. While the current data flow makes bar safe, the pattern itself is vulnerable if the condition logic changes.\n\nImpact: An attacker could inject malicious XPath syntax to bypass authentication, access unauthorized data, or extract sensitive information from the XML document.\n\nFix: Use parameterized XPath queries or validate/sanitize the input by checking for and rejecting single quotes before constructing the XPath expression.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01850.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Cookie Data\n\nUser-controlled data from a cookie (BenchmarkTest01850) flows through doSomething() where the ternary condition '(7 * 42) - num > 200' evaluates to '294 - 106 = 188 > 200' which is FALSE, so bar is assigned param (user input). This tainted value is then concatenated into a shell command 'echo ' + bar and executed via ProcessBuilder. An attacker can inject arbitrary shell commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server by injecting shell metacharacters in the cookie value, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into shell commands. Use parameterized command execution where the command and arguments are separate. Alternatively, validate and sanitize input strictly, or avoid shell execution entirely. Consider using ESAPI.encoder().encodeForOS() if shell execution is unavoidable.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01851.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Cookie in ProcessBuilder\n\nUser-controlled data from a cookie flows into a shell command without sanitization. The cookie value 'BenchmarkTest01851' is decoded and passed through doSomething(), where the switch statement on guess.charAt(2) evaluates to 'C', causing case 'C' to assign param to bar. This tainted value is then concatenated directly into a shell command executed via ProcessBuilder.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the cookie value, leading to complete system compromise, data exfiltration, or denial of service.\n\nFix: Avoid passing user input to shell commands. If necessary, use a whitelist of allowed values or properly escape/sanitize the input using platform-specific escaping mechanisms. Consider using ProcessBuilder with separate arguments instead of shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01852.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Cookie in ProcessBuilder Array\n\nUser-controlled data from a cookie flows into a shell command without sanitization. The cookie value is decoded and passed through doSomething(), where the ternary condition (7*42) - 106 > 200 evaluates to false (188 > 200 is false), causing bar to be assigned param. This tainted value is then concatenated into a shell command string.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the cookie value, leading to complete system compromise, data exfiltration, or denial of service.\n\nFix: Avoid passing user input to shell commands. If necessary, use a whitelist of allowed values or properly escape/sanitize the input using platform-specific escaping mechanisms. Consider using ProcessBuilder with separate arguments instead of shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01864.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Cookie Value\n\nUser input from a cookie (param) flows through doSomething() where the ternary condition (7*42)-106 > 200 evaluates to 188 > 200 = false, causing bar to be assigned param. This tainted value is then concatenated into a command string (cmd + bar) and passed to Runtime.exec(), allowing command injection.\n\nImpact: An attacker can execute arbitrary operating system commands on the server by manipulating the cookie value, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into shell commands. Use ProcessBuilder with separate arguments, or validate and sanitize input against a strict whitelist of allowed values. Consider using ESAPI.encoder().encodeForOS() if concatenation is unavoidable.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01866.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Pass-Through Does Not Sanitize - Command Injection\n\nUser input from cookie (param) is passed through ThingFactory.createThing().doSomething(param), which is a pass-through that returns the input unchanged. The tainted value flows into bar and is then concatenated into a command string (cmd + bar) passed to Runtime.exec(), enabling command injection.\n\nImpact: An attacker can execute arbitrary operating system commands by manipulating the cookie value, leading to full system compromise.\n\nFix: Use ProcessBuilder with separate command arguments instead of string concatenation. Validate input against a strict whitelist or use ESAPI.encoder().encodeForOS().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01877.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled data from a cookie flows through doSomething() where a switch statement on 'ABC'.charAt(1) (which equals 'B') assigns bar = \"bob\" (a constant). Since the switch target is 'B', only case 'B' executes, making bar safe. However, the SQL query uses string concatenation: String sql = \"{call \" + bar + \"}\". While bar is currently safe due to the constant assignment, the pattern itself is vulnerable if the code changes.\n\nImpact: If the code logic changes such that user input reaches the SQL query, an attacker could execute arbitrary SQL commands, leading to data theft, modification, or deletion.\n\nFix: Use parameterized CallableStatement with registerOutParameter and setString methods instead of string concatenation, even when current data flow appears safe. This prevents future code changes from introducing vulnerabilities.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01878.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser-controlled data from a cookie is evaluated through a ternary condition: bar = (7 * 18) + 106 > 200 ? \"This_should_always_happen\" : param. Computing: (7 * 18) + 106 = 126 + 106 = 232, and 232 > 200 is TRUE, so bar = \"This_should_always_happen\" (safe constant). However, the SQL query uses string concatenation in the PASSWORD clause: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\". While bar is currently a safe constant, the concatenation pattern is inherently dangerous.\n\nImpact: If the code logic changes such that user input reaches the SQL query, an attacker could bypass authentication or execute arbitrary SQL commands.\n\nFix: Use full parameterization for all SQL query components. Replace string concatenation with statement.setString(2, bar) for the PASSWORD parameter. Never mix parameterized and concatenated SQL.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01879.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser-controlled data from a cookie flows through doSomething() where it's added to a list, the first element is removed, and bar = valuesList.get(1) retrieves the last element. After valuesList.add(\"safe\"), valuesList.add(param), valuesList.add(\"moresafe\"), valuesList.remove(0), the list becomes [param, \"moresafe\"]. valuesList.get(1) returns \"moresafe\" (safe). However, the SQL query uses string concatenation: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\". While bar is currently safe, the concatenation pattern is vulnerable.\n\nImpact: If the code logic changes such that user input reaches the SQL query, an attacker could bypass authentication or execute arbitrary SQL commands.\n\nFix: Use full parameterization for all SQL query components. Replace string concatenation with statement.setString(2, bar) for the PASSWORD parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01880.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in PreparedStatement\n\nUser-controlled data from a cookie flows through doSomething() where it's stored in a HashMap and retrieved. The code does: map99153.put(\"keyB-99153\", param); bar = (String) map99153.get(\"keyB-99153\"); bar = (String) map99153.get(\"keyA-99153\"). The final assignment retrieves \"a_Value\" (safe constant) from keyA-99153, overwriting the tainted value. However, the SQL query uses string concatenation: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\". While bar is currently safe due to the overwrite, the concatenation pattern is vulnerable.\n\nImpact: If the code logic changes such that user input reaches the SQL query, an attacker could bypass authentication or execute arbitrary SQL commands.\n\nFix: Use full parameterization for all SQL query components. Replace string concatenation with statement.setString(2, bar) for the PASSWORD parameter. Never mix parameterized and concatenated SQL.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01881.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Input\n\nUser-controlled cookie value is retrieved, stored in a HashMap, and then directly concatenated into a SQL query without sanitization. The cookie value 'BenchmarkTest01881' is decoded and placed into the HashMap at key 'keyB-20027', then retrieved and concatenated into the SQL string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01882.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Input\n\nUser-controlled cookie value is retrieved, stored in a HashMap, and then directly concatenated into a SQL query without sanitization. The cookie value 'BenchmarkTest01882' is decoded and placed into the HashMap at key 'keyB-67948', then retrieved and concatenated into the SQL string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01883.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Input\n\nUser-controlled cookie value is retrieved and directly concatenated into a SQL query without sanitization. The cookie value 'BenchmarkTest01883' is decoded and passed through doSomething() which returns it unchanged, then concatenated into the SQL string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01887.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Input\n\nUser-controlled cookie value is retrieved and directly concatenated into a SQL INSERT statement without sanitization. The cookie value 'BenchmarkTest01887' is decoded and passed through doSomething() which returns it unchanged, then concatenated into the SQL string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data insertion, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01888.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Input\n\nUser-controlled cookie value is retrieved and directly concatenated into a SQL INSERT statement without sanitization. The cookie value 'BenchmarkTest01888' is decoded and the condition (500/42)+196 > 200 evaluates to true (207 > 200), so bar is assigned the tainted param value, which is then concatenated into the SQL string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data insertion, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01889.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Input\n\nUser-controlled cookie value is retrieved and directly concatenated into a SQL INSERT statement without sanitization. The cookie value 'BenchmarkTest01889' is decoded and passed through doSomething() which returns it unchanged, then concatenated into the SQL string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data insertion, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01890.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Cookie Input\n\nUser-controlled cookie value is retrieved and directly concatenated into a SQL INSERT statement without sanitization. The cookie value 'BenchmarkTest01890' is decoded and passed through doSomething() which returns it unchanged, then concatenated into the SQL string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data insertion, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01891.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from a cookie flows into a SQL query via string concatenation. The doSomething method evaluates (7*42)-106 = 188, which is NOT > 200, so the ternary assigns param (user-controlled cookie value) to bar. This tainted value is then concatenated directly into a SQL INSERT statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the cookie value, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.executeUpdate(sql, ...) with PreparedStatement.setString() for all user inputs.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01903.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection in BenchmarkTest01903\n\nUser-controlled input from request header flows directly into an LDAP filter without sanitization. The doSomething method evaluates (7*42)-86 = 208, which is greater than 200, so bar is assigned 'This_should_always_happen' (a constant). However, the arithmetic is incorrect: (7*42) = 294, 294-86 = 208, and 208 > 200 is TRUE, so the condition assigns the constant. Upon re-evaluation: the code assigns the constant string, making this a FALSE POSITIVE for LDAP injection.\n\nImpact: None - the bar variable receives a constant value, not user input.\n\nFix: No fix needed - the current implementation is secure.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01928.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Custom Header in ProcessBuilder\n\nUser-controlled data from the BenchmarkTest01928 header flows into a ProcessBuilder command without sanitization. The doSomething() method performs a switch on guess.charAt(2) which equals 'C', matching case 'C' and assigning param to bar. The bar value is then concatenated into the command string 'echo ' + bar, allowing command injection.\n\nImpact: An attacker can execute arbitrary operating system commands by injecting shell metacharacters in the header value, leading to complete system compromise.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized command execution or validate/sanitize input by whitelisting allowed characters. Consider using ProcessBuilder with separate arguments instead of shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01929.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Custom Header in ProcessBuilder\n\nUser-controlled data from the BenchmarkTest01929 header flows into a ProcessBuilder command without sanitization. The doSomething() method stores param in a HashMap and retrieves it as bar. The bar value is then concatenated into the command string 'echo ' + bar, allowing command injection.\n\nImpact: An attacker can execute arbitrary operating system commands by injecting shell metacharacters in the header value, leading to complete system compromise.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized command execution or validate/sanitize input by whitelisting allowed characters. Consider using ProcessBuilder with separate arguments instead of shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01936.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input\n\nUser input from request header 'BenchmarkTest01936' flows through doSomething() where it is retrieved from a list at index 0 (after removing the first element, param becomes the first element). This tainted data is then concatenated directly into an OS command string and executed via Runtime.exec(). The doSomething method creates a list [\"safe\", param, \"moresafe\"], removes index 0, resulting in [param, \"moresafe\"], then retrieves index 0 which is the user-controlled param value.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the request header value, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into OS commands. Use ProcessBuilder with separate arguments, or validate/sanitize input against a strict whitelist of allowed values. Better yet, avoid executing OS commands based on user input entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01938.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input in Command Arguments\n\nUser input from request header 'BenchmarkTest01938' flows through doSomething() where it is retrieved from a list at index 0 (after removing the first element, param becomes the first element). This tainted data is then placed into the args array as part of the command execution. The doSomething method creates a list [\"safe\", param, \"moresafe\"], removes index 0, resulting in [param, \"moresafe\"], then retrieves index 0 which is the user-controlled param value.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the request header value, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never include user input in OS command arguments without strict validation. Use a whitelist of allowed values or avoid executing OS commands based on user input entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01939.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Environment Variables\n\nUser input from request header 'BenchmarkTest01939' flows through doSomething() and is placed into the argsEnv array (environment variables parameter). While the doSomething method has a condition that should assign a constant when (7*42)-86 > 200, this evaluates to 294-86=208 > 200 which is TRUE, so bar should be 'This_should_always_happen'. However, the user input still flows into the environment variables parameter of Runtime.exec(), which can be exploited on some systems.\n\nImpact: An attacker may be able to manipulate the execution environment of the spawned process, potentially leading to command injection or privilege escalation depending on how the executed command uses environment variables.\n\nFix: Do not place user-controlled data into environment variables for executed processes. Use a fixed set of environment variables or validate input against a strict whitelist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01940.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Input in Command String\n\nUser input from request header 'BenchmarkTest01940' flows through doSomething() where it undergoes Base64 encoding and decoding (which does not sanitize the data), and is then concatenated directly into an OS command string and executed via Runtime.exec().\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the request header value, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into OS commands. Use ProcessBuilder with separate arguments, or validate/sanitize input against a strict whitelist of allowed values. Base64 encoding/decoding does not prevent command injection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01942.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Environment Variable\n\nUser-controlled input from request header 'BenchmarkTest01942' flows directly into the command string (cmd + bar) passed to Runtime.exec(). The doSomething() method returns the param unchanged (bar = param), allowing an attacker to inject arbitrary OS commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server by manipulating the BenchmarkTest01942 header value, leading to complete system compromise.\n\nFix: Never concatenate user input into OS commands. Use parameterized command execution with ProcessBuilder and validate/sanitize all user input. Consider using ESAPI.encoder().encodeForOS() if dynamic command construction is absolutely necessary.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01943.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Data in Command String\n\nAlthough the doSomething() method attempts to retrieve 'keyA-72345' (safe value) from the HashMap, it first stores the user-controlled param under 'keyB-72345'. However, the final retrieval is from 'keyA-72345' which contains 'a_Value' (safe constant). Upon closer inspection, bar is assigned from map72345.get('keyA-72345') which returns 'a_Value', not the user input. This is actually SAFE - the user input is stored but never retrieved.\n\nImpact: None - the code is secure as implemented.\n\nFix: No action needed - this is a false positive upon detailed analysis.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01944.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Switch Statement with User Input\n\nUser-controlled input from request header flows through a switch statement. The switch target is guess.charAt(2) where guess='ABC', so charAt(2)='C'. Case 'C' assigns bar=param, making bar tainted. This tainted value is then concatenated into the OS command string passed to Runtime.exec().\n\nImpact: An attacker can execute arbitrary operating system commands by manipulating the BenchmarkTest01944 header value, leading to complete system compromise.\n\nFix: Never concatenate user input into OS commands. Use parameterized command execution with ProcessBuilder and validate/sanitize all user input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01962.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest01962\n\nUser-controlled input from the HTTP header 'BenchmarkTest01962' is directly concatenated into a SQL query without proper sanitization. The Base64 encode/decode operations do not sanitize the input for SQL injection. The input flows from request.getHeader() through Base64 encoding/decoding (which returns the original value) and is concatenated into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01962 HTTP header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a proper parameterized query: statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01963.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest01963\n\nUser-controlled input from the HTTP header 'BenchmarkTest01963' is directly concatenated into a SQL query. The doSomething() method performs a direct assignment (bar = param) without any sanitization, and the tainted value is then concatenated into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01963 HTTP header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a proper parameterized query.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01964.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest01964\n\nUser-controlled input from the HTTP header 'BenchmarkTest01964' is directly concatenated into a SQL query. The doSomething() method uses a switch statement where guess.charAt(2) evaluates to 'C', which causes case 'C' to execute and assign param to bar. This tainted value is then concatenated into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01964 HTTP header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a proper parameterized query.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01970.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest01970\n\nUser-controlled input from the HTTP header 'BenchmarkTest01970' is directly concatenated into a SQL query. The doSomething() method uses a switch statement where guess.charAt(2) evaluates to 'C', which causes case 'C' to execute and assign param to bar. This tainted value is then concatenated into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01970 HTTP header, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a proper parameterized query.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01971.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from HTTP header 'BenchmarkTest01971' flows through a switch statement (where guess.charAt(2) = 'C', matching case 'C' which assigns param to bar) and is concatenated directly into a SQL query without parameterization. The switch target is 'C' (from \"ABC\".charAt(2)), which executes case 'C': bar = param, making bar tainted.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01971 header, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql, ...) with PreparedStatement.setString() for the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01972.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from HTTP header 'BenchmarkTest01972' is directly assigned to bar in doSomething() and then concatenated into a SQL query without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest01972 header, potentially leading to unauthorized data access, modification, or deletion.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace statement.execute(sql, ...) with PreparedStatement.setString() for the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01974.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection\n\nUser input from HTTP header 'BenchmarkTest01974' flows through a HashMap (stored at keyB-11821 and retrieved) and is concatenated directly into an XPath expression without sanitization. The HashMap stores param at 'keyB-11821' and retrieves it back, making bar tainted.\n\nImpact: An attacker can manipulate the XPath query to access unauthorized data from the XML document by injecting XPath syntax through the header value.\n\nFix: Use parameterized XPath queries or sanitize input by validating against single quotes and other XPath metacharacters before concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02059.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Custom Header in ProcessBuilder\n\nUser-controlled data from the BenchmarkTest02059 header is stored in a HashMap and retrieved back out. The tainted bar value is concatenated into a shell command string passed to ProcessBuilder, enabling command injection attacks.\n\nImpact: An attacker can execute arbitrary operating system commands by crafting a malicious header value, leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to shell commands. If necessary, use strict input validation with a whitelist of allowed characters, or use parameterized APIs that don't invoke a shell.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02067.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled data from the request header flows through doSomething() where the switch statement on 'ABC'.charAt(1) evaluates to 'B', assigning the constant 'bob' to bar. However, this is NOT a vulnerability in this specific case because bar receives the constant 'bob', not user input.\n\nImpact: N/A - bar is assigned a safe constant value 'bob' in this code path.\n\nFix: N/A - This specific instance is safe.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02068.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled data from the request header would flow to the argsEnv parameter of Runtime.exec(). However, the ternary condition `(7*18)+106 > 200` evaluates to `126+106=232 > 200` which is TRUE, so bar is assigned the constant 'This_should_always_happen', not user input. This specific instance is safe.\n\nImpact: N/A - bar receives a safe constant value in this code path.\n\nFix: N/A - This specific instance is safe.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02069.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection\n\nUser-controlled data from the request header flows through doSomething() where the switch statement on 'ABC'.charAt(1) evaluates to 'B', assigning the constant 'bob' to bar. However, this is NOT a vulnerability because bar receives the constant 'bob', not user input.\n\nImpact: N/A - bar is assigned a safe constant value 'bob' in this code path.\n\nFix: N/A - This specific instance is safe.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02070.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled data from the request header flows through doSomething() to the argsEnv parameter of Runtime.exec(). The ternary condition `(7*42)-106 > 200` evaluates to `294-106=188 > 200` which is FALSE, so bar is assigned param (user input). This user input is then passed to Runtime.exec() as an environment variable.\n\nImpact: An attacker can inject malicious environment variables that could be used by the executed command to perform unauthorized actions, potentially leading to command injection or information disclosure.\n\nFix: Validate and sanitize user input before passing it to Runtime.exec(). Use a whitelist approach to allow only safe characters and values. Consider using ProcessBuilder with explicit argument handling instead of Runtime.exec().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02088.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from HTTP header 'BenchmarkTest02088' is concatenated directly into a SQL query. The data flows: request.getHeaders() \u2192 param \u2192 doSomething(param) \u2192 bar \u2192 SQL string concatenation. ThingFactory.createThing().doSomething() is a pass-through that returns its input unchanged, so bar contains the tainted header value. While USERNAME is parameterized, PASSWORD uses string concatenation with user input.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the header value, potentially leading to unauthorized data access, data modification, authentication bypass, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a second parameter placeholder and use statement.setString(2, bar) to bind the value safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02090.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from HTTP header 'BenchmarkTest02090' is concatenated directly into a SQL query. The data flows: request.getHeaders() \u2192 param \u2192 doSomething(param) \u2192 bar \u2192 SQL string concatenation. In doSomething(), guess.charAt(2) returns 'C', which matches case 'C' in the switch statement, causing bar = param to execute. The tainted param value flows into the SQL query via string concatenation.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the header value, potentially leading to unauthorized data access, data modification, authentication bypass, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with PreparedStatement parameter binding instead of using JDBCtemplate.execute() with a concatenated SQL string.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02091.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest02091\n\nUser-controlled data from the 'BenchmarkTest02091' HTTP header is directly concatenated into a SQL query without sanitization. The header value flows through doSomething() unchanged and is concatenated into the SQL WHERE clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the HTTP header value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the dynamic SQL with: PreparedStatement stmt = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02092.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest02092\n\nUser-controlled data from the 'BenchmarkTest02092' HTTP header flows into a SQL query. In doSomething(), the tainted param is added to a list, the first safe element is removed, and then param (now at index 0) is retrieved and concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the HTTP header value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the dynamic SQL with: PreparedStatement stmt = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02094.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest02094\n\nUser-controlled data from the 'BenchmarkTest02094' HTTP header flows into a SQL query. In doSomething(), the condition (500/42)+196 > 200 evaluates to true (207 > 200), so bar is assigned the tainted param value, which is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the HTTP header value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the dynamic SQL with: PreparedStatement stmt = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02096.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest02096\n\nUser-controlled data from the 'BenchmarkTest02096' HTTP header flows into a SQL query. In doSomething(), the param is Base64-encoded then immediately decoded, which is a pass-through operation that returns the original tainted value. This value is then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the HTTP header value, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the dynamic SQL with: PreparedStatement stmt = conn.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02099.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via HTTP Header in BenchmarkTest02099\n\nUser-controlled data from the 'BenchmarkTest02099' HTTP header flows into a SQL INSERT statement. In doSomething(), the param is Base64-encoded then immediately decoded (a pass-through operation), and the tainted value is concatenated into the SQL INSERT query.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the HTTP header value, potentially leading to unauthorized data insertion, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Replace the dynamic SQL with: PreparedStatement stmt = conn.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02100.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection via HTTP Header in BenchmarkTest02100\n\nUser-controlled data from the 'BenchmarkTest02100' HTTP header flows into an XPath expression. In doSomething(), guess.charAt(2) returns 'C', which causes the switch to assign param to bar. This tainted value is then concatenated into the XPath query without sanitization.\n\nImpact: An attacker can manipulate the XPath query by injecting special characters (e.g., single quotes, or operators) to bypass authentication, access unauthorized data, or extract the entire XML document structure.\n\nFix: Use parameterized XPath queries or sanitize input by validating that it contains no XPath metacharacters (especially single quotes). Alternatively, use XPath variable binding: xp.compile(expression).evaluate(xmlDocument, new SimpleVariableResolver(\"emplid\", bar)).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02137.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via ProcessBuilder\n\nUser-controlled input from request parameter 'BenchmarkTest02137' flows through doSomething() where a condition evaluates to true ((500/42)+196 = 11+196 = 207, which IS > 200), assigning param to bar. This tainted value is then concatenated into an OS command 'echo ' + bar and executed via ProcessBuilder. An attacker can inject arbitrary shell commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into shell commands. Use parameterized command execution or validate/sanitize input against a strict whitelist. Consider using safer alternatives that don't invoke a shell.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02146.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection\n\nUser input from request parameter 'BenchmarkTest02146' flows through doSomething() where it is retrieved from a list after removing the first element (making it the param value at index 0), then concatenated directly into an OS command string that is executed via Runtime.exec(). The user input is not sanitized.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the application server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid concatenating user input into command strings. Use ProcessBuilder with separate arguments, or validate/sanitize input against a strict whitelist. Better yet, redesign to avoid executing OS commands based on user input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02147.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection\n\nUser input from request parameter 'BenchmarkTest02147' is passed directly through doSomething() unchanged, then concatenated into an OS command string that is executed via Runtime.exec(). No sanitization is performed.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the application server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid concatenating user input into command strings. Use ProcessBuilder with separate arguments, or validate/sanitize input against a strict whitelist. Better yet, redesign to avoid executing OS commands based on user input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02150.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser input from request parameter 'BenchmarkTest02150' flows through doSomething() where a switch statement on 'ABC'.charAt(2) (which is 'C') assigns param to bar in the case 'C' branch. This tainted value is then included in the args array passed to Runtime.exec(args, argsEnv), allowing command injection.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the application server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Validate and sanitize user input before including it in command arguments. Use a whitelist approach to restrict allowed values, or redesign to avoid executing OS commands based on user input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02151.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Command Arguments\n\nUser-controlled input from request parameter 'BenchmarkTest02151' flows through doSomething() where it's retrieved from a list after removing the first element, making 'bar' equal to the user input (param). This tainted value is then passed directly as an argument to Runtime.exec() in the command array, allowing command injection.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the application server, potentially leading to complete system compromise.\n\nFix: Validate and sanitize user input before using it in OS commands. Use allowlists for acceptable values, or avoid using user input in command execution entirely. Consider using safer alternatives like ProcessBuilder with strict argument validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02152.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Command Arguments\n\nUser-controlled input from request parameter 'BenchmarkTest02152' flows through doSomething() where it's Base64 encoded and decoded (which doesn't sanitize it), making 'bar' still contain the user input. This tainted value is then passed directly as an argument to Runtime.exec() in the command array, allowing command injection.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the application server, potentially leading to complete system compromise.\n\nFix: Validate and sanitize user input before using it in OS commands. Use allowlists for acceptable values, or avoid using user input in command execution entirely. Consider using safer alternatives like ProcessBuilder with strict argument validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02153.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Environment Variables\n\nIn doSomething(), the code assigns a static string 'barbarians_at_the_gate' to g82592, then passes it through ThingFactory.createThing().doSomething() which is a pass-through that returns its input unchanged. However, the entire propagation chain starting from param is irrelevant because g82592 is assigned a constant string literal, not derived from the param chain. The bar variable ultimately contains the safe constant 'barbarians_at_the_gate', not user input. This is NOT a vulnerability.\n\nImpact: None - the code is secure as implemented.\n\nFix: No action needed - the current implementation is secure.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02154.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Command String\n\nUser-controlled input from request parameter 'BenchmarkTest02154' flows through doSomething() where the ternary condition '(7*42) - 106 > 200' evaluates to '294 - 106 = 188 > 200' which is FALSE, so bar is assigned param (user input). This tainted value is then concatenated directly into the command string passed to Runtime.exec(), allowing command injection.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the application server, potentially leading to complete system compromise.\n\nFix: Validate and sanitize user input before using it in OS commands. Use allowlists for acceptable values, or avoid using user input in command execution entirely. Consider using safer alternatives like ProcessBuilder with strict argument validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02155.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest02155' flows through doSomething() where it's retrieved from a list after removing the first element, making 'bar' equal to the user input (param). This tainted value is then passed as an environment variable to Runtime.exec(), allowing command injection through environment variable manipulation.\n\nImpact: An attacker can inject malicious environment variables that could be used by the executed command to perform unauthorized actions, potentially leading to command injection or information disclosure.\n\nFix: Validate and sanitize user input before using it in environment variables. Use allowlists for acceptable values, or avoid using user input in command execution entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02169.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in CallableStatement\n\nUser-controlled data from request parameter 'BenchmarkTest02169' is concatenated directly into a SQL callable statement string without sanitization. The condition in doSomething() evaluates to true ((500/42) + 196 = 207 > 200), causing the user input to be assigned to 'bar' and then concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement or CallableStatement parameter binding. Never concatenate user input directly into SQL queries. Example: Use '?' placeholders and setString() methods to bind parameters safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02170.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in CallableStatement\n\nUser-controlled data from request parameter 'BenchmarkTest02170' is concatenated directly into a SQL callable statement string. The Base64 encode/decode operation in doSomething() returns the original user input unchanged, which is then concatenated into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized queries with PreparedStatement or CallableStatement parameter binding. Never concatenate user input directly into SQL queries. Example: Use '?' placeholders and setString() methods to bind parameters safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02171.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02171' flows through Base64 encode/decode (which is not sanitization) into the SQL query via string concatenation. The doSomething method performs Base64 encoding then decoding, which returns the original user input unchanged. This user-controlled data is concatenated directly into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameter binding: use statement.setString(2, bar) and modify the SQL to use '?' for the PASSWORD field.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02177.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02177' flows through a switch statement. The switch target is 'ABC'.charAt(2) which equals 'C'. Case 'C' assigns param to bar, making bar tainted. This tainted value is then concatenated directly into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with PreparedStatement.setString() for all user input instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02178.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02178' is stored in a HashMap with key 'keyB-38026' and then retrieved using the same key. The retrieved value (param) is concatenated directly into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with PreparedStatement.setString() for all user input instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02179.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02179' flows through ThingFactory.createThing().doSomething(param), which is a pass-through that returns the input unchanged. This tainted value is then concatenated directly into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with PreparedStatement.setString() for all user input instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02181.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02181' is directly concatenated into a SQL query without sanitization. The doSomething method passes the parameter through unchanged, and it's concatenated into the SQL string at line 50.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02182.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02182' is directly concatenated into a SQL query. Although the input goes through Base64 encode/decode, this is not a sanitization technique and the original user input is preserved and concatenated into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02186.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02186' flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is directly concatenated into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02187.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02187' is directly concatenated into a SQL query. The doSomething method uses a deterministic switch statement where guess.charAt(2) = 'C', which matches case 'C' that assigns param to bar, making bar tainted.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02189.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection\n\nUser input from request parameter 'BenchmarkTest02189' is directly concatenated into an XPath expression without sanitization. The doSomething method passes the parameter through unchanged, and it's concatenated into the XPath string.\n\nImpact: An attacker can manipulate the XPath query to access unauthorized data from the XML document, bypass authentication checks, or extract sensitive information.\n\nFix: Use parameterized XPath queries or sanitize input by validating that it contains no single quotes. Example: if (bar.contains(\"'\")) { throw new IllegalArgumentException(\"Invalid input\"); } Alternatively, use XPath variable binding if supported by your XPath library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02196.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection\n\nUser-controlled input from request parameter 'BenchmarkTest02196' flows through doSomething() where it is assigned to bar via a switch statement. The switch target is 'ABC'.charAt(2) which equals 'C', matching case 'C' that assigns param to bar. This tainted value is then concatenated directly into an LDAP filter string without sanitization: \"(&(objectclass=person)(uid=\" + bar + \"))\". An attacker can inject LDAP metacharacters to modify the query logic.\n\nImpact: An attacker can bypass authentication, access unauthorized data, or enumerate LDAP directory information by injecting LDAP filter metacharacters like *, ), (, |, &.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize the input before building the LDAP filter, or use parameterized LDAP queries if supported by the LDAP library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02232.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String Injection\n\nUser-controlled input from request parameter 'BenchmarkTest02232' flows directly into response.getWriter().printf() as the format string. The doSomething() method returns the param unchanged (bar = param), and this tainted value is used as the format string in printf(bar, obj). Combined with X-XSS-Protection disabled, this allows XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session tokens, credentials, or performing actions on behalf of users.\n\nFix: HTML-encode the user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar. Never use user input as a format string - use a fixed format string instead: printf(\"User input: %s\", bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02233.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String Injection\n\nUser-controlled input from request parameter 'BenchmarkTest02233' flows into response.getWriter().printf() as the format string. After list manipulation (add safe, add param, add moresafe, remove index 0), valuesList.get(1) retrieves 'moresafe' which is safe. However, the format string vulnerability pattern remains in the code structure.\n\nImpact: While the current data flow results in a safe constant, the use of printf with a variable format string is a dangerous pattern.\n\nFix: Use a fixed format string: printf(\"Value: %s\", bar) instead of printf(bar, obj).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02234.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String Injection\n\nUser-controlled input from request parameter 'BenchmarkTest02234' is appended with '_SafeStuff' in doSomething() and then used as the format string in response.getWriter().printf(bar, obj). The user input still forms the beginning of the format string, allowing format string injection and XSS. X-XSS-Protection is disabled.\n\nImpact: An attacker can inject malicious JavaScript or format string specifiers that will execute in victims' browsers or cause information disclosure.\n\nFix: HTML-encode the user input and use a fixed format string: printf(\"Value: %s\", ESAPI.encoder().encodeForHTML(bar)).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02243.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in ProcessBuilder\n\nUser-controlled input from request parameter 'BenchmarkTest02243' flows into a shell command executed via ProcessBuilder. The doSomething method stores param in a HashMap under key 'keyB-19941' and retrieves it back into bar. The tainted bar value is concatenated into 'echo ' + bar and executed as a shell command. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or service disruption.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized command execution or validate/sanitize input by whitelisting allowed characters. Consider using ProcessBuilder with separate arguments instead of shell interpretation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02244.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in ProcessBuilder\n\nUser-controlled input from request parameter 'BenchmarkTest02244' flows through ThingFactory.createThing().doSomething(param), which is a pass-through that returns param unchanged. The tainted bar value is concatenated into 'echo ' + bar and executed as a shell command via ProcessBuilder.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or service disruption.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized command execution or validate/sanitize input by whitelisting allowed characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02249.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Runtime.exec()\n\nUser-controlled input from request parameter 'BenchmarkTest02249' flows into a shell command executed via Runtime.exec(). The doSomething method adds param to a list, removes the first element, then retrieves index 0 which is now param. The tainted bar value is concatenated into cmd + bar and executed. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or service disruption.\n\nFix: Avoid concatenating user input into shell commands. Use ProcessBuilder with separate arguments or validate/sanitize input by whitelisting allowed characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02250.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Runtime.exec()\n\nUser-controlled input from request parameter 'BenchmarkTest02250' flows into a shell command executed via Runtime.exec(). The doSomething method stores param in a HashMap under key 'keyB-94176' and retrieves it back into bar. The tainted bar value is concatenated into cmd + bar and executed. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or service disruption.\n\nFix: Avoid concatenating user input into shell commands. Use ProcessBuilder with separate arguments or validate/sanitize input by whitelisting allowed characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02251.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Parameter\n\nUser-controlled input from request parameter 'BenchmarkTest02251' flows through doSomething() method where the condition (500/42) + 196 = 207 > 200 evaluates to true, causing bar to be assigned the tainted param value. This tainted value is then concatenated into the command string and passed to Runtime.exec(), allowing an attacker to inject arbitrary OS commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid passing user input to Runtime.exec(). If command execution is necessary, use a whitelist of allowed values or sanitize input using ESAPI.encoder().encodeForOS(). Better yet, redesign the application to avoid executing OS commands based on user input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02264.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in CallableStatement\n\nUser-controlled data from request parameter 'BenchmarkTest02264' is concatenated directly into a SQL callable statement. The doSomething() method adds param to a list, removes the first element, then retrieves index 0 (which is now param). This tainted value flows into the SQL string via String sql = \"{call \" + bar + \"}\", creating a SQL injection vulnerability.\n\nImpact: An attacker can execute arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized CallableStatement with proper parameter binding. Example: CallableStatement statement = connection.prepareCall(\"{call procedureName(?)}\"); statement.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02269.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in PreparedStatement\n\nUser-controlled data from request parameter 'BenchmarkTest02269' is concatenated directly into a SQL query string. The doSomething() method evaluates the condition (500/42) + 196 > 200, which equals 11 + 196 = 207 > 200 = true, so bar is assigned param (user input). This tainted value is concatenated into the SQL string via \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\", creating a SQL injection vulnerability despite the use of PreparedStatement for the USERNAME parameter.\n\nImpact: An attacker can execute arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries for ALL dynamic values. Example: String sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\"; statement.setString(1, \"foo\"); statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02270.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection in PreparedStatement\n\nUser-controlled data from request parameter 'BenchmarkTest02270' is concatenated directly into a SQL query string. The doSomething() method evaluates guess.charAt(2) where guess=\"ABC\", resulting in 'C'. The switch statement matches case 'C', which assigns bar = param (user input). This tainted value is concatenated into the SQL string via \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\", creating a SQL injection vulnerability.\n\nImpact: An attacker can execute arbitrary SQL commands, potentially reading, modifying, or deleting database data, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries for ALL dynamic values. Example: String sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\"; statement.setString(1, \"foo\"); statement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02272.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02272' flows through doSomething() where the ternary condition (500/42)+196 > 200 evaluates to TRUE, assigning param to bar. This tainted value is then concatenated directly into a SQL query string without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with PreparedStatement.setString() instead of string concatenation. Replace the concatenation with a placeholder and bind the parameter: preparedStatement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02273.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02273' flows through doSomething() where guess.charAt(2) returns 'C', causing the switch statement to execute case 'C' which assigns param to bar. This tainted value is then concatenated directly into a SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with PreparedStatement.setString() instead of string concatenation. Replace the concatenation with a placeholder and bind the parameter: preparedStatement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02275.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02275' flows through doSomething() where the ternary condition (7*42)-106 > 200 evaluates to FALSE (188 > 200 is false), assigning param to bar. This tainted value is then concatenated directly into a SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with PreparedStatement.setString() instead of string concatenation. Replace the concatenation with a placeholder and bind the parameter: preparedStatement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02277.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02277' flows through doSomething() where it is Base64 encoded then decoded, returning the original param value unchanged. This tainted value (bar) is then concatenated directly into a SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries with PreparedStatement.setString() instead of string concatenation. Replace the concatenation with a placeholder and bind the parameter: preparedStatement.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02281.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via unsanitized user input in query string concatenation\n\nUser input from request parameter 'BenchmarkTest02281' flows directly into a SQL query via string concatenation. The doSomething() method returns the parameter unchanged, and it is concatenated into the SQL WHERE clause without any sanitization or parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02284.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via unsanitized user input in query string concatenation\n\nUser input from request parameter 'BenchmarkTest02284' flows into a SQL query via string concatenation. The ternary condition (7*42)-106 > 200 evaluates to 188 > 200 which is FALSE, so bar is assigned param (user input), which is then concatenated into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02286.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via unsanitized user input in query string concatenation\n\nUser input from request parameter 'BenchmarkTest02286' flows through Base64 encode/decode operations (which are pass-through transformations that do not sanitize SQL injection) and is then concatenated into an INSERT SQL statement without parameterization.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify the query structure, or execute additional SQL statements, potentially compromising database integrity.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02287.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via unsanitized user input in query string concatenation\n\nUser input from request parameter 'BenchmarkTest02287' flows into a SQL query via string concatenation. The ternary condition (7*42)-106 > 200 evaluates to 188 > 200 which is FALSE, so bar is assigned param (user input), which is then concatenated into the INSERT SQL statement without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify the query structure, or execute additional SQL statements, potentially compromising database integrity.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02288.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via unsanitized user input in query string concatenation\n\nUser input from request parameter 'BenchmarkTest02288' flows into a SQL query via string concatenation. The if condition (500/42)+196 > 200 evaluates to 207 > 200 which is TRUE, so bar is assigned param (user input), which is then concatenated into the INSERT SQL statement without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify the query structure, or execute additional SQL statements, potentially compromising database integrity.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02299.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection\n\nUser-controlled input from request parameter names flows into an LDAP search filter without proper sanitization. The code constructs the LDAP filter using string concatenation: 'String filter = \"(&(objectclass=person)(uid=\" + bar + \"))\"' where 'bar' originates from request.getParameterNames(). An attacker can inject malicious LDAP filter syntax to bypass authentication, access unauthorized data, or enumerate directory information.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication checks, retrieve sensitive directory information, or access unauthorized user records by injecting LDAP metacharacters such as *, ), (, |, &, etc.\n\nFix: Use ESAPI's encodeForLDAP() method to sanitize the input before constructing the LDAP filter: 'String filter = \"(&(objectclass=person)(uid=\" + ESAPI.encoder().encodeForLDAP(bar) + \"))\"'. Alternatively, use parameterized LDAP queries if supported by your LDAP library, or implement strict input validation to allow only alphanumeric characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02314.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via format() with User Input\n\nUser-controlled input (param from request parameter name) flows through doSomething() where it is assigned to bar via a ternary condition. The condition (7*42) - 106 > 200 evaluates to 188 > 200, which is FALSE, so bar = param (tainted). This tainted value is then used as the format string in response.getWriter().format(bar, obj). The response header 'X-XSS-Protection' is set to '0', disabling browser XSS protection.\n\nImpact: An attacker can inject malicious JavaScript that executes in victims' browsers, potentially stealing session tokens, credentials, or performing actions on behalf of users. Using user input as a format string also creates a format string vulnerability.\n\nFix: Never use user input as a format string. Encode user input before including in HTML responses using ESAPI.encoder().encodeForHTML(). Use a fixed format string and pass user data as arguments. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02315.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via format() with User Input\n\nUser-controlled input (param from request parameter name) flows directly through doSomething() to bar without any sanitization, then is included in the HTTP response via response.getWriter().format(). The response header 'X-XSS-Protection' is set to '0', disabling browser XSS protection.\n\nImpact: An attacker can inject malicious JavaScript that executes in victims' browsers, potentially stealing session tokens, credentials, or performing actions on behalf of users.\n\nFix: Encode user input before including in HTML responses using ESAPI.encoder().encodeForHTML() or similar. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02316.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via format() with User Input\n\nUser-controlled input (param from request parameter name) flows through doSomething() where thing.doSomething(param) is a pass-through that returns param unchanged. This tainted value is then used as the format string in response.getWriter().format(bar, obj). The response header 'X-XSS-Protection' is set to '0', disabling browser XSS protection.\n\nImpact: An attacker can inject malicious JavaScript that executes in victims' browsers, potentially stealing session tokens, credentials, or performing actions on behalf of users. Using user input as a format string also creates a format string vulnerability.\n\nFix: Never use user input as a format string. Encode user input before including in HTML responses using ESAPI.encoder().encodeForHTML(). Use a fixed format string and pass user data as arguments. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02317.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via format() with User Input\n\nUser-controlled input (param from request parameter name) flows through doSomething() where the condition (500/42) + 196 > 200 evaluates to 11 + 196 = 207 > 200, which is TRUE, so bar = param (tainted). This tainted value is then used as the format string in response.getWriter().format(bar, obj). The response header 'X-XSS-Protection' is set to '0', disabling browser XSS protection.\n\nImpact: An attacker can inject malicious JavaScript that executes in victims' browsers, potentially stealing session tokens, credentials, or performing actions on behalf of users. Using user input as a format string also creates a format string vulnerability.\n\nFix: Never use user input as a format string. Encode user input before including in HTML responses using ESAPI.encoder().encodeForHTML(). Use a fixed format string and pass user data as arguments. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02333.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Parameter\n\nUser-controlled parameter name flows through `ThingFactory.createThing().doSomething(param)` (a pass-through method) and is concatenated directly into an OS command string `\"echo \" + bar`. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized command execution or validate/sanitize input using `ESAPI.encoder().encodeForOS()`. Consider using safer alternatives that don't invoke a shell.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02334.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Parameter in Switch Statement\n\nUser-controlled parameter name flows into a switch statement where `guess.charAt(2)` evaluates to 'C', causing case 'C' to execute and assign `bar = param`. This tainted value is then concatenated into an OS command string `\"echo \" + bar`, allowing command injection.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized command execution or validate/sanitize input using `ESAPI.encoder().encodeForOS()`. Consider using safer alternatives that don't invoke a shell.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02342.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via String Concatenation\n\nUser-controlled input from a request parameter name flows into the doSomething() method where it is assigned to 'bar', then directly concatenated into an OS command string 'cmd + bar' which is passed to Runtime.exec(). An attacker can control the parameter name to inject arbitrary OS commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into command strings. Use ProcessBuilder with separate arguments, or validate and sanitize input using a whitelist approach. Consider using ESAPI.encoder().encodeForOS() if dynamic command construction is absolutely necessary.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02343.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via String Concatenation\n\nUser-controlled input from a request parameter name flows through ThingFactory.createThing().doSomething() (a pass-through method) into 'bar', then is directly concatenated into an OS command string 'cmd + bar' which is passed to Runtime.exec(). The ThingFactory method does not sanitize the input.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input into command strings. Use ProcessBuilder with separate arguments, or validate and sanitize input using a whitelist approach. Consider using ESAPI.encoder().encodeForOS() if dynamic command construction is absolutely necessary.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02344.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from a request parameter name flows through a ternary expression. The condition '(7*42) - 106 > 200' evaluates to '188 > 200' which is false, causing 'bar = param' to execute. This tainted value is then placed into the environment variables array 'argsEnv' which is passed to Runtime.exec(). An attacker can inject malicious environment variables that may affect command execution.\n\nImpact: An attacker can manipulate the execution environment of the spawned process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in environment variables. Use a whitelist approach to allow only known-safe values. Consider whether environment variables need to be user-controllable at all.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02354.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter name flows into the SQL query via string concatenation. The doSomething method's ternary condition evaluates to false ((7*42)-106=188, which is not >200), causing param to be assigned to bar. This tainted value is then concatenated directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a parameter placeholder: \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and bind both values using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02355.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter name flows into the SQL query via string concatenation. The doSomething method adds param to a list, removes the first element, then retrieves index 0 which now contains param. This tainted value is concatenated directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a parameter placeholder: \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and bind both values using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02356.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter name flows into the SQL query via string concatenation. The doSomething method's condition evaluates to true ((500/42)+196=207>200), causing param to be assigned to bar. This tainted value is concatenated directly into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a parameter placeholder and bind the value using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02357.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter name flows into the SQL query via string concatenation. The doSomething method adds param to a list, removes the first element, then retrieves index 0 which now contains param. This tainted value is concatenated directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a parameter placeholder and bind the value using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02358.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter name flows into the SQL query via string concatenation. The doSomething method uses a switch statement where guess.charAt(2) equals 'C', which falls through to assign param to bar. This tainted value is concatenated directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a parameter placeholder and bind the value using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02359.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter name flows into the SQL query via string concatenation. The doSomething method's condition evaluates to true ((500/42)+196=207>200), causing param to be assigned to bar. This tainted value is concatenated directly into the SQL query string.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a parameter placeholder and bind the value using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02360.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter name flows into the SQL query via string concatenation. The doSomething method uses a switch statement where guess.charAt(2) equals 'C', which falls through to assign param to bar. This tainted value is concatenated directly into the SQL query.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use parameterized queries (PreparedStatement with setString) for all user input. Replace the string concatenation with a parameter placeholder and bind the value using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02362.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via unsanitized user input in query\n\nUser-controlled parameter name flows into a SQL query via string concatenation. The doSomething method evaluates (7*42) - 106 = 188, which is NOT > 200, so the ternary condition returns param (user input). This tainted value is concatenated directly into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement with setString) instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME='foo' AND PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02364.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via unsanitized user input in query\n\nUser-controlled parameter name flows into a SQL query via string concatenation. The doSomething method evaluates (7*42) - 106 = 188, which is NOT > 200, so the ternary condition returns param (user input). This tainted value is concatenated directly into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement with setString) instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME='foo' AND PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02369.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via unsanitized user input in INSERT query\n\nUser-controlled parameter name flows into a SQL INSERT query via string concatenation. The doSomething method evaluates (7*42) - 106 = 188, which is NOT > 200, so the ternary condition returns param (user input). This tainted value is concatenated directly into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the parameter name, potentially leading to unauthorized data insertion, data modification, or complete database compromise.\n\nFix: Use parameterized queries (PreparedStatement with setString) instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02376.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection\n\nUser-controlled input flows directly into an LDAP filter string without sanitization. The 'bar' variable is assigned a constant value 'This_should_always_happen' due to the ternary condition (7*18)+106 = 232 > 200 being always true, making this specific instance safe. However, the pattern itself is vulnerable if the condition logic changes.\n\nImpact: If the condition were to change to allow user input, an attacker could inject LDAP filter metacharacters to bypass authentication, access unauthorized data, or modify LDAP queries.\n\nFix: Use parameterized LDAP queries or properly escape user input using ESAPI.encoder().encodeForLDAP() before concatenating into LDAP filter strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02411.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection in BenchmarkTest02411\n\nUser-controlled input flows into a command execution sink. The parameter from SeparateClassRequest flows through doSomething() where it's added to a list, the first element is removed, and then get(0) retrieves the user parameter. This tainted value is concatenated into the command string 'echo ' + bar and executed via ProcessBuilder.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the BenchmarkTest02411 parameter, leading to complete system compromise.\n\nFix: Avoid passing user input to OS commands. If necessary, use strict input validation with an allowlist of permitted characters, or use safer alternatives that don't invoke a shell.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02412.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection in BenchmarkTest02412\n\nUser-controlled input flows into a command execution sink. The parameter from SeparateClassRequest is Base64 encoded then decoded (which returns the original value unchanged) in doSomething(), then concatenated into the command string 'echo ' + bar and executed via ProcessBuilder.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the BenchmarkTest02412 parameter, leading to complete system compromise.\n\nFix: Avoid passing user input to OS commands. If necessary, use strict input validation with an allowlist of permitted characters, or use safer alternatives that don't invoke a shell.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02414.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection in BenchmarkTest02414\n\nUser-controlled input flows into a command execution sink. In doSomething(), guess.charAt(2) evaluates to 'C' (the third character of 'ABC'), which matches case 'C' in the switch statement, assigning param to bar. This tainted value is then concatenated into the command string 'echo ' + bar and executed via ProcessBuilder.\n\nImpact: An attacker can inject arbitrary OS commands by manipulating the BenchmarkTest02414 parameter, leading to complete system compromise.\n\nFix: Avoid passing user input to OS commands. If necessary, use strict input validation with an allowlist of permitted characters, or use safer alternatives that don't invoke a shell.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02429.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input\n\nUser-controlled input from request parameter 'BenchmarkTest02429' flows through doSomething() where ThingFactory.createThing().doSomething(param) is a pass-through that returns the param unchanged. This tainted value is then concatenated directly into an OS command string and executed via Runtime.exec(). The doSomething() method returns the user input unchanged, making bar tainted.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the web application, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into OS commands. Use parameterized command execution, validate and sanitize all input against a strict whitelist, or avoid executing OS commands with user input entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02430.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input\n\nUser-controlled input from request parameter 'BenchmarkTest02430' flows through doSomething() where it is Base64 encoded and decoded (which does not sanitize command injection), then concatenated directly into an OS command string and executed via Runtime.exec(). The bar variable contains the user input after Base64 round-trip, which preserves the original value.\n\nImpact: An attacker can inject arbitrary OS commands that will be executed with the privileges of the web application, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Never concatenate user input directly into OS commands. Use parameterized command execution, validate and sanitize all input against a strict whitelist, or avoid executing OS commands with user input entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02449.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Callable Statement\n\nUser-controlled data from request parameter 'BenchmarkTest02449' flows through doSomething() and is concatenated directly into a SQL callable statement. The switch statement evaluates guess.charAt(2) which equals 'C', matching case 'C' and assigning param to bar. The SQL string '{call ' + bar + '}' is then executed without parameterization, allowing SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, execute administrative operations, or in some cases execute operating system commands on the database server.\n\nFix: Use parameterized callable statements with placeholders instead of string concatenation. For example: connection.prepareCall(\"{call procedure_name(?)}\") and then use statement.setString(1, bar) to bind the parameter safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02451.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from SeparateClassRequest.getTheParameter() flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is concatenated directly into a SQL query without parameterization. The query string is built using string concatenation: \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\"\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace the string concatenation with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME='foo' AND PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02452.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nAlthough the doSomething() method performs complex data flow operations, it ultimately assigns the static string \"barbarians_at_the_gate\" to g91263 and passes it to thing.doSomething(g91263). Since ThingFactory.createThing().doSomething() is a pass-through that returns its input unchanged, bar receives the safe constant \"barbarians_at_the_gate\". This makes the SQL query safe. This is NOT vulnerable.\n\nImpact: N/A - This file is actually safe.\n\nFix: N/A",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02453.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from SeparateClassRequest.getTheParameter() is Base64 encoded/decoded (which does not sanitize SQL injection) and concatenated directly into a SQL query without parameterization. The query string is built using: \"SELECT TOP 1 userid from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\"\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace the string concatenation with: PreparedStatement stmt = connection.prepareStatement(\"SELECT TOP 1 userid FROM USERS WHERE USERNAME='foo' AND PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02454.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from SeparateClassRequest.getTheParameter() flows directly through doSomething() unchanged and is concatenated into a SQL query without parameterization. The query string is built using: \"SELECT * from USERS where USERNAME='foo' and PASSWORD='\" + bar + \"'\"\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace the string concatenation with: PreparedStatement stmt = connection.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME='foo' AND PASSWORD=?\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02455.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from SeparateClassRequest.getTheParameter() flows through a ternary condition. The condition (7*42) - 106 > 200 evaluates to 188 > 200 which is FALSE, so bar = param (tainted). This tainted value is concatenated into a SQL INSERT statement: \"INSERT INTO users (username, password) VALUES ('foo','\" + bar + \"')\"\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify the query structure, or execute additional SQL statements.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace the string concatenation with: PreparedStatement stmt = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); stmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02456.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nThe doSomething() method evaluates the condition (7*42) - 86 > 200, which equals 208 > 200 = TRUE. Therefore, bar is assigned the constant \"This_should_always_happen\" (not param). Since bar contains a safe constant, the SQL query is safe. This is NOT vulnerable.\n\nImpact: N/A - This file is actually safe.\n\nFix: N/A",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02457.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection\n\nUser input from SeparateClassRequest.getTheParameter() flows through list manipulation. After valuesList.add(\"safe\"), valuesList.add(param), valuesList.add(\"moresafe\"), then valuesList.remove(0), the list becomes [param, \"moresafe\"]. valuesList.get(1) retrieves \"moresafe\" (index 1 after removal), making bar safe. However, re-analyzing: the list starts as [\"safe\", param, \"moresafe\"], after remove(0) it becomes [param, \"moresafe\"], so get(1) returns \"moresafe\" which is safe. Actually, this is NOT vulnerable.\n\nImpact: N/A - This file is actually safe after proper data flow analysis.\n\nFix: N/A",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02496.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User-Controlled Command Argument\n\nUser input from request parameter 'BenchmarkTest02496' flows through a conditional that always evaluates to true ((500/42) + 196 = 207 > 200), assigning the tainted param to bar. This user-controlled value is then concatenated into a shell command string 'echo ' + bar and executed via ProcessBuilder. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data exfiltration, or denial of service.\n\nFix: Never concatenate user input into shell commands. Use parameterized command execution or validate/sanitize input using ESAPI.encoder().encodeForOS(). Consider whether the command execution is necessary at all.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02511.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest02511' flows into the environment variables parameter of Runtime.exec(). The doSomething() method evaluates (500/42)+196 = 207 > 200 (true), so bar is assigned the user input param. This tainted value is then passed as an environment variable to the exec() call, allowing an attacker to inject malicious environment variables that could affect command execution.\n\nImpact: An attacker can inject arbitrary environment variables into the spawned process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in Runtime.exec() calls. Use a whitelist approach to allow only known-safe values. Consider using ProcessBuilder with explicit environment variable handling, and avoid passing user input directly to environment variables.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02512.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest02512' flows into the environment variables parameter of Runtime.exec(). The doSomething() method adds param to a list, removes the first element, then retrieves index 0 which contains the user input. This tainted value in argsEnv allows environment variable injection.\n\nImpact: An attacker can inject arbitrary environment variables into the spawned process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in Runtime.exec() calls. Use a whitelist approach to allow only known-safe values. Consider using ProcessBuilder with explicit environment variable handling, and avoid passing user input directly to environment variables.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02514.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest02514' flows into the environment variables parameter of Runtime.exec(). The doSomething() method performs Base64 encoding followed by decoding, which is effectively a pass-through operation that returns the original user input unchanged. This tainted value is then passed as an environment variable.\n\nImpact: An attacker can inject arbitrary environment variables into the spawned process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in Runtime.exec() calls. Use a whitelist approach to allow only known-safe values. Consider using ProcessBuilder with explicit environment variable handling, and avoid passing user input directly to environment variables.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02515.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest02515' flows into the environment variables parameter of Runtime.exec(). The doSomething() method calls ThingFactory.createThing().doSomething(param), which is a pass-through that returns the input unchanged. This tainted value is then passed as an environment variable.\n\nImpact: An attacker can inject arbitrary environment variables into the spawned process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in Runtime.exec() calls. Use a whitelist approach to allow only known-safe values. Consider using ProcessBuilder with explicit environment variable handling, and avoid passing user input directly to environment variables.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02516.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest02516' flows into the environment variables parameter of Runtime.exec(). The doSomething() method stores param in a HashMap under key 'keyB-74796' and then retrieves it using the same key, resulting in the tainted user input being assigned to bar and passed as an environment variable.\n\nImpact: An attacker can inject arbitrary environment variables into the spawned process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in Runtime.exec() calls. Use a whitelist approach to allow only known-safe values. Consider using ProcessBuilder with explicit environment variable handling, and avoid passing user input directly to environment variables.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02517.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from request parameter 'BenchmarkTest02517' flows into the environment variables parameter of Runtime.exec(). The doSomething() method calls ThingFactory.createThing().doSomething(param), which is a pass-through that returns the input unchanged. This tainted value is then passed as an environment variable.\n\nImpact: An attacker can inject arbitrary environment variables into the spawned process, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Validate and sanitize all user input before using it in Runtime.exec() calls. Use a whitelist approach to allow only known-safe values. Consider using ProcessBuilder with explicit environment variable handling, and avoid passing user input directly to environment variables.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02528.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input from request parameter 'BenchmarkTest02528' is concatenated directly into a SQL callable statement string. The doSomething() method adds param to a list, removes the first element, then retrieves param at index 0, which is still user-controlled. This tainted data flows into the SQL query construction: String sql = \"{call \" + bar + \"}\". Even though prepareCall() is used, the SQL string itself is built with concatenation, allowing SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized queries with proper parameter binding. For CallableStatement, use registerOutParameter() and setString() methods instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02530.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser input from request parameter 'BenchmarkTest02530' is concatenated directly into a SQL callable statement string. The doSomething() method evaluates the condition (500/42)+196 > 200, which is (11+196=207 > 200) = true, so bar = param (user input). This tainted data flows into the SQL query: String sql = \"{call \" + bar + \"}\". String concatenation in SQL queries allows SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized queries with proper parameter binding. For CallableStatement, use registerOutParameter() and setString() methods instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02531.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02531' is concatenated directly into a SQL query. The ternary condition (7*42)-106 > 200 evaluates to 188 > 200 which is false, so bar receives the user-controlled param value. This tainted value is then concatenated into the SQL string, allowing SQL injection attacks.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database contents, bypass authentication, or execute administrative operations on the database.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameter binding: use setString(2, bar) and modify the SQL to use '?' for the PASSWORD field as well.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02532.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02532' is Base64 encoded then decoded (which returns the original value unchanged), then concatenated directly into a SQL query. The Base64 encode/decode operation does not sanitize the input for SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database contents, bypass authentication, or execute administrative operations on the database.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameter binding: use setString(2, bar) and modify the SQL to use '?' for the PASSWORD field as well.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02533.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02533' is stored in a list, the first element is removed, then the user input (now at index 0) is retrieved and concatenated directly into a SQL query. After remove(0) on ['safe', param, 'moresafe'], the list becomes [param, 'moresafe'], so get(0) returns the tainted param value.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database contents, bypass authentication, or execute administrative operations on the database.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameter binding: use setString(2, bar) and modify the SQL to use '?' for the PASSWORD field as well.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02534.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02534' is directly assigned to bar without any sanitization, then concatenated into a SQL query. This allows direct SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database contents, bypass authentication, or execute administrative operations on the database.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameter binding: use setString(2, bar) and modify the SQL to use '?' for the PASSWORD field as well.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02535.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02535' is Base64 encoded then decoded (which returns the original value unchanged), then concatenated directly into a SQL query. The Base64 encode/decode operation does not sanitize the input for SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database contents, bypass authentication, or execute administrative operations on the database.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameter binding: use setString(2, bar) and modify the SQL to use '?' for the PASSWORD field as well.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02537.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02537' flows into a SQL query via string concatenation. The condition (500/42)+196 > 200 evaluates to 11+196=207 > 200 which is true, so bar is assigned the user-controlled param value. This tainted value is then concatenated into the SQL string.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database contents, bypass authentication, or execute administrative operations on the database.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameter binding using PreparedStatement.setString() for the PASSWORD field.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02542.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02542' flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is concatenated directly into a SQL query string without parameterization. The doSomething() method is a pass-through wrapper that returns the param unchanged, making bar tainted.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation: PreparedStatement pstmt = connection.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME='foo' AND PASSWORD=?\"); pstmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02543.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02543' is concatenated directly into a SQL query. The doSomething() method evaluates the condition (500/42) + 196 = 11 + 196 = 207 > 200, which is true, so bar = param (tainted). The tainted value is then concatenated into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation: PreparedStatement pstmt = connection.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME='foo' AND PASSWORD=?\"); pstmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02545.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser input from request parameter 'BenchmarkTest02545' is concatenated directly into a SQL INSERT statement. The doSomething() method evaluates the condition (7*42) - 106 = 294 - 106 = 188 > 200, which is false, so bar = param (tainted). The tainted value is then concatenated into the SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially inserting malicious data, modifying query logic, or executing additional SQL statements.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation: PreparedStatement pstmt = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); pstmt.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02571.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection in BenchmarkTest02571\n\nUser-controlled input from query string parameter is concatenated directly into an LDAP filter without proper sanitization. The doSomething() method performs a switch on 'ABC'.charAt(1) which equals 'B', so case 'B' executes and assigns bar = \"bob\" (a constant). However, the LDAP filter construction uses string concatenation: 'String filter = \"(&(objectclass=person))(|(uid=\" + bar + \")(street={0}))\";'. While bar is safe in this specific case, the pattern is vulnerable.\n\nImpact: An attacker could inject malicious LDAP filter syntax to bypass authentication, access unauthorized data, or modify LDAP queries to return unintended results.\n\nFix: Use parameterized LDAP queries or properly escape user input using ESAPI.encoder().encodeForLDAP() before including it in LDAP filters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02572.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection in BenchmarkTest02572\n\nUser-controlled input from query string parameter flows into an LDAP filter via string concatenation. The doSomething() method creates a list [\"safe\", param, \"moresafe\"], removes index 0, resulting in [param, \"moresafe\"]. Then bar = valuesList.get(1) retrieves \"moresafe\" (a safe constant). However, the LDAP filter uses string concatenation which is a dangerous pattern.\n\nImpact: An attacker could inject malicious LDAP filter syntax to bypass authentication, access unauthorized data, or modify LDAP queries.\n\nFix: Use parameterized LDAP queries or properly escape user input using ESAPI.encoder().encodeForLDAP() before including it in LDAP filters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02610.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Runtime.exec()\n\nUser-controlled input from the query string flows through doSomething() where it's retrieved from a list at index 1 (which contains 'moresafe', a safe constant). However, analyzing the data flow: valuesList contains ['safe', param, 'moresafe'], then remove(0) makes it [param, 'moresafe'], so get(1) returns 'moresafe' (safe). The bar variable is actually safe in this case.\n\nImpact: None - the current implementation is secure as the command receives a safe constant value.\n\nFix: No action needed for current implementation, but the code pattern is fragile and could become vulnerable if the list operations change.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02611.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Command Arguments\n\nUser-controlled input from the query string parameter flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) into the 'bar' variable, which is then directly concatenated into command arguments passed to Runtime.exec(). On Windows, 'bar' is passed as a separate argument; on Unix/Linux, it's concatenated with the command string. An attacker can inject arbitrary OS commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, leading to complete system compromise, data theft, or denial of service.\n\nFix: Validate and sanitize all user input before using it in OS commands. Use allowlists for acceptable input values. Consider using safer alternatives to Runtime.exec() or avoid constructing commands from user input entirely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02612.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Environment Variables\n\nUser-controlled input from the query string parameter flows through ThingFactory.createThing().doSomething() (a pass-through) into the 'bar' variable, which is then placed in the environment variables array (argsEnv) passed to Runtime.exec(). While environment variables are less directly exploitable than command arguments, an attacker can still manipulate the execution environment to potentially execute malicious code or alter program behavior.\n\nImpact: An attacker can manipulate environment variables to alter command execution behavior, potentially leading to command injection, privilege escalation, or information disclosure depending on how the executed command uses environment variables.\n\nFix: Do not place user-controlled input into environment variables for command execution. If environment variables must be set, use a strict allowlist and validate all values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02613.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via User Input in Environment Variables\n\nUser-controlled input from the query string parameter flows into the 'bar' variable through a switch statement. The switch evaluates 'ABC'.charAt(2) which equals 'C', matching case 'C' which assigns 'bar = param'. This tainted value is then placed in the environment variables array passed to Runtime.exec(). An attacker can manipulate environment variables to alter command execution.\n\nImpact: An attacker can manipulate environment variables to alter command execution behavior, potentially leading to command injection, privilege escalation, or information disclosure.\n\nFix: Do not place user-controlled input into environment variables for command execution. Use a strict allowlist and validate all values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02625.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled data from the query string parameter flows into a SQL callable statement through string concatenation. The doSomething method stores param in a HashMap and retrieves it (map82391.put(\"keyB-82391\", param) followed by bar = (String) map82391.get(\"keyB-82391\")), resulting in bar containing the tainted input. This is then concatenated into the SQL string: String sql = \"{call \" + bar + \"}\". Although prepareCall is used, the SQL string itself is constructed via concatenation, allowing SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized queries or stored procedures with bound parameters. Never concatenate user input directly into SQL statements. If dynamic procedure names are required, validate against a strict whitelist of allowed procedure names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02627.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled data from the query string parameter flows into a SQL callable statement through string concatenation. The doSomething method performs Base64 encoding and decoding on the param, but this does not sanitize SQL injection - it merely transforms the input while preserving its content. The result is concatenated into the SQL string: String sql = \"{call \" + bar + \"}\". Base64 encoding/decoding is not a security control for SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands (potentially Base64-encoded in the request), potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized queries or stored procedures with bound parameters. Never concatenate user input directly into SQL statements. Base64 encoding is not a sanitization technique for SQL injection. If dynamic procedure names are required, validate against a strict whitelist of allowed procedure names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02628.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled data from the query string parameter flows into a SQL callable statement through string concatenation. The doSomething method stores param in a HashMap and retrieves it (map23653.put(\"keyB-23653\", param) followed by bar = (String) map23653.get(\"keyB-23653\")), resulting in bar containing the tainted input. This is then concatenated into the SQL string: String sql = \"{call \" + bar + \"}\".\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized queries or stored procedures with bound parameters. Never concatenate user input directly into SQL statements. If dynamic procedure names are required, validate against a strict whitelist of allowed procedure names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02630.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in CallableStatement\n\nUser-controlled data from the query string parameter flows directly into a SQL callable statement through string concatenation. The doSomething method returns param unchanged (bar = param), and this is concatenated into the SQL string: String sql = \"{call \" + bar + \"}\". This allows direct SQL injection.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially leading to unauthorized data access, data modification, data deletion, or complete database compromise.\n\nFix: Use parameterized queries or stored procedures with bound parameters. Never concatenate user input directly into SQL statements. If dynamic procedure names are required, validate against a strict whitelist of allowed procedure names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02632.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Password Field\n\nUser input from the query string is directly concatenated into a SQL query without proper sanitization. The doSomething() method performs a switch statement on guess.charAt(2) which evaluates to 'C', causing the case 'C' branch to execute and assign the user-controlled param to bar. This tainted value is then concatenated into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest02632 query parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameterized binding: change the SQL to use '?' for the PASSWORD field and use statement.setString(2, bar) to bind the value safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02635.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Password Field\n\nUser input from the query string is directly concatenated into a SQL query without proper sanitization. The doSomething() method performs a switch statement on guess.charAt(2) which evaluates to 'C', causing the case 'C' branch to execute and assign the user-controlled param to bar. This tainted value is then concatenated into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest02635 query parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameterized binding: change the SQL to use '?' for the PASSWORD field and use statement.setString(2, bar) to bind the value safely.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02638.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation in Password Field\n\nUser input from the query string is directly concatenated into a SQL query without proper sanitization. The doSomething() method directly assigns param to bar without any validation or sanitization. This tainted value is then concatenated into the SQL query's PASSWORD clause.\n\nImpact: An attacker can inject arbitrary SQL commands by manipulating the BenchmarkTest02638 query parameter, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace the string concatenation with a parameterized PreparedStatement that binds the PASSWORD value safely using setString().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02641.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Query String Parameter\n\nUser-controlled input from the query string is directly concatenated into a SQL query without sanitization. The parameter is extracted from request.getQueryString(), passed through doSomething() unchanged, and concatenated into the SQL statement.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME=? AND PASSWORD=?\"); ps.setString(1, \"foo\"); ps.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02642.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Query String Parameter\n\nUser-controlled input from the query string flows through ThingFactory.createThing().doSomething() (a pass-through method) and is directly concatenated into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME=? AND PASSWORD=?\"); ps.setString(1, \"foo\"); ps.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02643.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Query String Parameter\n\nUser-controlled input from the query string is directly concatenated into a SQL query. The doSomething() method uses a switch statement where guess.charAt(2) evaluates to 'C', causing case 'C' to execute and assign the tainted param to bar.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME=? AND PASSWORD=?\"); ps.setString(1, \"foo\"); ps.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02644.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Query String Parameter\n\nUser-controlled input from the query string is directly concatenated into a SQL query without sanitization. The parameter is extracted from request.getQueryString(), passed through doSomething() unchanged, and concatenated into the SQL statement.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME=? AND PASSWORD=?\"); ps.setString(1, \"foo\"); ps.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02645.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Query String Parameter\n\nUser-controlled input from the query string is directly concatenated into a SQL query. The doSomething() method evaluates (500/42)+196=207>200 which is true, causing bar to be assigned the tainted param value.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME=? AND PASSWORD=?\"); ps.setString(1, \"foo\"); ps.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02646.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Query String Parameter\n\nUser-controlled input from the query string flows through ThingFactory.createThing().doSomething() (a pass-through method) and is directly concatenated into a SQL query without sanitization.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME=? AND PASSWORD=?\"); ps.setString(1, \"foo\"); ps.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02647.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Query String Parameter\n\nUser-controlled input from the query string is directly concatenated into a SQL query. The doSomething() method performs Base64 encoding then decoding, which does not sanitize the input and returns the original tainted value.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME=? AND PASSWORD=?\"); ps.setString(1, \"foo\"); ps.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02649.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Query String Parameter\n\nUser-controlled input from the query string is directly concatenated into a SQL query without sanitization. The parameter is extracted from request.getQueryString(), passed through doSomething() unchanged, and concatenated into the SQL statement.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME=? AND PASSWORD=?\"); ps.setString(1, \"foo\"); ps.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02650.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via Query String Parameter\n\nUser-controlled input from the query string is directly concatenated into a SQL query. The doSomething() method uses a switch statement where guess.charAt(2) evaluates to 'C', causing case 'C' to execute and assign the tainted param to bar.\n\nImpact: An attacker can inject arbitrary SQL commands to bypass authentication, extract sensitive data, modify database contents, or execute administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) with bound parameters instead of string concatenation. Example: PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM USERS WHERE USERNAME=? AND PASSWORD=?\"); ps.setString(1, \"foo\"); ps.setString(2, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02651.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from query parameter 'BenchmarkTest02651' is concatenated directly into a SQL query without sanitization. The doSomething method adds user input to a list, removes the first element, then retrieves index 0 which contains the user input (param). This tainted value flows into the SQL query via string concatenation.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02653.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from query parameter 'BenchmarkTest02653' is concatenated directly into a SQL query. The doSomething method evaluates (500/42) + 196 = 11 + 196 = 207, which is > 200, so bar is assigned param (user input). This tainted value flows into the SQL query via string concatenation.\n\nImpact: An attacker can inject arbitrary SQL commands to read, modify, or delete database data, bypass authentication, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"SELECT * from USERS where USERNAME='foo' and PASSWORD=?\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02654.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from query parameter 'BenchmarkTest02654' is concatenated directly into a SQL INSERT statement without sanitization. The doSomething method adds user input to a list, removes the first element, then retrieves index 0 which contains the user input (param). This tainted value flows into the SQL query via string concatenation.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify database structure, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02655.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from query parameter 'BenchmarkTest02655' is concatenated directly into a SQL INSERT statement without sanitization. The doSomething method directly assigns param to bar without any transformation. This tainted value flows into the SQL query via string concatenation.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify database structure, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02656.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled input from query parameter 'BenchmarkTest02656' is concatenated directly into a SQL INSERT statement. The doSomething method evaluates (7*42) - 106 = 294 - 106 = 188, which is NOT > 200, so bar is assigned param (user input) from the false branch of the ternary. This tainted value flows into the SQL query via string concatenation.\n\nImpact: An attacker can inject arbitrary SQL commands to insert malicious data, modify database structure, or execute administrative operations on the database.\n\nFix: Use PreparedStatement with parameterized queries instead of string concatenation. Replace with: PreparedStatement ps = connection.prepareStatement(\"INSERT INTO users (username, password) VALUES ('foo', ?)\"); ps.setString(1, bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02697.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via HashMap\n\nUser input from SeparateClassRequest.getTheValue() is stored in a HashMap with key 'keyB-29916' and then retrieved back into bar. This tainted value is concatenated directly into an OS command string 'echo ' + bar and executed via ProcessBuilder. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized command execution or validate/sanitize input using ESAPI.encoder().encodeForOS(). Better yet, avoid shell execution entirely and use direct API calls.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02698.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via ThingFactory Pass-Through\n\nUser input from SeparateClassRequest.getTheValue() flows through ThingFactory.createThing().doSomething(param), which is a pass-through that returns the input unchanged. The tainted value is concatenated directly into an OS command string 'echo ' + bar and executed via ProcessBuilder. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized command execution or validate/sanitize input using ESAPI.encoder().encodeForOS(). Better yet, avoid shell execution entirely and use direct API calls.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02699.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Ternary Expression\n\nUser input from SeparateClassRequest.getTheValue() flows through a ternary expression where (7*42) - 106 = 188, and 188 > 200 is false, so bar is assigned param (user input). This tainted value is concatenated directly into an OS command string 'echo ' + bar and executed via ProcessBuilder. An attacker can inject shell metacharacters to execute arbitrary commands.\n\nImpact: An attacker can execute arbitrary operating system commands on the server, potentially leading to complete system compromise, data theft, or denial of service.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized command execution or validate/sanitize input using ESAPI.encoder().encodeForOS(). Better yet, avoid shell execution entirely and use direct API calls.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02713.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from SeparateClassRequest flows through doSomething() where it is assigned to 'bar' via a switch statement. The switch evaluates 'ABC'.charAt(1) which equals 'B', selecting case 'B' that assigns bar = \"bob\" (a safe constant). However, the code passes 'bar' as an environment variable to Runtime.exec(). While in this specific case the data flow results in a safe value, the pattern demonstrates command injection vulnerability structure.\n\nImpact: An attacker could potentially execute arbitrary system commands if the data flow were to change, leading to complete system compromise.\n\nFix: Avoid passing user input to Runtime.exec() environment variables. Use a whitelist of allowed values or sanitize input thoroughly. Consider using ProcessBuilder with explicit argument handling instead of Runtime.exec().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02714.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from SeparateClassRequest flows through doSomething() where it is added to a list at index 1, then index 0 is removed. After removal, the list becomes [param, 'moresafe'], and bar = valuesList.get(0) retrieves the user-controlled param value. This tainted value is then passed as an environment variable to Runtime.exec(), allowing command injection through environment variable manipulation.\n\nImpact: An attacker can inject malicious environment variables that could be used by the executed command to perform unauthorized actions, potentially leading to arbitrary code execution.\n\nFix: Never pass user-controlled input to Runtime.exec() environment variables. Validate and sanitize all input, or use a whitelist of allowed environment variable values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02728.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter 'BenchmarkTest02728' is stored in a HashMap and retrieved, then concatenated directly into a SQL query: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\". Although the USERNAME parameter uses PreparedStatement binding, the PASSWORD field uses string concatenation with user input, creating a SQL injection vulnerability.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) for ALL user inputs. Replace the string concatenation with a proper parameter binding: sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and use statement.setString(2, bar) to bind the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_89.CWE-89",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02729.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "SQL Injection via String Concatenation\n\nUser-controlled data from request parameter 'BenchmarkTest02729' is stored in a HashMap and retrieved, then concatenated directly into a SQL query: \"SELECT * from USERS where USERNAME=? and PASSWORD='\" + bar + \"'\". Although the USERNAME parameter uses PreparedStatement binding, the PASSWORD field uses string concatenation with user input, creating a SQL injection vulnerability.\n\nImpact: An attacker can inject arbitrary SQL commands, potentially reading, modifying, or deleting database contents, bypassing authentication, or executing administrative operations on the database.\n\nFix: Use parameterized queries (PreparedStatement) for ALL user inputs. Replace the string concatenation with a proper parameter binding: sql = \"SELECT * from USERS where USERNAME=? and PASSWORD=?\" and use statement.setString(2, bar) to bind the password parameter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-89"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00001.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie Input in File Read Operation\n\nUser-controlled input from cookie 'BenchmarkTest00001' is directly concatenated into a file path without validation. The cookie value flows through URLDecoder.decode() into the fileName variable, which is then used to construct a FileInputStream. An attacker can supply path traversal sequences like '../../../etc/passwd' to read arbitrary files on the system.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the cookie value to include path traversal sequences, potentially exposing sensitive configuration files, source code, or system files.\n\nFix: Implement path traversal protection by: (1) validating that the resolved canonical path starts with the expected base directory using Path.resolve() and startswith() checks, (2) rejecting inputs containing '../' or '..' sequences, or (3) using a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00002.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie Input in File Write Operation\n\nUser-controlled input from cookie 'BenchmarkTest00002' is directly concatenated into a file path without validation. The cookie value flows through URLDecoder.decode() into the fileName variable, which is then used to construct a FileOutputStream. An attacker can supply path traversal sequences to write to arbitrary file locations.\n\nImpact: An attacker can write to arbitrary files on the server filesystem by manipulating the cookie value to include path traversal sequences, potentially overwriting critical system files, configuration files, or achieving code execution by writing to executable locations.\n\nFix: Implement path traversal protection by: (1) validating that the resolved canonical path starts with the expected base directory using Path.resolve() and startswith() checks, (2) rejecting inputs containing '../' or '..' sequences, or (3) using a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00005.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) algorithm for encryption via Cipher.getInstance('DES/CBC/PKCS5Padding'). DES is a fundamentally broken encryption algorithm with only a 56-bit effective key length, making it vulnerable to brute-force attacks. DES has been deprecated for decades and should never be used for encrypting sensitive data.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and modest computing resources. The 56-bit key space can be exhausted in hours or days, completely compromising the confidentiality of encrypted data.\n\nFix: Replace DES with AES (Advanced Encryption Standard) using a strong mode like GCM: Cipher.getInstance('AES/GCM/NoPadding'). Use at least AES-128, preferably AES-256. Ensure proper key management and use unique IVs for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00007.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via Environment Variables\n\nUser-controlled input from HTTP header 'BenchmarkTest00007' is passed directly as an environment variable to Runtime.exec() without validation. The header value flows through URLDecoder.decode() into the argsEnv array, which is passed as the envp parameter to exec(). While this doesn't directly inject into the command, malicious environment variables can alter command behavior, enable code execution through LD_PRELOAD or similar mechanisms, or exploit environment-dependent vulnerabilities.\n\nImpact: An attacker can manipulate the execution environment of the spawned process by injecting malicious environment variables. This can lead to code execution (e.g., via LD_PRELOAD on Linux), information disclosure, or altered program behavior depending on how the executed command uses environment variables.\n\nFix: Do not pass user-controlled input as environment variables to exec(). If environment variables must be set, use a strict whitelist of allowed variable names and validate values against expected patterns. Consider using ProcessBuilder with an explicit environment map that only includes necessary, validated variables.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00011.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the 'BenchmarkTest00011' HTTP header is URL-decoded and directly used as the first argument to the File constructor. An attacker can supply a path containing '../' sequences to traverse outside the intended directory and access arbitrary files on the filesystem.\n\nImpact: An attacker can read, check existence of, or potentially manipulate files outside the intended directory by providing path traversal sequences like '../../etc/passwd'.\n\nFix: Validate and sanitize the file path. Use canonical path validation to ensure the resolved path stays within an allowed base directory. Example: Path resolvedPath = Paths.get(baseDir, param).normalize(); if (!resolvedPath.startsWith(baseDir)) { throw new SecurityException(); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00012.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input in Filter\n\nUser input from the 'BenchmarkTest00012' HTTP header is URL-decoded and directly concatenated into an LDAP search filter without sanitization. An attacker can inject LDAP filter metacharacters to modify the query logic.\n\nImpact: An attacker can bypass authentication, extract sensitive directory information, or enumerate users by injecting LDAP filter syntax like '*)(uid=*))(|(uid=*' to alter the query structure.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize user input before including it in LDAP filters, or use parameterized LDAP queries if supported by your LDAP library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00013.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String with User Input\n\nUser input from the 'Referer' HTTP header is URL-decoded and used directly as the format string in response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. An attacker can inject arbitrary HTML/JavaScript that will be rendered in the victim's browser.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's session, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode user input using ESAPI.encoder().encodeForHTML() before including it in HTTP responses. Never use user input as a format string. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00014.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String with User Input\n\nUser input from the 'Referer' HTTP header is URL-decoded and used directly as the format string in response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. An attacker can inject arbitrary HTML/JavaScript that will be rendered in the victim's browser.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's session, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode user input using ESAPI.encoder().encodeForHTML() before including it in HTTP responses. Never use user input as a format string. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00019.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES/3DES) Loaded from Properties\n\nThe code loads a cipher algorithm from a properties file with a default fallback of 'DESede/ECB/PKCS5Padding' (Triple DES). DES and 3DES are cryptographically weak algorithms that are vulnerable to brute-force attacks and should not be used for encryption.\n\nImpact: An attacker with access to encrypted data can potentially decrypt it using known attacks against DES/3DES, compromising the confidentiality of sensitive information.\n\nFix: Use a strong, modern encryption algorithm like AES-256 with GCM mode. Example: Cipher.getInstance(\"AES/GCM/NoPadding\"). Update the properties file and remove weak algorithm options.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00020.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES) with Insecure ECB Mode\n\nThe code uses DES (Data Encryption Standard) for encryption. DES is a cryptographically weak algorithm with a 56-bit key size that is vulnerable to brute-force attacks and has been deprecated for decades.\n\nImpact: An attacker with access to encrypted data can decrypt it using brute-force or known attacks against DES, compromising the confidentiality of sensitive information like passwords.\n\nFix: Replace DES with AES-256 using GCM mode for authenticated encryption. Example: Cipher.getInstance(\"AES/GCM/NoPadding\"). Generate appropriate key sizes (256-bit for AES-256) and use SecureRandom for IV generation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00023.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session token generation.\n\nImpact: An attacker can predict the rememberMe cookie values, allowing them to forge session cookies and impersonate other users, leading to account takeover.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: SecureRandom rand = new SecureRandom(); float randomFloat = rand.nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00028.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Unsanitized User Input in File Path\n\nUser input from request parameter 'BenchmarkTest00028' is directly concatenated into a file path without validation. An attacker can use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or overwrite arbitrary files on the filesystem that the application has access to, potentially leading to information disclosure, data corruption, or code execution.\n\nFix: Validate and sanitize the filename parameter. Check for path traversal sequences ('../', '..\\'), use canonical path validation, or use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00029.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file at runtime. While the default is SHA512 (secure), the actual algorithm used is determined by external configuration, which could be modified to use a weak algorithm like MD5 or SHA1. This represents a configurable weakness where the security depends on external configuration.\n\nImpact: If the properties file is modified to specify a weak algorithm (MD5, SHA1), password hashes become vulnerable to collision and preimage attacks, allowing attackers to crack passwords or forge hash values.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) in the code rather than loading it from configuration. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of MessageDigest.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00030.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input in Response\n\nUser input from request parameter 'BenchmarkTest00030' is directly passed to response.getWriter().printf() without sanitization. The response header 'X-XSS-Protection' is explicitly set to '0', disabling browser XSS protection. The user input is used as the format string in printf, allowing both XSS and format string attacks.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in victims' browsers, leading to session hijacking, credential theft, defacement, or malware distribution. The format string vulnerability could also lead to information disclosure.\n\nFix: HTML-encode the user input using ESAPI.encoder().encodeForHTML() before including it in the response. Remove the X-XSS-Protection: 0 header. Avoid using user input as a format string; use response.getWriter().print() instead of printf().",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00035.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm Configuration\n\nThe code loads a cryptographic algorithm from a properties file with a default value of 'DESede/ECB/PKCS5Padding' (Triple DES in ECB mode). DESede (3DES) is a weak encryption algorithm that is deprecated and should not be used for new applications. Additionally, ECB mode is insecure as it does not provide semantic security - identical plaintext blocks produce identical ciphertext blocks, revealing patterns in the data.\n\nImpact: An attacker who intercepts encrypted data may be able to decrypt it using known attacks against 3DES, or exploit the weaknesses of ECB mode to identify patterns and potentially recover plaintext. This compromises the confidentiality of sensitive data.\n\nFix: Use AES with GCM mode instead: 'AES/GCM/NoPadding'. Update the properties file and code to use: Cipher c = Cipher.getInstance(\"AES/GCM/NoPadding\"); and use SecretKey key = KeyGenerator.getInstance(\"AES\").generateKey(); with appropriate key size (128, 192, or 256 bits).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00036.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Reflected\n\nUser-controlled input from request parameter name is written directly to the HTTP response without encoding. The code retrieves the parameter name (not value) that matches 'BenchmarkTest00036' and writes it to the response using response.getWriter().write(param.toCharArray(), 0, length). The X-XSS-Protection header is explicitly disabled, and no HTML encoding is applied before output.\n\nImpact: An attacker can inject malicious JavaScript code through the parameter name, which will be executed in the victim's browser. This can lead to session hijacking, credential theft, defacement, or other client-side attacks. For example, a parameter name like '<script>alert(document.cookie)</script>' would execute in the browser.\n\nFix: Apply proper output encoding before writing to the response. Use ESAPI or similar library: response.getWriter().write(ESAPI.encoder().encodeForHTML(param)); Also, remove the X-XSS-Protection: 0 header or set it to 1 to enable browser XSS protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00040.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter 'BenchmarkTest00040' is used directly to construct a file path without validation. The code retrieves the parameter via SeparateClassRequest.getTheParameter() and passes it directly to new java.io.File(param). No validation is performed to prevent directory traversal sequences like '../' or absolute paths.\n\nImpact: An attacker can access arbitrary files on the server's filesystem by using path traversal sequences. For example, an attacker could use '../../../etc/passwd' to access sensitive system files, or navigate to other directories to read configuration files, source code, or other sensitive data. The code checks file existence, potentially leaking information about the filesystem structure.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed directories and filenames. Canonicalize the path using File.getCanonicalPath() and verify it starts with an allowed base directory. Example: File baseDir = new File(\"/safe/directory\"); File file = new File(baseDir, param); if (!file.getCanonicalPath().startsWith(baseDir.getCanonicalPath())) { throw new SecurityException(\"Invalid path\"); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00041.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via SeparateClassRequest\n\nUser-controlled input from SeparateClassRequest.getTheParameter() is written directly to the HTTP response without sanitization. The X-XSS-Protection header is explicitly disabled, and the parameter value is written to the response body, allowing XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Encode the user input using ESAPI.encoder().encodeForHTML() before writing to the response: response.getWriter().write(ESAPI.encoder().encodeForHTML(param));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00045.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser-controlled input from request.getParameterValues() is concatenated directly to a file path and used to open a FileInputStream. No validation is performed to prevent directory traversal sequences like '../'.\n\nImpact: An attacker can use path traversal sequences to read arbitrary files on the server filesystem, potentially accessing sensitive configuration files, source code, or credentials.\n\nFix: Validate that the resolved canonical path stays within the intended directory: File file = new File(TESTFILES_DIR, param); if (!file.getCanonicalPath().startsWith(new File(TESTFILES_DIR).getCanonicalPath())) { throw new SecurityException(); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00046.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (MD5)\n\nThe code uses MD5, a cryptographically broken hash algorithm, to hash sensitive values (passwords). MD5 is vulnerable to collision attacks and should not be used for security purposes.\n\nImpact: An attacker can potentially reverse or forge MD5 hashes, compromising the integrity of password storage and authentication mechanisms.\n\nFix: Use a strong password hashing algorithm like bcrypt, scrypt, Argon2, or PBKDF2. For general-purpose hashing, use SHA-256 or stronger: MessageDigest.getInstance(\"SHA-256\");",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00047.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via format() Method\n\nUser-controlled input from the query string is URL-decoded and then used as a format string in response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. The user input is written to the HTTP response body without sanitization.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Encode the user input using ESAPI.encoder().encodeForHTML() before writing to the response, or use print() instead of format() with user input: response.getWriter().print(ESAPI.encoder().encodeForHTML(param));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00048.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via print() Method\n\nUser-controlled input from the query string is URL-decoded and then written directly to the HTTP response without sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Encode the user input using ESAPI.encoder().encodeForHTML() before writing to the response: response.getWriter().print(ESAPI.encoder().encodeForHTML(param));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00049.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via write() Method\n\nUser-controlled input from the query string is URL-decoded and then concatenated into a string that is written to the HTTP response without sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Encode the user input using ESAPI.encoder().encodeForHTML() before writing to the response: response.getWriter().write(\"Parameter value: \" + ESAPI.encoder().encodeForHTML(param));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00050.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard), a weak and obsolete encryption algorithm with a 56-bit key size. DES is vulnerable to brute-force attacks and has been deprecated for security-sensitive applications.\n\nImpact: An attacker can potentially decrypt sensitive data encrypted with DES using modern computing resources, compromising the confidentiality of the encrypted information.\n\nFix: Use a strong encryption algorithm like AES with at least 128-bit keys: Cipher.getInstance(\"AES/GCM/NoPadding\"). For CBC mode, use AES/CBC/PKCS5Padding with proper IV handling.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_78.CWE-78",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00051.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Command Injection via SeparateClassRequest\n\nUser input from SeparateClassRequest is concatenated directly into a shell command without sanitization. While SeparateClassRequest is a custom wrapper (not direct HttpServletRequest), the getTheValue() method returns user-controlled data that flows into the ProcessBuilder command array. The command 'echo ' + param allows command injection through shell metacharacters.\n\nImpact: An attacker can execute arbitrary system commands on the server by injecting shell metacharacters into the parameter, leading to complete system compromise.\n\nFix: Avoid concatenating user input into shell commands. Use parameterized commands or validate/sanitize input to remove shell metacharacters. Consider using ESAPI.encoder().encodeForOS() to sanitize the input before use.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-78"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00053.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. DES has been deprecated since 1999.\n\nImpact: Encrypted sensitive data can be decrypted by attackers using brute-force attacks, exposing confidential information such as passwords stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00055.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: Encrypted sensitive data can be decrypted by attackers using brute-force attacks, exposing confidential information such as passwords stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00056.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: Encrypted sensitive data can be decrypted by attackers using brute-force attacks, exposing confidential information such as passwords stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00057.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: Encrypted sensitive data can be decrypted by attackers using brute-force attacks, exposing confidential information such as passwords stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00060.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser input from a cookie is Base64 encoded then decoded (which is effectively a no-op) and used directly to construct a file path without validation. An attacker can supply path traversal sequences like '../../../etc/passwd' to access files outside the intended directory.\n\nImpact: An attacker can read arbitrary files on the server filesystem by traversing directories, potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate the filename to ensure it doesn't contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory. Reject filenames containing '..' or absolute paths.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00061.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie Input\n\nUser-controlled cookie value is decoded and used directly as a file path component without validation. The cookie value 'BenchmarkTest00061' is retrieved, URL-decoded, then Base64 encoded/decoded (which does not sanitize path traversal sequences), and used to construct a File object. An attacker can supply '../' sequences in the cookie to traverse directories.\n\nImpact: An attacker can read or write arbitrary files on the filesystem by manipulating the cookie value to include path traversal sequences like '../../../etc/passwd'.\n\nFix: Validate that the file path does not contain '..' or other path traversal sequences. Use a whitelist of allowed file names or canonicalize the path and verify it stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00062.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie Input\n\nUser-controlled cookie value is decoded, stored in a HashMap, retrieved, and used as a file path without validation. The cookie value flows through: cookie -> param -> HashMap -> bar -> fileName. An attacker can supply path traversal sequences in the cookie.\n\nImpact: An attacker can read arbitrary files on the filesystem by manipulating the cookie value to include path traversal sequences like '../../../etc/passwd'.\n\nFix: Validate that the file path does not contain '..' or other path traversal sequences. Use a whitelist of allowed file names or canonicalize the path and verify it stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00065.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie Input\n\nUser-controlled cookie value is decoded and used directly as a file path component without validation. The cookie value is Base64 encoded/decoded (which does not sanitize path traversal sequences) and concatenated to form a file path used with Files.newInputStream().\n\nImpact: An attacker can read arbitrary files on the filesystem by manipulating the cookie value to include path traversal sequences like '../../../etc/passwd'.\n\nFix: Validate that the file path does not contain '..' or other path traversal sequences. Use a whitelist of allowed file names or canonicalize the path and verify it stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00071.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) via MessageDigest.getInstance(\"SHA1\", \"SUN\") for hashing sensitive data. SHA-1 is cryptographically broken and should not be used for security purposes. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially perform collision attacks or reverse the hash to recover sensitive data. SHA-1 has known vulnerabilities that make it unsuitable for password hashing or any security-sensitive hashing operations.\n\nFix: Replace SHA-1 with a strong hash algorithm like SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00073.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm MD5 Used\n\nThe code uses MD5 via MessageDigest.getInstance(\"MD5\") for hashing sensitive data. MD5 is cryptographically broken with known collision vulnerabilities and should not be used for security purposes. The vulnerability is the algorithm choice itself.\n\nImpact: An attacker could perform collision attacks or use rainbow tables to reverse MD5 hashes. MD5 is completely unsuitable for password hashing or any security-sensitive operations.\n\nFix: Replace MD5 with a strong hash algorithm like SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00078.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' authentication token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and forge authentication cookies to impersonate other users, leading to unauthorized account access.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00079.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' authentication token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and forge authentication cookies to impersonate other users, leading to unauthorized account access.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00080.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' authentication token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and forge authentication cookies to impersonate other users, leading to unauthorized account access.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00081.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); double stuff = secureRandom.nextGaussian();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00082.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe token values (limited to 0-98), allowing them to forge authentication cookies and impersonate other users through brute force or prediction.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); int randNumber = secureRandom.nextInt(99);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00083.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe token values (limited to 0-98), allowing them to forge authentication cookies and impersonate other users through brute force or prediction.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); int randNumber = secureRandom.nextInt(99);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00084.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); int r = secureRandom.nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00085.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); long l = secureRandom.nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00086.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); long l = secureRandom.nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00098.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from a cookie is HTML-escaped and then stored directly in the HTTP session. HTML escaping does NOT prevent trust boundary violations - it only protects against XSS. The issue is storing unvalidated user input in a trusted context (the session), which can lead to session poisoning or privilege escalation.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Use application-specific validation rules to ensure only expected values are stored. HTML escaping is insufficient for trust boundary protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00119.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using modern computing resources, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00120.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using modern computing resources, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00123.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. It has been deprecated since the late 1990s and should never be used for encrypting sensitive data.\n\nImpact: An attacker with access to the encrypted data can decrypt it using brute-force attacks or known cryptanalytic techniques against DES. This exposes sensitive information that was intended to be protected.\n\nFix: Replace DES with AES-256 in GCM or CBC mode. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256. Ensure proper IV generation using SecureRandom for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00124.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. It has been deprecated since the late 1990s and should never be used for encrypting sensitive data.\n\nImpact: An attacker with access to the encrypted data can decrypt it using brute-force attacks or known cryptanalytic techniques against DES. This exposes sensitive information that was intended to be protected.\n\nFix: Replace DES with AES-256 in GCM or CBC mode. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256. Ensure proper IV generation using SecureRandom for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00125.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. It has been deprecated since the late 1990s and should never be used for encrypting sensitive data.\n\nImpact: An attacker with access to the encrypted data can decrypt it using brute-force attacks or known cryptanalytic techniques against DES. This exposes sensitive information that was intended to be protected.\n\nFix: Replace DES with AES-256 in GCM or CBC mode. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256. Ensure proper IV generation using SecureRandom for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00133.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the HTTP header 'BenchmarkTest00133' flows into a file path without validation. The ternary condition evaluates to: (7 * 42) - 106 = 188, and 188 > 200 is FALSE, so bar is assigned param (user input). This user-controlled value is then concatenated with TESTFILES_DIR and used to construct a FileInputStream, allowing an attacker to read arbitrary files via path traversal sequences like '../../../etc/passwd'.\n\nImpact: An attacker can read arbitrary files on the server filesystem by injecting path traversal sequences (e.g., '../') in the BenchmarkTest00133 header, potentially exposing sensitive configuration files, credentials, or source code.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed filenames, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory. Alternatively, use Path.normalize() and validate the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00140.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.lang.Math.random() to generate a 'rememberMe' session token. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker. The rememberMe token is used for authentication purposes (stored in cookies and session), making this a security-critical context where weak randomness enables session hijacking attacks.\n\nImpact: An attacker can predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users without knowing their credentials.\n\nFix: Replace java.lang.Math.random() with java.security.SecureRandom for generating security-sensitive tokens. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00141.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The algorithm is hardcoded as 'SHA1' in both branches of the conditional.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge hash values, compromising the integrity of password storage or other security mechanisms relying on this hash.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00144.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the Referer header flows into bar (after list manipulation: valuesList.add(param), valuesList.remove(0), bar = valuesList.get(0)), which is then used as the format string in response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. This allows an attacker to inject arbitrary HTML/JavaScript into the response.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other client-side attacks.\n\nFix: HTML-encode user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar. Never use user input as a format string. Use a fixed format string and pass user data as arguments: response.getWriter().format(\"Fixed format: %s\", bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00145.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the Referer header flows into bar via HashMap storage and retrieval (map17589.put(\"keyB-17589\", param); bar = (String) map17589.get(\"keyB-17589\")), which is then used as the format string in response.getWriter().format(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other client-side attacks.\n\nFix: HTML-encode user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar. Never use user input as a format string. Use a fixed format string and pass user data as arguments.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00146.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the Referer header flows into bar (with only a minor string manipulation replacing the last character with 'Z'), which is then used as the format string in response.getWriter().format(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other client-side attacks.\n\nFix: HTML-encode user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar. Never use user input as a format string. Use a fixed format string and pass user data as arguments.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00148.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the Referer header flows into bar via the conditional assignment (num=196, (500/42)+196=207>200 is true, so bar=param), which is then placed in the obj array and output via response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. While the format string itself is fixed, the user data in obj[1] (bar) is rendered without encoding.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other client-side attacks.\n\nFix: HTML-encode user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar. Encode bar before placing it in the obj array: obj[1] = ESAPI.encoder().encodeForHTML(bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00149.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Printf\n\nUser-controlled input from the Referer header flows into bar (with '_SafeStuff' appended), which is then placed in the obj array and output via response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled. The user data in obj[1] (bar) is rendered without encoding.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other client-side attacks.\n\nFix: HTML-encode user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar. Encode bar before placing it in the obj array: obj[1] = ESAPI.encoder().encodeForHTML(bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00150.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Printf\n\nUser-controlled input from the Referer header flows into bar via the conditional assignment (num=196, (500/42)+196=207>200 is true, so bar=param), which is then placed in the obj array and output via response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled. The user data in obj[1] (bar) is rendered without encoding.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other client-side attacks.\n\nFix: HTML-encode user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar. Encode bar before placing it in the obj array: obj[1] = ESAPI.encoder().encodeForHTML(bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00151.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header flows into the HTTP response without sanitization. The code retrieves the Referer header, URL decodes it, adds it to a list, removes the first element, then retrieves index 1 which is 'moresafe' (a safe constant). After mutations: valuesList = ['safe', param, 'moresafe'] \u2192 remove(0) \u2192 ['param', 'moresafe']. bar = valuesList.get(1) retrieves 'moresafe', which is a safe constant string literal. However, the response has X-XSS-Protection disabled and uses printf with user-influenced format string.\n\nImpact: An attacker could inject malicious JavaScript that executes in victims' browsers, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode all user input before including in HTTP responses using ESAPI.encoder().encodeForHTML() or similar. Enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00152.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in Switch Statement\n\nUser-controlled data from the Referer header flows into the HTTP response without sanitization. The code uses a switch statement with switchTarget = 'ABC'.charAt(2) = 'C', which matches case 'C' and assigns bar = param (tainted). The tainted value is then written to the response with X-XSS-Protection disabled.\n\nImpact: An attacker could inject malicious JavaScript that executes in victims' browsers, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode all user input before including in HTTP responses using ESAPI.encoder().encodeForHTML() or similar. Enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00153.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in HashMap\n\nUser-controlled data from the Referer header flows into the HTTP response without sanitization. The code stores param in a HashMap under key 'keyB-96050', then retrieves it back into bar. The tainted value is then written to the response with X-XSS-Protection disabled.\n\nImpact: An attacker could inject malicious JavaScript that executes in victims' browsers, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode all user input before including in HTTP responses using ESAPI.encoder().encodeForHTML() or similar. Enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00154.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in Switch Statement\n\nUser-controlled data from the Referer header flows into the HTTP response without sanitization. The code uses a switch statement with switchTarget = 'ABC'.charAt(2) = 'C', which matches case 'C' and assigns bar = param (tainted). The tainted value is then written to the response with X-XSS-Protection disabled.\n\nImpact: An attacker could inject malicious JavaScript that executes in victims' browsers, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode all user input before including in HTTP responses using ESAPI.encoder().encodeForHTML() or similar. Enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00155.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header through ThingFactory\n\nUser-controlled data from the Referer header flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) into the HTTP response without sanitization. The tainted value is then written to the response with X-XSS-Protection disabled.\n\nImpact: An attacker could inject malicious JavaScript that executes in victims' browsers, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode all user input before including in HTTP responses using ESAPI.encoder().encodeForHTML() or similar. Enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00156.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in List\n\nUser-controlled data from the Referer header flows into the HTTP response without sanitization. The code adds param to a list at index 1, removes index 0, then retrieves index 0. After mutations: valuesList = ['safe', param, 'moresafe'] \u2192 remove(0) \u2192 [param, 'moresafe']. bar = valuesList.get(0) retrieves param (tainted). The tainted value is then written to the response with X-XSS-Protection disabled.\n\nImpact: An attacker could inject malicious JavaScript that executes in victims' browsers, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode all user input before including in HTTP responses using ESAPI.encoder().encodeForHTML() or similar. Enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00157.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in Ternary Expression\n\nUser-controlled data from the Referer header flows into the HTTP response without sanitization. The ternary expression evaluates (7*42) - 106 = 188, and 188 > 200 is FALSE, so bar = param (tainted). The tainted value is then written to the response with X-XSS-Protection disabled.\n\nImpact: An attacker could inject malicious JavaScript that executes in victims' browsers, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode all user input before including in HTTP responses using ESAPI.encoder().encodeForHTML() or similar. Enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00160.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.util.Random().nextBytes() to generate a 'rememberMe' cookie value for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, making the remember-me tokens guessable.\n\nImpact: An attacker could predict or brute-force remember-me tokens, leading to unauthorized account access and session hijacking.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for all security-sensitive random number generation: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00161.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'new java.security.SecureRandom().nextDouble()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00162.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'new java.security.SecureRandom().nextGaussian()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00163.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'new java.security.SecureRandom().nextGaussian()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00164.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'new java.security.SecureRandom().nextInt()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00165.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'new java.security.SecureRandom().nextInt()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00166.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'new java.security.SecureRandom().nextLong()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00167.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'new java.security.SecureRandom().nextLong()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00168.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'new java.security.SecureRandom().nextLong()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00208.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically weak by modern standards.\n\nImpact: Encrypted data can be decrypted by attackers using readily available tools and computing power, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256, and use a 12-byte IV with GCMParameterSpec(128, iv).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00210.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically weak by modern standards.\n\nImpact: Encrypted data can be decrypted by attackers using readily available tools and computing power, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256, and use a 12-byte IV with GCMParameterSpec(128, iv).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00215.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Header Name in File Path\n\nThe application extracts a non-standard HTTP header name and uses it directly to construct a file path without validation. An attacker can supply a malicious header name containing path traversal sequences (e.g., '../../../etc/passwd') to access files outside the intended directory.\n\nImpact: An attacker can read or check the existence of arbitrary files on the server's filesystem by manipulating the HTTP header name, potentially exposing sensitive configuration files, application source code, or system files.\n\nFix: Validate and sanitize the header name before using it in file operations. Use a whitelist of allowed characters, reject paths containing '..' or absolute path indicators, and consider using Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00216.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Header Name in File Path\n\nThe application extracts a non-standard HTTP header name and assigns it to 'bar' via a conditional that always evaluates to true ((500/42) + 196 = 207 > 200). The tainted header name is then used directly to construct a file path without validation, allowing path traversal attacks.\n\nImpact: An attacker can read or check the existence of arbitrary files on the server's filesystem by manipulating the HTTP header name with path traversal sequences like '../../../etc/passwd', potentially exposing sensitive files.\n\nFix: Validate and sanitize the header name before using it in file operations. Use a whitelist of allowed characters, reject paths containing '..' or absolute path indicators, and consider using Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00218.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Header Name in URI Construction\n\nThe application extracts a non-standard HTTP header name and assigns it to 'bar' via a switch statement. Since guess.charAt(2) = 'C', case 'C' executes and assigns the tainted param to bar. This value is then used to construct a file URI without validation, allowing path traversal attacks.\n\nImpact: An attacker can access arbitrary files on the server's filesystem by manipulating the HTTP header name with path traversal sequences, potentially exposing sensitive files or checking for the existence of specific files.\n\nFix: Validate and sanitize the header name before using it in file URI construction. Use a whitelist of allowed characters, reject paths containing '..' or absolute path indicators, and consider using Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00219.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Header Name in FileInputStream\n\nThe application extracts a non-standard HTTP header name and assigns it to 'bar' via a ternary expression. The condition (7*42) - 106 = 188 > 200 evaluates to false, so bar = param (tainted). This value is then concatenated with TESTFILES_DIR and used to open a FileInputStream without validation, allowing path traversal attacks.\n\nImpact: An attacker can read arbitrary files on the server's filesystem by manipulating the HTTP header name with path traversal sequences like '../../../etc/passwd', potentially exposing sensitive configuration files, credentials, or application source code.\n\nFix: Validate and sanitize the header name before using it in file operations. Use a whitelist of allowed characters, reject paths containing '..' or absolute path indicators, and consider using Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00222.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Header Name\n\nThe application extracts the name of a non-standard HTTP header and uses it directly in a file path without validation. The switch statement evaluates `guess.charAt(2)` which equals 'C', causing case 'C' to execute and assign `param` (the header name) to `bar`. This value is then concatenated with TESTFILES_DIR to construct a file path for FileOutputStream, allowing an attacker to perform path traversal attacks by sending a header with a name like `../../../etc/passwd`.\n\nImpact: An attacker can read, write, or overwrite arbitrary files on the server filesystem by manipulating the header name to include path traversal sequences (../).\n\nFix: Validate and sanitize the header name before using it in file operations. Use a whitelist of allowed characters, reject any input containing '../' or absolute paths, and use Path.normalize() with startsWith() validation against the base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00230.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe application uses java.util.Random().nextBytes() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable output, making it unsuitable for security-sensitive operations like session token generation.\n\nImpact: An attacker can predict the random values generated, potentially allowing them to forge session cookies and hijack user sessions.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00231.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextGaussian() to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating session tokens. Example: new java.security.SecureRandom().nextDouble()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00232.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextGaussian() to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating session tokens. Example: new java.security.SecureRandom().nextDouble()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00233.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextInt(99) to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values with a very small keyspace (only 99 possible values), making session tokens trivially guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens with minimal effort (only 99 attempts needed), leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom and use a larger keyspace. Example: new java.security.SecureRandom().nextInt()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00234.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextInt(99) to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values with a very small keyspace (only 99 possible values), making session tokens trivially guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens with minimal effort (only 99 attempts needed), leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom and use a larger keyspace. Example: new java.security.SecureRandom().nextInt()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00235.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextInt() to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating session tokens. Example: new java.security.SecureRandom().nextInt()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00236.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextInt() to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating session tokens. Example: new java.security.SecureRandom().nextInt()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00237.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextInt() to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating session tokens. Example: new java.security.SecureRandom().nextInt()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00238.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextLong() to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating session tokens. Example: new java.security.SecureRandom().nextLong()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00239.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextLong() to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating session tokens. Example: new java.security.SecureRandom().nextLong()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00240.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generation for Session Token\n\nThe application uses java.util.Random.nextLong() to generate a remember-me session token. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable by attackers.\n\nImpact: An attacker could predict or brute-force remember-me tokens, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating session tokens. Example: new java.security.SecureRandom().nextLong()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00254.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) algorithm for encryption via Cipher.getInstance('DES/CBC/PKCS5PADDING'). DES is a deprecated encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically broken.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and moderate computing resources. This compromises the confidentiality of any data protected by this encryption, including the password file being written.\n\nFix: Replace DES with a modern, secure encryption algorithm such as AES-256 with GCM mode (AES/GCM/NoPadding). Use a minimum key size of 128 bits for AES, preferably 256 bits for sensitive data.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00256.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) algorithm for encryption via Cipher.getInstance('DES/CBC/PKCS5Padding', 'SunJCE'). DES is a deprecated encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically broken.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and moderate computing resources. This compromises the confidentiality of any data protected by this encryption, including the password file being written.\n\nFix: Replace DES with a modern, secure encryption algorithm such as AES-256 with GCM mode (AES/GCM/NoPadding). Use a minimum key size of 128 bits for AES, preferably 256 bits for sensitive data.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00257.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) algorithm for encryption via Cipher.getInstance('DES/CBC/PKCS5Padding', 'SunJCE'). DES is a deprecated encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically broken.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and moderate computing resources. This compromises the confidentiality of any data protected by this encryption, including the password file being written.\n\nFix: Replace DES with a modern, secure encryption algorithm such as AES-256 with GCM mode (AES/GCM/NoPadding). Use a minimum key size of 128 bits for AES, preferably 256 bits for sensitive data.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00258.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) algorithm for encryption via Cipher.getInstance('DES/CBC/PKCS5Padding', 'SunJCE'). DES is a deprecated encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically broken.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and moderate computing resources. This compromises the confidentiality of any data protected by this encryption, including the password file being written.\n\nFix: Replace DES with a modern, secure encryption algorithm such as AES-256 with GCM mode (AES/GCM/NoPadding). Use a minimum key size of 128 bits for AES, preferably 256 bits for sensitive data.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00262.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the BenchmarkTest00262 header flows into a file path without validation. The switch statement evaluates guess.charAt(2) which equals 'C', causing case 'C' to execute and assign param (user input) to bar. This bar value is then used directly to construct a File object, allowing path traversal attacks.\n\nImpact: An attacker can access arbitrary files on the system by providing path traversal sequences like '../../../etc/passwd' in the BenchmarkTest00262 header, potentially reading sensitive files or accessing unauthorized directories.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed file names, canonicalize the path using File.getCanonicalPath(), and verify it stays within the intended directory. Alternatively, use Path.normalize() and validate against a base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00264.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the BenchmarkTest00264 header flows into a file path. The condition (500/42) + 196 = 11 + 196 = 207 > 200 is true, so bar is assigned param (user input). This is then concatenated with TESTFILES_DIR and used to open a FileInputStream, allowing path traversal.\n\nImpact: An attacker can read arbitrary files on the system by providing path traversal sequences like '../../../etc/passwd' in the header, potentially accessing sensitive configuration files, credentials, or other unauthorized data.\n\nFix: Validate the user input against a whitelist of allowed file names. Canonicalize the path and verify it remains within TESTFILES_DIR. Use Path.resolve() with proper validation to prevent directory traversal.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00276.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled input from the Referer HTTP header is directly output to the HTTP response without sanitization. The ternary condition (7*42) - 106 > 200 evaluates to 188 > 200 which is false, so bar is assigned the unsanitized param value. The X-XSS-Protection header is explicitly disabled, and the tainted data is written to the response.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser. This can lead to session hijacking, credential theft, defacement, or redirection to malicious sites.\n\nFix: Sanitize user input before outputting to HTTP response using proper encoding functions such as ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape(). Remove the X-XSS-Protection: 0 header or set it to 1.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00279.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled input from the Referer HTTP header flows through a list manipulation and is directly output to the HTTP response without sanitization. After removing the first element, valuesList.get(0) returns the param value (tainted). The X-XSS-Protection header is explicitly disabled, and the tainted data is written to the response.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser. This can lead to session hijacking, credential theft, defacement, or redirection to malicious sites.\n\nFix: Sanitize user input before outputting to HTTP response using proper encoding functions such as ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape(). Remove the X-XSS-Protection: 0 header or set it to 1.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00280.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled input from the Referer HTTP header is directly output to the HTTP response without sanitization. The switch statement evaluates guess.charAt(2) which is 'C', and case 'C' assigns param to bar. The X-XSS-Protection header is explicitly disabled, and the tainted data is written to the response.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser. This can lead to session hijacking, credential theft, defacement, or redirection to malicious sites.\n\nFix: Sanitize user input before outputting to HTTP response using proper encoding functions such as ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape(). Remove the X-XSS-Protection: 0 header or set it to 1.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00284.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled input from the Referer HTTP header is directly written to the HTTP response without sanitization. The code retrieves the Referer header value, URL decodes it, assigns it directly to 'bar', and outputs it via response.getWriter().println(bar). The X-XSS-Protection header is explicitly disabled, making this a confirmed XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser context, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding to the user input before outputting it to the response. Use ESAPI.encoder().encodeForHTML(param) or similar encoding functions to neutralize special HTML characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00287.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled input from the Referer HTTP header is directly written to the HTTP response without sanitization. The code retrieves the Referer header value, URL decodes it, assigns it directly to 'bar', and outputs it via response.getWriter().write(bar.toCharArray(), 0, length). The X-XSS-Protection header is explicitly disabled, confirming this as an XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser context, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding to the user input before outputting it to the response. Use ESAPI.encoder().encodeForHTML(param) or similar encoding functions to neutralize special HTML characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00290.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled input from the Referer HTTP header is concatenated with a safe string and written to the HTTP response without sanitization. The code retrieves the Referer header value, URL decodes it, appends '_SafeStuff' to it via StringBuilder, and outputs the result via response.getWriter().write(bar). The X-XSS-Protection header is explicitly disabled. Appending safe content to tainted data does not sanitize the tainted prefix, making this an XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser context, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding to the user input before outputting it to the response. Use ESAPI.encoder().encodeForHTML(param) before creating the StringBuilder, or encode the final 'bar' value before writing it to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00291.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header is written directly to the HTTP response without sanitization. The code retrieves the Referer header value, URL decodes it, performs a substring operation, and writes it to the response. The X-XSS-Protection header is explicitly disabled (set to 0), confirming XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Encode the output using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing to the response. Example: response.getWriter().write(ESAPI.encoder().encodeForHTML(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00292.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header is written directly to the HTTP response without sanitization. The code retrieves the Referer header value, URL decodes it, performs a substring operation, and writes it to the response using write(String, int, int). The X-XSS-Protection header is explicitly disabled (set to 0), confirming XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Encode the output using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing to the response. Example: response.getWriter().write(ESAPI.encoder().encodeForHTML(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00296.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making the session token vulnerable to prediction attacks.\n\nImpact: An attacker can predict the rememberMe token values, potentially allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens. Example: byte[] randomBytes = new byte[32]; new SecureRandom().nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00297.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making the session token vulnerable to prediction attacks.\n\nImpact: An attacker can predict the rememberMe token values, potentially allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens. Example: byte[] randomBytes = new byte[32]; new SecureRandom().nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00298.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making the session token vulnerable to prediction attacks. Additionally, the range of only 99 possible values makes brute-force attacks trivial.\n\nImpact: An attacker can easily predict or brute-force the rememberMe token values (only 99 possibilities), allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens with sufficient entropy. Example: byte[] randomBytes = new byte[32]; new SecureRandom().nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00299.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making the session token vulnerable to prediction attacks.\n\nImpact: An attacker can predict the rememberMe token values, potentially allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens. Example: byte[] randomBytes = new byte[32]; new SecureRandom().nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00301.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled input from the Referer HTTP header is retrieved, stored in a HashMap, and then written directly to the HTTP response without sanitization. The code explicitly disables XSS protection with response.setHeader(\"X-XSS-Protection\", \"0\"), making the application vulnerable to reflected XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser context, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Encode the output using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00347.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the random values and forge session cookies, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: long l = java.security.SecureRandom.getInstanceStrong().nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00354.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DESede/3DES\n\nThe code loads a cryptographic algorithm from a properties file with a default value of 'DESede/ECB/PKCS5Padding'. DESede (also known as 3DES or Triple DES) is a weak encryption algorithm that is deprecated and should not be used for encryption. The algorithm is vulnerable to various attacks including sweet32 birthday attacks.\n\nImpact: An attacker could potentially decrypt sensitive data encrypted with this weak algorithm, compromising the confidentiality of encrypted information.\n\nFix: Replace DESede/3DES with a strong modern encryption algorithm such as AES-256 with GCM mode (AES/GCM/NoPadding). Update the default value in the properties file and ensure all deployments use strong encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00355.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DESede/3DES\n\nThe code loads a cryptographic algorithm from a properties file with a default value of 'DESede/ECB/PKCS5Padding'. DESede (also known as 3DES or Triple DES) is a weak encryption algorithm that is deprecated and should not be used for encryption. The algorithm is vulnerable to various attacks including sweet32 birthday attacks.\n\nImpact: An attacker could potentially decrypt sensitive data encrypted with this weak algorithm, compromising the confidentiality of encrypted information.\n\nFix: Replace DESede/3DES with a strong modern encryption algorithm such as AES-256 with GCM mode (AES/GCM/NoPadding). Update the default value in the properties file and ensure all deployments use strong encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00356.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DESede/3DES\n\nThe code loads a cryptographic algorithm from a properties file with a default value of 'DESede/ECB/PKCS5Padding'. DESede (also known as 3DES or Triple DES) is a weak encryption algorithm that is deprecated and should not be used for encryption. The algorithm is vulnerable to various attacks including sweet32 birthday attacks.\n\nImpact: An attacker could potentially decrypt sensitive data encrypted with this weak algorithm, compromising the confidentiality of encrypted information.\n\nFix: Replace DESede/3DES with a strong modern encryption algorithm such as AES-256 with GCM mode (AES/GCM/NoPadding). Update the default value in the properties file and ensure all deployments use strong encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00359.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter 'BenchmarkTest00359' flows directly into a file path without validation. The condition '(500 / 42) + num > 200' evaluates to '(11) + 196 > 200' which is '207 > 200' (true), so bar is assigned the user input param. This allows an attacker to use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the file path, potentially accessing sensitive configuration files, source code, or system files.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed files or directories, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory. Never allow user input to directly control file paths.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00360.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter 'BenchmarkTest00360' flows through Base64 encoding/decoding (which does not sanitize path traversal) and is then used to construct a file path. The fileName is built by concatenating Utils.TESTFILES_DIR with the user-controlled bar variable, which is then used to open a FileInputStream. An attacker can use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the file path, potentially accessing sensitive configuration files, credentials, source code, or system files.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed files, canonicalize the path using File.getCanonicalPath(), and verify it starts with Utils.TESTFILES_DIR. Never allow user input to directly control file paths.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00362.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest00362' is directly concatenated with a base directory path and used to create a FileOutputStream. An attacker can supply path traversal sequences (e.g., '../../../etc/passwd') to write to arbitrary files outside the intended directory.\n\nImpact: An attacker can write to arbitrary files on the filesystem, potentially overwriting critical system files, configuration files, or application code, leading to system compromise, data corruption, or denial of service.\n\nFix: Validate and sanitize the user input to prevent path traversal. Use Path.normalize() and verify the resolved path starts with the intended base directory. Alternatively, use a whitelist of allowed filenames or implement proper access controls.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00363.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest00363' is directly concatenated with a base directory path and used to create a FileInputStream. An attacker can supply path traversal sequences (e.g., '../../../etc/passwd') to read arbitrary files outside the intended directory.\n\nImpact: An attacker can read arbitrary files on the filesystem, potentially accessing sensitive data such as configuration files, credentials, private keys, or other confidential information.\n\nFix: Validate and sanitize the user input to prevent path traversal. Use Path.normalize() and verify the resolved path starts with the intended base directory. Alternatively, use a whitelist of allowed filenames or implement proper access controls.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00368.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict or brute-force the rememberMe cookie values, allowing them to hijack user sessions, impersonate legitimate users, and gain unauthorized access to user accounts.\n\nFix: Replace java.lang.Math.random() with java.security.SecureRandom for all security-sensitive random number generation. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00369.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict or brute-force the rememberMe cookie values, allowing them to hijack user sessions, impersonate legitimate users, and gain unauthorized access to user accounts.\n\nFix: Replace java.lang.Math.random() with java.security.SecureRandom for all security-sensitive random number generation. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00375.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest00375' flows directly into response.getWriter().format() without sanitization. The X-XSS-Protection header is explicitly disabled, and the user input is used as the format string itself, allowing arbitrary HTML/JavaScript injection.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input using ESAPI.encoder().encodeForHTML() or similar before including it in the response. Never use user input directly as a format string. Consider removing the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00376.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest00376' flows through a ternary expression (evaluates to param since (7*42)-106=188 which is NOT > 200) into the response output without sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input using ESAPI.encoder().encodeForHTML() or similar before including it in the response. Consider removing the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00378.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest00378' is appended with '_SafeStuff' but still contains the original user input at the beginning. This tainted data is then used as a format string in response.getWriter().format() without sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input using ESAPI.encoder().encodeForHTML() or similar before including it in the response. Never use user input directly as a format string. Consider removing the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00380.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Response Output\n\nUser-controlled input from request parameter 'BenchmarkTest00380' flows through a switch statement. The switch target is guess.charAt(2) which equals 'C', so case 'C' executes and assigns param to bar. This tainted data is then printed directly to the response without sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input using ESAPI.encoder().encodeForHTML() or similar before including it in the response. Consider removing the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00382.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser input from request parameter 'BenchmarkTest00382' flows into a format string used in printf(). After list operations (add 'safe', add param, add 'moresafe', remove index 0), the list becomes [param, 'moresafe']. The code retrieves index 0 which contains the user input, then uses it as the format string in response.getWriter().printf(bar, obj). This allows an attacker to inject format specifiers and arbitrary content into the HTTP response.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: Never use user input as a format string. Use a constant format string and pass user data as arguments: response.getWriter().printf(\"User input: %s\", bar). Additionally, HTML-encode user input before including it in HTML responses.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00383.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser input from request parameter 'BenchmarkTest00383' is propagated through a chain of operations and passed to ThingFactory.createThing().doSomething(), which is a pass-through that returns the input unchanged. The tainted value is then used as the format string in response.getWriter().printf(bar, obj). This allows an attacker to control the format string and inject arbitrary content.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: Never use user input as a format string. Use a constant format string and pass user data as arguments: response.getWriter().printf(\"User input: %s\", bar). Additionally, HTML-encode user input before including it in HTML responses.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00384.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser input from request parameter 'BenchmarkTest00384' is passed to ThingFactory.createThing().doSomething(), which is a pass-through that returns the input unchanged. The tainted value is then used as the format string in response.getWriter().printf(bar, obj). This allows an attacker to control the format string and inject arbitrary content.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: Never use user input as a format string. Use a constant format string and pass user data as arguments: response.getWriter().printf(\"User input: %s\", bar). Additionally, HTML-encode user input before including it in HTML responses.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00385.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Unencoded User Input in HTTP Response\n\nUser input from request parameter 'BenchmarkTest00385' is propagated through a chain of operations and passed to ThingFactory.createThing().doSomething(), which returns the input unchanged. The tainted value is placed in an Object array and output via printf() with X-XSS-Protection disabled. Although the format string is constant, the user-controlled data in the arguments array is rendered without HTML encoding.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode all user input before including it in HTTP responses. Use ESAPI.encoder().encodeForHTML(bar) or similar encoding functions before outputting user data.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00387.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Unencoded User Input in HTTP Response\n\nUser input from request parameter 'BenchmarkTest00387' flows into the HTTP response without encoding. The ternary expression evaluates (7*42)-106 = 188, and 188 > 200 is false, so bar is assigned the user parameter. The tainted value is then output via response.getWriter().println(bar.toCharArray()) with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode all user input before including it in HTTP responses. Use ESAPI.encoder().encodeForHTML(bar) or similar encoding functions before outputting user data.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00388.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Unencoded User Input in HTTP Response\n\nUser input from request parameter 'BenchmarkTest00388' is appended with '_SafeStuff' but remains tainted. The value is output via response.getWriter().println(bar.toCharArray()) with X-XSS-Protection disabled, allowing script injection.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode all user input before including it in HTTP responses. Use ESAPI.encoder().encodeForHTML(bar) or similar encoding functions before outputting user data.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00390.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Unencoded User Input in HTTP Response\n\nUser input from request parameter 'BenchmarkTest00390' is Base64 encoded and then decoded, which is a pass-through operation that returns the original user input unchanged. The tainted value is output via response.getWriter().println(bar) with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode all user input before including it in HTTP responses. Use ESAPI.encoder().encodeForHTML(bar) or similar encoding functions before outputting user data.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00392.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input\n\nUser-controlled input from request parameter 'BenchmarkTest00392' is written directly to the HTTP response without proper sanitization. The code only replaces the last character with 'Z', which does not prevent XSS attacks. The X-XSS-Protection header is explicitly disabled, and the user input is written to the response output.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00395.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Split User Input\n\nUser-controlled input from request parameter 'BenchmarkTest00395' is split on spaces and the first element is written directly to the HTTP response without sanitization. The X-XSS-Protection header is explicitly disabled. Splitting on spaces does not prevent XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code (without spaces) that will be executed in the victim's browser, leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00397.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe code uses java.util.Random().nextBytes() to generate a 'rememberMe' cookie value for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the generated rememberMe token values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive random values: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00398.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the generated rememberMe token values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive random values: new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00399.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the generated rememberMe token values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive random values: new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00400.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the generated rememberMe token values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive random values: new java.security.SecureRandom().nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00424.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled input from request.getParameter() is stored directly into the HTTP session via putValue() without validation. Base64 encoding/decoding does not sanitize or validate the data - it merely transforms it. The user input crosses the trust boundary from untrusted (HTTP request) to trusted (session storage).\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the application later retrieves and uses this data assuming it is trusted.\n\nFix: Validate and sanitize user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. Consider using a separate validation layer that checks the data against business rules before session storage.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00425.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled input from request.getParameter() is stored directly into the HTTP session via putValue() without validation. Appending '_SafeStuff' does not sanitize the user input - the malicious payload is still present at the beginning of the string.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the application later retrieves and uses this data assuming it is trusted.\n\nFix: Validate and sanitize user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. Do not rely on appending safe content as a security measure.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00426.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input as Session Key Name\n\nUser-controlled input is used as the session attribute key name. The ternary condition evaluates to: (294) - 106 = 188, and 188 > 200 is FALSE, so bar = param. The user input controls the session key name, allowing an attacker to manipulate session storage structure.\n\nImpact: An attacker can control session key names, potentially overwriting critical session attributes, causing denial of service, or manipulating application state by controlling which session keys are set.\n\nFix: Never use user input as session attribute key names. Use predefined, hardcoded key names for session attributes. If dynamic keys are needed, use a whitelist or mapping approach.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00427.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled input from request.getParameter() flows through multiple transformations (StringBuilder, HashMap, Base64, split, ThingFactory.doSomething) and is stored in the HTTP session via setAttribute(). ThingFactory.createThing().doSomething() is a pass-through that returns its input unchanged. None of these transformations validate or sanitize the user input.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the application later retrieves and uses this data assuming it is trusted.\n\nFix: Validate and sanitize user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. Do not rely on data transformations as security measures.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00442.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection\n\nThe ternary condition evaluates to: (294) - 106 > 200 \u2192 188 > 200 \u2192 FALSE, so bar is assigned param (user input from request.getParameter()). This tainted value is then concatenated directly into an XPath expression without sanitization.\n\nImpact: An attacker can manipulate the XPath query to extract unauthorized data from the XML document, bypass authentication checks, or access sensitive information.\n\nFix: Use XPath parameterized queries or sanitize input by validating/escaping single quotes before concatenation. Better yet, use XPath variable binding if supported by the implementation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00445.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and considered insecure. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force or known cryptanalytic attacks, exposing sensitive information such as passwords.\n\nFix: Replace DES with AES-256 or AES-128 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00446.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and considered insecure. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force or known cryptanalytic attacks, exposing sensitive information such as passwords.\n\nFix: Replace DES with AES-256 or AES-128 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00448.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm from Configuration\n\nThe code loads the encryption algorithm from a properties file with a default fallback to 'DESede/ECB/PKCS5Padding' (Triple DES in ECB mode). Both DESede (3DES) and ECB mode are cryptographically weak. 3DES is deprecated and ECB mode does not provide semantic security.\n\nImpact: Encrypted data can be vulnerable to cryptanalytic attacks. ECB mode reveals patterns in plaintext, and 3DES has known weaknesses and performance issues.\n\nFix: Use AES with GCM or CBC mode: 'AES/GCM/NoPadding' or 'AES/CBC/PKCS5Padding'. Update the properties file and remove weak algorithm options.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00449.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm from Configuration\n\nThe code loads the encryption algorithm from a properties file with a default fallback to 'DESede/ECB/PKCS5Padding' (Triple DES in ECB mode). Both DESede (3DES) and ECB mode are cryptographically weak. 3DES is deprecated and ECB mode does not provide semantic security.\n\nImpact: Encrypted data can be vulnerable to cryptanalytic attacks. ECB mode reveals patterns in plaintext, and 3DES has known weaknesses and performance issues.\n\nFix: Use AES with GCM or CBC mode: 'AES/GCM/NoPadding' or 'AES/CBC/PKCS5Padding'. Update the properties file and remove weak algorithm options.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00452.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest00452' flows directly into a file path after only Base64 encode/decode (which is not sanitization). An attacker can supply '../../../etc/passwd' or similar path traversal sequences to access files outside the intended directory.\n\nImpact: An attacker can read arbitrary files on the filesystem that the application has access to, potentially exposing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate that the file path does not contain path traversal sequences like '../'. Use Path.normalize() and verify the resolved path starts with the expected base directory. Consider using a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00453.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path in URI Constructor\n\nUser input from request parameter 'BenchmarkTest00453' flows into a file URI path after only Base64 encode/decode. An attacker can supply path traversal sequences to access files outside the intended directory.\n\nImpact: An attacker can read arbitrary files on the filesystem that the application has access to, potentially exposing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate that the file path does not contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00455.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest00455' flows directly into a FileInputStream path after only Base64 encode/decode. An attacker can supply path traversal sequences to read arbitrary files.\n\nImpact: An attacker can read arbitrary files on the filesystem that the application has access to, potentially exposing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate that the file path does not contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00456.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest00456' is stored in a HashMap and then retrieved to construct a file path. The HashMap operations do not sanitize the input, so path traversal sequences can still be used to access arbitrary files.\n\nImpact: An attacker can read arbitrary files on the filesystem that the application has access to, potentially exposing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate that the file path does not contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00457.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest00457' is added to a list, and after removing the first element, the user input becomes the first element (index 0). This tainted value flows into a FileOutputStream path, allowing path traversal attacks.\n\nImpact: An attacker can write to arbitrary files on the filesystem that the application has access to, potentially overwriting critical system files or application configuration.\n\nFix: Validate that the file path does not contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00459.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest00459' flows directly into a FileOutputStream path after only Base64 encode/decode. An attacker can supply path traversal sequences to write to arbitrary files.\n\nImpact: An attacker can write to arbitrary files on the filesystem that the application has access to, potentially overwriting critical system files or application configuration.\n\nFix: Validate that the file path does not contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00461.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (Math.random)\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' session token. Math.random() is not cryptographically secure and produces predictable values that can be guessed by attackers. The generated token is used for authentication purposes (remember me functionality), making this a critical security issue.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users without knowing their credentials.\n\nFix: Replace Math.random() with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00467.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS)\n\nUser-controlled input from request parameter 'BenchmarkTest00467' flows through a HashMap and is output directly to the HTTP response via format() without proper encoding. The X-XSS-Protection header is explicitly disabled, and the user input is not sanitized before output.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding. Do not disable X-XSS-Protection. Consider using Content Security Policy headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00469.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS)\n\nUser-controlled input from request parameter 'BenchmarkTest00469' can flow to the HTTP response via format() when the ternary condition evaluates to false. The condition (7*18)+106 > 200 evaluates to 232 > 200 which is true, so bar is assigned the constant 'This_should_always_happen'. However, the X-XSS-Protection header is disabled. While the current data flow is safe, the pattern is dangerous.\n\nImpact: If the code logic changes or the condition is modified, user input could be output without encoding, leading to XSS attacks where malicious JavaScript executes in victim browsers.\n\nFix: Always encode user input before output regardless of conditional logic. Use ESAPI.encoder().encodeForHTML() or similar encoding. Do not disable X-XSS-Protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00482.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' security token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00483.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' security token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00484.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' security token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens. Use SecureRandom to generate random bytes and encode them appropriately.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00485.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' security token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: new java.security.SecureRandom().nextInt(99);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00486.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' security token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: new java.security.SecureRandom().nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00487.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' security token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: new java.security.SecureRandom().nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00488.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' security token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: new java.security.SecureRandom().nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00489.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' security token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: new java.security.SecureRandom().nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00490.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' security token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: new java.security.SecureRandom().nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00492.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input\n\nUser input from request parameter 'BenchmarkTest00492' is passed through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and written directly to the HTTP response without sanitization. The X-XSS-Protection header is disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Encode user input before writing to the response using ESAPI.encoder().encodeForHTML() or similar HTML encoding function.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00521.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced in a matter of hours with modern computing power.\n\nImpact: An attacker could decrypt sensitive data encrypted with DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: `Cipher.getInstance(\"AES/GCM/NoPadding\")`. Use a 256-bit key generated with `KeyGenerator.getInstance(\"AES\")` and set key size to 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00522.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced in a matter of hours with modern computing power.\n\nImpact: An attacker could decrypt sensitive data encrypted with DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: `Cipher.getInstance(\"AES/GCM/NoPadding\")`. Use a 256-bit key generated with `KeyGenerator.getInstance(\"AES\")` and set key size to 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00525.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter name flows into a file path without validation. After list mutations (add safe, add param, add moresafe, remove index 0), the list becomes [param, moresafe]. valuesList.get(0) retrieves param (user input), which is then used to construct a file path. An attacker can use path traversal sequences like '../../../etc/passwd' to access arbitrary files.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the parameter name to include path traversal sequences, potentially accessing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, check for path traversal sequences (../, ..), and use canonical path validation: `File file = new File(baseDir, userInput); if (!file.getCanonicalPath().startsWith(baseDir.getCanonicalPath())) { throw new SecurityException(); }`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00526.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter name (param) is used directly as the parent directory path in File constructor without any validation. An attacker can provide path traversal sequences to access arbitrary directories on the filesystem.\n\nImpact: An attacker can access files in arbitrary directories by manipulating the parameter name to include path traversal sequences, potentially accessing sensitive files outside the intended directory.\n\nFix: Validate and sanitize the directory path. Use canonical path validation to ensure the resolved path stays within the intended base directory: `File file = new File(userInput, \"Test.txt\"); if (!file.getCanonicalPath().startsWith(baseDir.getCanonicalPath())) { throw new SecurityException(); }`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00527.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter name (param) passes through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is used as the parent directory path in File constructor without validation. An attacker can provide path traversal sequences to access arbitrary directories.\n\nImpact: An attacker can access files in arbitrary directories by manipulating the parameter name to include path traversal sequences, potentially accessing sensitive files outside the intended directory.\n\nFix: Validate and sanitize the directory path. Use canonical path validation to ensure the resolved path stays within the intended base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00528.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter name (param) is stored in a HashMap and retrieved, then used to construct a file URI without validation. The user input flows into the file path construction, allowing path traversal attacks.\n\nImpact: An attacker can access arbitrary files on the filesystem by manipulating the parameter name to include path traversal sequences in the URI construction, potentially accessing sensitive files.\n\nFix: Validate and sanitize the file path before constructing the URI. Use canonical path validation and whitelist allowed characters/paths.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00529.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter name (param) is concatenated directly with a base directory path and used to open a FileInputStream without validation. An attacker can use path traversal sequences like '../../../etc/passwd' to read arbitrary files.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the parameter name to include path traversal sequences, potentially accessing sensitive configuration files, credentials, source code, or other confidential data.\n\nFix: Validate and sanitize the file path. Use canonical path validation: `File file = new File(baseDir, userInput); if (!file.getCanonicalPath().startsWith(baseDir.getCanonicalPath())) { throw new SecurityException(); }`. Also check for path traversal sequences (../, ..).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00530.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection Vulnerability\n\nThe code constructs an LDAP filter by concatenating user input (bar, which derives from 'bob' constant due to switch case 'B') into the filter string. While in this specific case the switch statement assigns the constant 'bob' to bar (making it safe), the pattern is dangerous. However, analyzing the data flow: guess.charAt(1) = 'B', so case 'B' executes, assigning bar = 'bob' (a constant). Therefore, the LDAP query receives a safe constant value, not user input.\n\nImpact: In the current code flow, there is no actual vulnerability because bar receives the constant 'bob'. However, the code pattern is dangerous and could become vulnerable if the logic changes.\n\nFix: Use parameterized LDAP queries or properly escape LDAP special characters using ESAPI: `ESAPI.encoder().encodeForLDAP(bar)`. This prevents injection even if the data flow changes in the future.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00541.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled parameter name flows into response.getWriter().format() without sanitization. The parameter name is extracted from request.getParameterNames() when the parameter value equals 'BenchmarkTest00541', then Base64 encoded/decoded (which does not sanitize), and written to the HTTP response with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript by crafting a parameter name containing XSS payloads, leading to execution of arbitrary JavaScript in victim browsers.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Alternatively, use a templating engine with auto-escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00542.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled parameter name flows into response.getWriter().format() without sanitization. The code uses a deterministic switch statement where guess.charAt(2) evaluates to 'C', causing case 'C' to execute and assign the tainted param to bar. The value is then written to the HTTP response with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript by crafting a parameter name containing XSS payloads, leading to execution of arbitrary JavaScript in victim browsers.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Alternatively, use a templating engine with auto-escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00543.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled parameter name flows into response.getWriter().format() without sanitization. The code adds param to a list, removes the first element, then retrieves index 0 which contains the tainted param value. The value is then written to the HTTP response with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript by crafting a parameter name containing XSS payloads, leading to execution of arbitrary JavaScript in victim browsers.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Alternatively, use a templating engine with auto-escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00547.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Printf\n\nUser-controlled parameter name flows into response.getWriter().printf() without sanitization. The parameter name is extracted from request.getParameterNames(), split on space (still tainted), and written to the HTTP response with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript by crafting a parameter name containing XSS payloads, leading to execution of arbitrary JavaScript in victim browsers.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Alternatively, use a templating engine with auto-escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00549.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Println\n\nUser-controlled parameter name flows into response.getWriter().println() without sanitization. The ternary condition (7*42)-106 > 200 evaluates to false (188 > 200 is false), causing bar to be assigned the tainted param value. The value is then written to the HTTP response with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript by crafting a parameter name containing XSS payloads, leading to execution of arbitrary JavaScript in victim browsers.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Alternatively, use a templating engine with auto-escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00551.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Parameter Name\n\nUser-controlled parameter name is directly written to HTTP response without sanitization. The code iterates through request parameter names and assigns the parameter name (not value) to 'param' when a parameter value equals 'BenchmarkTest00551'. This parameter name is then output directly to the response body with XSS protection disabled.\n\nImpact: An attacker can inject malicious JavaScript by crafting a parameter name containing script tags, leading to XSS attacks that can steal session cookies, perform actions on behalf of users, or deface the page.\n\nFix: HTML-encode the output using a library like OWASP Java Encoder or ESAPI before writing to the response: response.getWriter().println(Encode.forHtml(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00552.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Parameter Name in HashMap Flow\n\nUser-controlled parameter name flows through a HashMap and is written to HTTP response without sanitization. The parameter name is stored in a HashMap under key 'keyB-63597' and then retrieved and output to the response with XSS protection disabled.\n\nImpact: An attacker can inject malicious JavaScript through the parameter name, leading to XSS attacks that can compromise user sessions, steal sensitive data, or perform unauthorized actions.\n\nFix: HTML-encode the output before writing to the response: response.getWriter().println(Encode.forHtml(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00554.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Parameter Name with Conditional Assignment\n\nUser-controlled parameter name is assigned to 'bar' through a conditional that always evaluates to true ((500/42) + 196 = 207 > 200), then output to HTTP response without sanitization. XSS protection is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript through the parameter name, enabling XSS attacks that can steal credentials, hijack sessions, or perform malicious actions on behalf of users.\n\nFix: HTML-encode the output before writing to the response: response.getWriter().println(Encode.forHtml(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00555.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Parameter Name with Ternary Assignment\n\nUser-controlled parameter name is assigned to 'bar' through a ternary expression that evaluates to false ((7*42) - 106 = 188 is not > 200), selecting the param value. This is then written to HTTP response without sanitization with XSS protection disabled.\n\nImpact: An attacker can inject malicious JavaScript through the parameter name, leading to XSS attacks that can compromise user accounts, steal sensitive information, or deface the application.\n\nFix: HTML-encode the output before writing to the response: response.getWriter().write(Encode.forHtml(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00557.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Parameter Name with Split Operation\n\nUser-controlled parameter name is split on space and the first token is written to HTTP response without sanitization. Even though split() is applied, the result is still user-controlled data. XSS protection is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript through the parameter name, enabling XSS attacks that can steal session tokens, perform unauthorized actions, or compromise user data.\n\nFix: HTML-encode the output before writing to the response: response.getWriter().write(Encode.forHtml(bar), 0, length);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00560.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Token\n\nThe code uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is a pseudo-random number generator that is not cryptographically secure and can be predicted by attackers who observe previous outputs or know the seed.\n\nImpact: An attacker can predict the rememberMe token values, allowing them to forge authentication cookies and hijack user sessions without knowing credentials.\n\nFix: Use java.security.SecureRandom instead: double value = new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00561.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Session Token\n\nThe application uses java.util.Random to generate a session token (rememberMe cookie value). java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict session tokens and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating session tokens: SecureRandom secureRandom = new SecureRandom(); float rand = secureRandom.nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00562.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Session Token\n\nThe application uses java.util.Random to generate a session token (rememberMe cookie value). java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict session tokens and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating session tokens: SecureRandom secureRandom = new SecureRandom(); float rand = secureRandom.nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00563.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Session Token\n\nThe application uses java.util.Random to generate a session token (rememberMe cookie value). java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict session tokens and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating session tokens: SecureRandom secureRandom = new SecureRandom(); int r = secureRandom.nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00564.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Session Token\n\nThe application uses java.util.Random to generate a session token (rememberMe cookie value). java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict session tokens and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating session tokens: SecureRandom secureRandom = new SecureRandom(); long l = secureRandom.nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00586.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled data from request.getParameterNames() flows through a HashMap and is used as the session attribute key name in request.getSession().putValue(bar, \"10340\"). Although the code retrieves from 'keyA-58886' (which contains 'a_Value'), the data flow shows: map58886.put('keyA-58886', 'a_Value') then bar = map58886.get('keyA-58886') returns 'a_Value' (safe constant). The final value of bar is the safe constant 'a_Value', not user input.\n\nImpact: An attacker cannot exploit this because bar contains a safe constant at the sink.\n\nFix: The current implementation is secure - bar contains 'a_Value' at the putValue call. No fix needed for this specific data flow.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00587.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled data from request.getParameterNames() is stored in a HashMap under 'keyB-44465', then retrieved and used as the session attribute key name. The code flow: param (user input) \u2192 map44465.put('keyB-44465', param) \u2192 bar = map44465.get('keyB-44465') \u2192 request.getSession().setAttribute(bar, '10340'). The user controls the session key name, allowing them to overwrite arbitrary session attributes.\n\nImpact: An attacker can control which session attribute is set by manipulating the parameter name, potentially overwriting security-critical session data or causing session fixation attacks.\n\nFix: Never use user-controlled data as session attribute keys. Use a fixed, application-controlled key name: request.getSession().setAttribute(\"userValue\", \"10340\");",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00588.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled data from request.getParameterNames() is used directly (or with substring manipulation) as the session attribute key name in request.getSession().setAttribute(bar, '10340'). The substring operation does not sanitize the user input - it only removes the last character, leaving the rest of the user-controlled string intact.\n\nImpact: An attacker can control which session attribute is set by manipulating the parameter name, potentially overwriting security-critical session data such as authentication tokens, user roles, or session IDs.\n\nFix: Never use user-controlled data as session attribute keys. Use a fixed, application-controlled key name: request.getSession().setAttribute(\"userValue\", \"10340\");",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00611.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: An attacker could decrypt sensitive data encrypted with DES, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\")",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00614.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: An attacker could decrypt sensitive data encrypted with DES, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\")",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00614.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter flows into a file path without validation. After list manipulation (removing index 0), the user parameter becomes the first element and is used directly in file path construction, allowing an attacker to access arbitrary files using path traversal sequences like '../'.\n\nImpact: An attacker could read, write, or delete arbitrary files on the server filesystem by manipulating the file path, potentially leading to information disclosure, data corruption, or system compromise.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed filenames, canonicalize the path using File.getCanonicalPath(), and verify it stays within the intended directory. Consider using Path.normalize() and checking that the resolved path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00615.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: An attacker could decrypt sensitive data encrypted with DES, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\")",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00616.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES (DESede)\n\nThe code uses 3DES (Triple DES / DESede) as the default encryption algorithm from a properties file. 3DES is deprecated and considered weak due to its small block size (64 bits) which makes it vulnerable to birthday attacks and other cryptographic weaknesses.\n\nImpact: An attacker could potentially decrypt sensitive data encrypted with 3DES, especially with large amounts of data encrypted under the same key, compromising the confidentiality of the encrypted information.\n\nFix: Replace 3DES with a strong encryption algorithm such as AES-256 with GCM mode. Update the default value in benchmark.properties to use \"AES/GCM/NoPadding\" instead of \"DESede/ECB/PKCS5Padding\".",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00617.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES (DESede)\n\nThe code uses 3DES (Triple DES / DESede) as the default encryption algorithm from a properties file. 3DES is deprecated and considered weak due to its small block size (64 bits) which makes it vulnerable to birthday attacks and other cryptographic weaknesses.\n\nImpact: An attacker could potentially decrypt sensitive data encrypted with 3DES, especially with large amounts of data encrypted under the same key, compromising the confidentiality of the encrypted information.\n\nFix: Replace 3DES with a strong encryption algorithm such as AES-256 with GCM mode. Update the default value in benchmark.properties to use \"AES/GCM/NoPadding\" instead of \"DESede/ECB/PKCS5Padding\".",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00619.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from request parameter flows into a file path without validation. After list manipulation (removing index 0), the user parameter becomes the first element and is used directly in file path construction, allowing an attacker to access arbitrary files using path traversal sequences like '../'.\n\nImpact: An attacker could read, write, or delete arbitrary files on the server filesystem by manipulating the file path, potentially leading to information disclosure, data corruption, or system compromise.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed filenames, canonicalize the path using File.getCanonicalPath(), and verify it stays within the intended directory. Consider using Path.normalize() and checking that the resolved path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00623.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Input in File Path\n\nUser-controlled input from request parameter 'BenchmarkTest00623' flows through Base64 encoding/decoding (which is not a sanitizer) and is used directly as the directory path in File constructor. An attacker can supply '../../../etc/passwd' to traverse outside the intended directory.\n\nImpact: An attacker can read or write arbitrary files on the filesystem by manipulating the path parameter with directory traversal sequences (../, etc.), potentially accessing sensitive files or overwriting critical system files.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed paths, canonicalize the path using File.getCanonicalPath(), and verify it starts with the intended base directory. Alternatively, use Path.normalize() and validate against the base path.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00624.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Input in FileOutputStream\n\nUser-controlled input from request parameter 'BenchmarkTest00624' passes through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is concatenated with TESTFILES_DIR to create a file path for FileOutputStream. An attacker can use '../' sequences to traverse outside the intended directory.\n\nImpact: An attacker can write to arbitrary files on the filesystem, potentially overwriting critical system files, configuration files, or creating files in unauthorized locations, leading to code execution or denial of service.\n\nFix: Validate the file path before use. Canonicalize the path and verify it remains within the intended directory. Use Path.normalize() and startsWith() validation, or maintain a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00627.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Input in FileOutputStream\n\nUser-controlled input from request parameter 'BenchmarkTest00627' flows through Base64 encoding/decoding (not a sanitizer) and is concatenated with TESTFILES_DIR to create a file path for FileOutputStream. Directory traversal sequences can be used to access files outside the intended directory.\n\nImpact: An attacker can write to arbitrary files on the filesystem by supplying path traversal sequences, potentially overwriting critical files or creating malicious files in sensitive locations.\n\nFix: Validate and sanitize the file path. Canonicalize the path using File.getCanonicalPath() and verify it starts with the intended base directory. Consider using a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00629.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Input in InputStream\n\nUser-controlled input from request parameter 'BenchmarkTest00629' is assigned to bar when the condition ((500/42) + 196 > 200) evaluates to true. Since (500/42) = 11 (integer division), 11 + 196 = 207, which is > 200, the condition is always true and bar = param. This tainted value is concatenated with TESTFILES_DIR and used to open a file for reading, allowing path traversal attacks.\n\nImpact: An attacker can read arbitrary files on the filesystem by supplying path traversal sequences like '../../../etc/passwd', potentially accessing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate and sanitize the file path. Canonicalize the path and verify it remains within the intended base directory. Use Path.normalize() with startsWith() validation against the base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00630.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via User-Controlled Search Filter\n\nUser-controlled input from request parameter 'BenchmarkTest00630' is assigned to bar when switchTarget = 'C' (from guess.charAt(2) where guess=\"ABC\"). The switch statement's case 'C' assigns param to bar. This tainted value is concatenated directly into an LDAP search filter without sanitization, allowing LDAP injection attacks.\n\nImpact: An attacker can manipulate the LDAP query by injecting special characters like '*', ')', '(', '|', '&' to bypass authentication, retrieve unauthorized data, or modify the query logic to access sensitive directory information.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize the user input before incorporating it into the LDAP filter. Alternatively, use parameterized LDAP queries if supported by your LDAP library, or implement proper input validation to reject special LDAP metacharacters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00641.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm Configuration via Properties File\n\nThe hash algorithm is loaded from a properties file at runtime. The algorithm name is externally configurable, allowing a weak hash algorithm (MD5, SHA-1) to be specified. Even though the default fallback is 'SHA5' (which is invalid and would throw NoSuchAlgorithmException), the primary risk is that the properties file could specify a weak algorithm like 'MD5' or 'SHA-1', making the system vulnerable to collision attacks.\n\nImpact: An attacker who can control the properties file or if the properties file is misconfigured with a weak algorithm, the system would use cryptographically weak hashing (MD5 or SHA-1), making password hashes vulnerable to collision and preimage attacks.\n\nFix: Use a hardcoded strong hash algorithm like SHA-256, SHA-384, or SHA-512. Remove the runtime configuration of the hash algorithm. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of MessageDigest.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00642.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from the request parameter flows into the HTTP response without sanitization. After list manipulation (adding 'safe', param, 'moresafe', then removing index 0), the list becomes [param, 'moresafe']. The code retrieves index 0, which is the user-controlled param value. This tainted data is written directly to the response body with XSS protection explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00643.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from the request parameter is concatenated with safe content but still contains the original tainted data. The resulting string (param + '_SafeStuff') is written directly to the HTTP response body with XSS protection explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00644.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from the request parameter is split on spaces and the first element is extracted. This tainted data is written directly to the HTTP response body with XSS protection explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00645.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from the request parameter is passed through ThingFactory.createThing().doSomething(), which is a pass-through that returns the input unchanged. The tainted data is then used as a format string in printf(), which writes to the HTTP response body with XSS protection explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser. Additionally, using user input as a format string could lead to format string vulnerabilities if the attacker includes format specifiers.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the response. Never use user input as a format string. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00651.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input\n\nUser-controlled input from request parameter 'BenchmarkTest00651' flows through a conditional expression where the condition `(500 / 42) + 196 > 200` evaluates to TRUE (207 > 200), causing `bar` to be assigned the unsanitized user input `param`. This tainted data is then written directly to the HTTP response body. The code explicitly disables XSS protection via `response.setHeader(\"X-XSS-Protection\", \"0\")`, making the application vulnerable to reflected XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, defacement, or redirection to malicious sites.\n\nFix: Apply proper output encoding using ESAPI or similar libraries before writing user input to the response: `response.getWriter().write(ESAPI.encoder().encodeForHTML(bar))`. Remove the X-XSS-Protection header disabling directive.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00656.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input\n\nUser-controlled input from request parameter 'BenchmarkTest00656' flows through a ternary expression where the condition `(7 * 42) - 106 > 200` evaluates to FALSE (188 > 200 is false), causing `bar` to be assigned the unsanitized user input `param`. This tainted data is then concatenated into a string and written directly to the HTTP response body. The code explicitly disables XSS protection via `response.setHeader(\"X-XSS-Protection\", \"0\")`, making the application vulnerable to reflected XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, defacement, or redirection to malicious sites.\n\nFix: Apply proper output encoding using ESAPI or similar libraries before writing user input to the response: `response.getWriter().write(\"Parameter value: \" + ESAPI.encoder().encodeForHTML(bar))`. Remove the X-XSS-Protection header disabling directive.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00684.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken encryption algorithm. DES has a 56-bit key size and is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using modern computing resources, exposing sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV generation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00685.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken encryption algorithm. DES has a 56-bit key size and is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using modern computing resources, exposing sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV generation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00688.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) for encryption, which is a fundamentally broken encryption algorithm. DES has a 56-bit key size and is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using modern computing resources, exposing sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV generation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00691.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This is a known weak encryption algorithm that should not be used for any security-sensitive operations.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques. This compromises the confidentiality of any data protected by this encryption.\n\nFix: Replace DES with AES-256 or AES-128. Use Cipher.getInstance(\"AES/GCM/NoPadding\") for authenticated encryption, or at minimum \"AES/CBC/PKCS5Padding\" with proper IV handling and HMAC for integrity.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00692.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques. This compromises the confidentiality of any data protected by this encryption.\n\nFix: Replace DES with AES-256 or AES-128. Use Cipher.getInstance(\"AES/GCM/NoPadding\") for authenticated encryption, or at minimum \"AES/CBC/PKCS5Padding\" with proper IV handling and HMAC for integrity.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00693.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques. This compromises the confidentiality of any data protected by this encryption.\n\nFix: Replace DES with AES-256 or AES-128. Use Cipher.getInstance(\"AES/GCM/NoPadding\") for authenticated encryption, or at minimum \"AES/CBC/PKCS5Padding\" with proper IV handling and HMAC for integrity.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00694.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection\n\nUser-controlled input from request.getParameterValues(\"BenchmarkTest00694\") flows directly into an LDAP filter string via string concatenation: 'String filter = \"(&(objectclass=person)(uid=\" + bar + \"))\"'. The variable 'bar' is assigned directly from 'param' without any sanitization. An attacker can inject LDAP metacharacters to modify the query logic.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, access unauthorized data, or enumerate directory information. For example, injecting '*' could return all users, or '))(|(uid=*' could alter the query logic entirely.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize the input before constructing the LDAP filter, or use parameterized LDAP queries if supported by your LDAP library. Example: String safeName = ESAPI.encoder().encodeForLDAP(bar); String filter = \"(&(objectclass=person)(uid=\" + safeName + \"))\";",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00695.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection\n\nUser-controlled input from request.getParameterValues(\"BenchmarkTest00695\") is stored in a HashMap and then retrieved into 'bar'. This value flows directly into an LDAP filter string via string concatenation: 'String filter = \"(&(objectclass=person)(uid=\" + bar + \"))\"'. The HashMap operations do not sanitize the data, and 'bar' receives the tainted parameter value from map9400.get(\"keyB-9400\").\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, access unauthorized data, or enumerate directory information. For example, injecting '*' could return all users, or '))(|(uid=*' could alter the query logic entirely.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize the input before constructing the LDAP filter, or use parameterized LDAP queries if supported by your LDAP library. Example: String safeName = ESAPI.encoder().encodeForLDAP(bar); String filter = \"(&(objectclass=person)(uid=\" + safeName + \"))\";",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00696.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request.getParameterValues(\"BenchmarkTest00696\") flows into a file path. The switch statement evaluates 'guess.charAt(2)' which is 'C' (from \"ABC\"), matching case 'C' which assigns 'bar = param'. This tainted value is then used in 'new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar)' without validation, allowing path traversal attacks.\n\nImpact: An attacker can use path traversal sequences like '../../../etc/passwd' to access files outside the intended directory, potentially reading sensitive system files or application configuration files.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the intended base directory. Example: Path basePath = Paths.get(Utils.TESTFILES_DIR).toRealPath(); Path resolvedPath = basePath.resolve(bar).normalize(); if (!resolvedPath.startsWith(basePath)) { throw new SecurityException(\"Invalid path\"); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00697.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request.getParameterValues(\"BenchmarkTest00697\") is Base64 encoded then decoded (which is effectively a pass-through operation) and stored in 'bar'. This value is then used directly in 'new java.io.File(bar)' without validation, allowing path traversal attacks.\n\nImpact: An attacker can provide absolute paths or path traversal sequences like '../../../etc/passwd' to access files outside the intended directory, potentially reading sensitive system files or application configuration files.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the intended base directory. Reject absolute paths and paths containing '..' sequences.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00698.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request.getParameterValues(\"BenchmarkTest00698\") flows through ThingFactory.createThing().doSomething(param), which is a pass-through that returns the input unchanged. The tainted value 'bar' is then used in 'new java.io.File(bar, \"/Test.txt\")' without validation, allowing path traversal attacks.\n\nImpact: An attacker can use path traversal sequences or absolute paths to access files outside the intended directory, potentially reading sensitive system files or application configuration files.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the intended base directory. Reject absolute paths and paths containing '..' sequences.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00700.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request.getParameterValues(\"BenchmarkTest00700\") is Base64 encoded then decoded (which is effectively a pass-through operation) and stored in 'bar'. This value is then concatenated with Utils.TESTFILES_DIR to create a file path: 'fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + bar'. This is used in 'new java.io.FileOutputStream(new java.io.File(fileName))' without validation, allowing path traversal attacks.\n\nImpact: An attacker can use path traversal sequences like '../../../etc/passwd' to write to files outside the intended directory, potentially overwriting sensitive system files or application configuration files, leading to code execution or denial of service.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the intended base directory. Reject paths containing '..' sequences. Example: Path basePath = Paths.get(Utils.TESTFILES_DIR).toRealPath(); Path resolvedPath = basePath.resolve(bar).normalize(); if (!resolvedPath.startsWith(basePath)) { throw new SecurityException(\"Invalid path\"); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00711.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Output\n\nUser input from request parameter 'BenchmarkTest00711' flows through list manipulation and is output to the HTTP response without sanitization. After removing the first element from the list ['safe', param, 'moresafe'], the list becomes [param, 'moresafe']. The code retrieves index 0 which contains the unsanitized user input (param), then outputs it via out.format(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00715.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unsanitized User Input\n\nUser input from request parameter 'BenchmarkTest00715' is split on spaces and the first token is directly printed to the HTTP response without any sanitization. The X-XSS-Protection header is explicitly disabled, making XSS attacks easier.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00719.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser input from request parameter 'BenchmarkTest00719' flows through ThingFactory.createThing().doSomething() (a pass-through method) and is used directly as the format string in response.getWriter().printf(). This allows the attacker to control the format string, which is then rendered in the HTTP response. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code through the format string that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Never use user input as a format string. Use a fixed format string and pass user input as arguments. Apply proper output encoding using ESAPI.encoder().encodeForHTML() before including in the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00720.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser input from request parameter 'BenchmarkTest00720' is assigned to 'bar' through a switch statement. The switch evaluates guess.charAt(2) which equals 'C', causing case 'C' to execute and assign param to bar. This user-controlled value is then used as the format string in response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code through the format string that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Never use user input as a format string. Use a fixed format string and pass user input as arguments. Apply proper output encoding using ESAPI.encoder().encodeForHTML() before including in the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00721.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter in Response Output\n\nUser-controlled input from request parameter 'BenchmarkTest00721' is stored in a list, retrieved after removing the first element, and output directly to the HTTP response via printf(). After the list operations (add 'safe', add param, add 'moresafe', remove index 0), the list becomes [param, 'moresafe'], so get(0) returns the tainted user input. The X-XSS-Protection header is explicitly disabled, and no sanitization is applied before output.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using HtmlUtils.htmlEscape() or a similar context-appropriate encoding function before writing user input to the response. Alternatively, use a templating engine with auto-escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00724.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter in Response Output\n\nUser-controlled input from request parameter 'BenchmarkTest00724' is assigned to 'bar' via a switch statement. The switch evaluates 'ABC'.charAt(2) which is 'C', matching case 'C' that assigns param to bar. This tainted value is then output directly to the HTTP response via println(). The X-XSS-Protection header is explicitly disabled, and no sanitization is applied.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using HtmlUtils.htmlEscape() or a similar context-appropriate encoding function before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00725.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter in Response Output\n\nUser-controlled input from request parameter 'BenchmarkTest00725' flows through a chain of propagators and is passed to ThingFactory.createThing().doSomething(), which is a pass-through method that returns its input unchanged. The tainted value is then output directly to the HTTP response via println(). The X-XSS-Protection header is explicitly disabled, and no sanitization is applied.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using HtmlUtils.htmlEscape() or a similar context-appropriate encoding function before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00727.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter in Response Output\n\nUser-controlled input from request parameter 'BenchmarkTest00727' is assigned to 'bar' after a substring operation that removes the last character. This is still tainted user input that is output directly to the HTTP response via println(). The X-XSS-Protection header is explicitly disabled, and no sanitization is applied.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using HtmlUtils.htmlEscape() or a similar context-appropriate encoding function before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00728.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter in Response Output\n\nUser-controlled input from request parameter 'BenchmarkTest00728' is assigned to 'bar' via a conditional statement. The condition (500/42) + 196 > 200 evaluates to 207 > 200 which is true, so bar is assigned the tainted param value. This is then output directly to the HTTP response via println(). The X-XSS-Protection header is explicitly disabled, and no sanitization is applied.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using HtmlUtils.htmlEscape() or a similar context-appropriate encoding function before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00729.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter in Response Output\n\nUser-controlled input from request parameter 'BenchmarkTest00729' is passed to ThingFactory.createThing().doSomething(), which is a pass-through method that returns its input unchanged. The tainted value is then output directly to the HTTP response via write(). The X-XSS-Protection header is explicitly disabled, and no sanitization is applied.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using HtmlUtils.htmlEscape() or a similar context-appropriate encoding function before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00733.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict the rememberMe cookie values, allowing them to forge authentication cookies and impersonate other users, leading to unauthorized account access.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for all security-sensitive random value generation: 'new java.security.SecureRandom().nextDouble()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00734.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict the rememberMe cookie values, allowing them to forge authentication cookies and impersonate other users, leading to unauthorized account access.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for all security-sensitive random value generation: 'new java.security.SecureRandom().nextDouble()' or similar methods.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00735.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict the rememberMe cookie values, allowing them to forge authentication cookies and impersonate other users, leading to unauthorized account access.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for all security-sensitive random value generation: 'new java.security.SecureRandom().nextLong()'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00737.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input\n\nUser-controlled input from request parameter 'BenchmarkTest00737' flows through multiple propagators (ThingFactory.createThing().doSomething() is a pass-through) and is written directly to the HTTP response without encoding. The X-XSS-Protection header is disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, allowing session theft, credential harvesting, defacement, or malicious redirects.\n\nFix: Encode all user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00754.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest00754' is stored directly into the HttpSession via putValue() without validation. The parameter value flows through a HashMap (map6425.put('keyB-6425', param)) and is then retrieved and stored in the session as 'userid'. HTML encoding does not prevent trust boundary violations.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement strict input validation rules and consider using a whitelist approach for acceptable values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00756.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest00756' is stored directly into the HttpSession via putValue() without proper validation. Although HTML escaping is applied via StringEscapeUtils.escapeHtml(), this does not prevent trust boundary violations - the issue is storing user data in a trusted context (session), not the format.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. HTML encoding is insufficient for trust boundary protection. Implement strict input validation rules and consider using a whitelist approach.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00757.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled data from request parameter 'BenchmarkTest00757' is used as the session attribute key name. The parameter flows through a switch statement where switchTarget = guess.charAt(2) = 'C', which matches case 'C' and assigns bar = param. This allows an attacker to control the session key name.\n\nImpact: An attacker can control session attribute names, potentially overwriting critical session data, causing denial of service, or manipulating application state.\n\nFix: Never use user input as session attribute key names. Use predefined, constant key names for session attributes.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00759.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest00759' is stored directly into the HttpSession via setAttribute() without validation. The parameter value is only modified by substring() which does not sanitize the content, just removes the last character.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement strict input validation rules and consider using a whitelist approach for acceptable values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00779.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance('DES/CBC/PKCS5Padding'). DES is a deprecated and cryptographically weak algorithm with a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using modern computing resources, compromising the confidentiality of encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256. Use Cipher.getInstance('AES/GCM/NoPadding') with a 256-bit key and proper initialization vector management.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00781.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated with KeyGenerator.getInstance(\"AES\") and initialize with a 128-bit authentication tag.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00783.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from the query string is stored in a HashMap and then retrieved to construct a file path without validation. The param value flows through map2299.put(\"keyB-2299\", param) and is retrieved via map2299.get(\"keyB-2299\"), then concatenated directly into a file path used with FileInputStream.\n\nImpact: An attacker can use path traversal sequences (e.g., '../../../etc/passwd') to read arbitrary files on the server filesystem, potentially accessing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate the input to ensure it doesn't contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory, or use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00785.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from the query string is stored in a HashMap and then retrieved to construct a file path without validation. The param value flows through map59480.put(\"keyB-59480\", param) and is retrieved via map59480.get(\"keyB-59480\"), then concatenated directly into a file path used with FileOutputStream.\n\nImpact: An attacker can use path traversal sequences to write to arbitrary files on the server filesystem, potentially overwriting critical system files, configuration files, or creating malicious files in sensitive locations.\n\nFix: Validate the input to ensure it doesn't contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory, or use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00787.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from the query string is Base64 encoded and decoded (which doesn't sanitize path traversal sequences) and then used directly to construct a file path for FileOutputStream without validation.\n\nImpact: An attacker can use path traversal sequences to write to arbitrary files on the server filesystem. Base64 encoding/decoding does not prevent path traversal attacks as '../' sequences remain intact after the transformation.\n\nFix: Validate the input to ensure it doesn't contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory, or use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00788.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from the query string is passed through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and then used directly to construct a file path for FileOutputStream without validation.\n\nImpact: An attacker can use path traversal sequences to write to arbitrary files on the server filesystem, potentially overwriting critical system files or creating malicious files in sensitive locations.\n\nFix: Validate the input to ensure it doesn't contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory, or use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00789.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - SHA-1\n\nThe code uses SHA-1 hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. Collision attacks against SHA-1 are practical and have been demonstrated.\n\nImpact: An attacker can potentially generate collisions, allowing them to create different inputs that produce the same hash value. This undermines the integrity guarantees that hashing is meant to provide, especially for password storage or digital signatures.\n\nFix: Replace SHA-1 with SHA-256 or stronger: MessageDigest.getInstance(\"SHA-256\"). For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00790.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - SHA-1\n\nThe code uses SHA-1 hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. Collision attacks against SHA-1 are practical and have been demonstrated.\n\nImpact: An attacker can potentially generate collisions, allowing them to create different inputs that produce the same hash value. This undermines the integrity guarantees that hashing is meant to provide, especially for password storage or digital signatures.\n\nFix: Replace SHA-1 with SHA-256 or stronger: MessageDigest.getInstance(\"SHA-256\"). For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00794.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm MD5 Used\n\nThe code uses MD5 (MessageDigest.getInstance(\"MD5\")) for hashing. MD5 is cryptographically broken and should not be used for security purposes. It is vulnerable to collision attacks and pre-image attacks.\n\nImpact: An attacker could potentially generate collisions or reverse the hash, compromising the integrity and confidentiality of hashed data. This is especially critical when hashing passwords or sensitive data.\n\nFix: Replace MD5 with a strong cryptographic hash function like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00796.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file at runtime (benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\")). This allows the algorithm to be changed via configuration, potentially allowing a weak algorithm to be specified. The code does not validate that the configured algorithm is cryptographically strong.\n\nImpact: If the properties file is modified to specify a weak algorithm like MD5 or SHA-1, the system would use that weak algorithm for hashing sensitive data, making it vulnerable to cryptographic attacks.\n\nFix: Use a hardcoded strong algorithm (SHA-256 or stronger) or implement validation to ensure only approved strong algorithms can be used. Maintain a whitelist of acceptable algorithms and reject any others.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00797.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file at runtime (benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\")). This allows the algorithm to be changed via configuration, potentially allowing a weak algorithm to be specified. The code does not validate that the configured algorithm is cryptographically strong.\n\nImpact: If the properties file is modified to specify a weak algorithm like MD5 or SHA-1, the system would use that weak algorithm for hashing sensitive data, making it vulnerable to cryptographic attacks.\n\nFix: Use a hardcoded strong algorithm (SHA-256 or stronger) or implement validation to ensure only approved strong algorithms can be used. Maintain a whitelist of acceptable algorithms and reject any others.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00798.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file at runtime (benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\")). This allows the algorithm to be changed via configuration, potentially allowing a weak algorithm to be specified. The code does not validate that the configured algorithm is cryptographically strong. Note: The default fallback 'SHA5' is not a valid algorithm name and would cause a NoSuchAlgorithmException.\n\nImpact: If the properties file is modified to specify a weak algorithm like MD5 or SHA-1, the system would use that weak algorithm for hashing sensitive data, making it vulnerable to cryptographic attacks.\n\nFix: Use a hardcoded strong algorithm (SHA-256 or stronger) or implement validation to ensure only approved strong algorithms can be used. Maintain a whitelist of acceptable algorithms and reject any others.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00800.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from the query string flows into the HTTP response via response.getWriter().format() without proper sanitization. The code explicitly disables XSS protection with response.setHeader(\"X-XSS-Protection\", \"0\"). The data flow is: request.getQueryString() \u2192 param \u2192 bar (via switch case 'C') \u2192 format() output. Since guess.charAt(2) = 'C', the switch executes case 'C' which assigns param to bar.\n\nImpact: An attacker can inject malicious JavaScript code through the query parameter, which will be executed in the victim's browser. This can lead to session hijacking, credential theft, defacement, or malicious redirects.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding before writing user input to the HTTP response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00801.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the query string parameter 'BenchmarkTest00801' is directly used as a format string in response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. The user input flows from request.getQueryString() through manual parsing into 'param', then assigned to 'bar', and finally used as the format string argument.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the user input before including it in the HTTP response using a library like OWASP Java Encoder or ESAPI. Use response.getWriter().print(Encode.forHtml(bar)) instead of format(bar, obj). Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00802.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Direct Output\n\nUser-controlled input from the query string is Base64 encoded and decoded (which does not sanitize XSS), then output directly to the HTTP response via response.getWriter().print(). The X-XSS-Protection header is disabled. Base64 encoding/decoding is not a security control for XSS.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser context.\n\nFix: HTML-encode the output using Encode.forHtml() or similar before writing to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00803.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Direct Output\n\nUser-controlled input from the query string parameter is directly assigned to 'bar' and output to the HTTP response without any sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in the victim's browser.\n\nFix: HTML-encode the user input before output: response.getWriter().print(Encode.forHtml(bar)). Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00804.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Direct Output\n\nUser-controlled input is placed in a StringBuilder and has '_SafeStuff' appended, but the original tainted input remains in the string. This concatenated value is output directly to the HTTP response without sanitization.\n\nImpact: An attacker can inject malicious JavaScript that will be executed in the browser, with the '_SafeStuff' suffix appended.\n\nFix: HTML-encode the output before writing to response. Appending safe content does not sanitize the tainted prefix.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00805.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Direct Output\n\nUser input flows through a complex propagation chain including StringBuilder operations, HashMap storage, Base64 encoding/decoding, string splitting, and ThingFactory.createThing().doSomething() (which is a pass-through). The final tainted value is output to the HTTP response without sanitization.\n\nImpact: An attacker can inject JavaScript code that will execute in the victim's browser.\n\nFix: HTML-encode the output using Encode.forHtml(bar) before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00806.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser input is added to a list ['safe', param, 'moresafe'], then the first element is removed leaving [param, 'moresafe']. The code retrieves index 0 which is the tainted 'param' value, then uses it as a format string in printf(). The X-XSS-Protection header is disabled.\n\nImpact: An attacker can inject malicious JavaScript via format string injection that will execute in the browser.\n\nFix: HTML-encode the user input before output. Track list mutations carefully - after remove(0), index 0 contains the previously-tainted element.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00807.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser input is split on space and the first element is used as a format string in printf(). Splitting does not sanitize XSS - it only extracts a portion of the tainted input. The X-XSS-Protection header is disabled.\n\nImpact: An attacker can inject JavaScript code (without spaces) that will execute in the victim's browser.\n\nFix: HTML-encode the output before using in printf, or use print() with encoded data instead of printf with user-controlled format strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00809.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nThe condition (500/42) + 196 > 200 evaluates to 11 + 196 = 207 > 200, which is true. Therefore, 'bar' is assigned the tainted 'param' value. This tainted value is then used as a format string in printf() without sanitization.\n\nImpact: An attacker can inject malicious JavaScript code via format string injection that will execute in the browser.\n\nFix: HTML-encode user input before output. Do not use user-controlled data as format strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00810.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Direct Output\n\nUser input is placed in a StringBuilder with '_SafeStuff' appended, but the tainted input remains in the resulting string. This value is output to the HTTP response via println() without sanitization.\n\nImpact: An attacker can inject JavaScript code that will execute in the victim's browser.\n\nFix: HTML-encode the output before writing to response: response.getWriter().println(Encode.forHtml(bar)).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00811.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query String Parameter\n\nUser input from the query string parameter 'BenchmarkTest00811' is extracted, decoded, and then written directly to the HTTP response without sanitization. The code uses a switch statement where guess.charAt(2) evaluates to 'C' (from \"ABC\"), which matches case 'C', causing bar to be assigned the user-controlled param value. The response explicitly disables XSS protection with setHeader(\"X-XSS-Protection\", \"0\") and outputs the tainted data via response.getWriter().println(bar.toCharArray()).\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Encode the output using ESAPI.encoder().encodeForHTML() or a similar HTML encoding function before writing to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00817.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value used for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, making the authentication token vulnerable to prediction attacks.\n\nImpact: An attacker can predict the rememberMe token values and forge authentication cookies to impersonate other users without knowing their credentials.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); double value = secureRandom.nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00818.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value used for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, making the authentication token vulnerable to prediction attacks.\n\nImpact: An attacker can predict the rememberMe token values and forge authentication cookies to impersonate other users without knowing their credentials.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); float value = secureRandom.nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00819.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value used for authentication purposes. The ternary condition (7 * 42) - 106 > 200 evaluates to 188 > 200, which is false, so bar is assigned param (user input). However, the weak random vulnerability exists independently in the rememberMeKey generation using java.util.Random, which is not cryptographically secure.\n\nImpact: An attacker can predict the rememberMe token values and forge authentication cookies to impersonate other users without knowing their credentials.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); long l = secureRandom.nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00822.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Reflected User Input\n\nUser-controlled input from the query parameter 'BenchmarkTest00822' flows directly into the HTTP response without sanitization. The condition (500/42)+196 evaluates to 11+196=207, which is greater than 200, so bar is assigned param. The response explicitly disables XSS protection with X-XSS-Protection: 0 and writes the tainted data directly to the response body.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00833.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from the query string parameter 'BenchmarkTest00833' is stored directly into the HTTP session via putValue() without validation. The condition `(500 / 42) + num > 200` evaluates to `(500/42) + 196 = 11 + 196 = 207 > 200`, which is true, so `bar = param` executes, making bar contain user input. This user input is then stored in the session.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks. The session is a trusted boundary that should not contain unvalidated user input.\n\nFix: Validate and sanitize the user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. Consider using a separate data structure for user-provided data that is clearly marked as untrusted.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00834.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from the query string parameter 'BenchmarkTest00834' is Base64 encoded/decoded (which is not sanitization) and then stored directly into the HTTP session via setAttribute(). The Base64 encoding/decoding is merely a transformation that preserves the original data, not a security control.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks. The session is a trusted boundary that should not contain unvalidated user input.\n\nFix: Validate and sanitize the user input before storing it in the session. Base64 encoding is not a security measure. Implement whitelist validation to ensure only expected values are stored.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00836.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from the query string parameter 'BenchmarkTest00836' is split on space and the first element is stored directly into the HTTP session via setAttribute(). The split operation does not sanitize the data; it only extracts a portion of the user input, which remains tainted.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks. The session is a trusted boundary that should not contain unvalidated user input.\n\nFix: Validate and sanitize the user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. String manipulation operations like split() do not remove taint.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00853.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5PADDING\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES through brute-force attacks or known cryptanalytic techniques, compromising confidentiality of the encrypted data.\n\nFix: Replace DES with AES-256 in GCM or CBC mode. Use: Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00855.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES through brute-force attacks or known cryptanalytic techniques, compromising confidentiality of the encrypted data.\n\nFix: Replace DES with AES-256 in GCM or CBC mode. Use: Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00856.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES through brute-force attacks or known cryptanalytic techniques, compromising confidentiality of the encrypted data.\n\nFix: Replace DES with AES-256 in GCM or CBC mode. Use: Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00857.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES through brute-force attacks or known cryptanalytic techniques, compromising confidentiality of the encrypted data.\n\nFix: Replace DES with AES-256 in GCM or CBC mode. Use: Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00859.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES (DESede)\n\nThe code uses 3DES (Triple DES / DESede) encryption algorithm loaded from properties with default value \"DESede/ECB/PKCS5Padding\". 3DES is deprecated and considered weak due to its small 64-bit block size, which makes it vulnerable to birthday attacks and collision attacks when encrypting large amounts of data.\n\nImpact: An attacker can exploit the weak block size of 3DES to perform collision attacks on encrypted data, potentially recovering plaintext or detecting patterns in encrypted communications.\n\nFix: Replace 3DES with AES-256 in GCM or CBC mode. Update the properties file default to \"AES/GCM/NoPadding\" and use a 256-bit AES key.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00863.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from SeparateClassRequest is passed through ThingFactory.createThing().doSomething(), which is a pass-through that returns the input unchanged. The tainted value is then used as the directory path in the File constructor, allowing an attacker to traverse to arbitrary directories using sequences like '../../../etc'.\n\nImpact: An attacker can read, write, or access files outside the intended directory by manipulating the file path, potentially accessing sensitive system files or application configuration.\n\nFix: Validate that the file path does not contain '..' sequences, use canonical path validation with Path.resolve() and startswith() checks, or restrict file access to a whitelist of allowed directories.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00865.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from SeparateClassRequest is added to a list at index 1. After removing index 0, the param value moves to index 0 and is retrieved into bar. This tainted value is then concatenated into a file URI path without validation, allowing path traversal attacks.\n\nImpact: An attacker can access files outside the intended directory by injecting path traversal sequences, potentially reading sensitive files or accessing unauthorized resources.\n\nFix: Validate that bar does not contain '..' or other path traversal sequences before constructing the file URI. Use canonical path validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00866.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from SeparateClassRequest is passed through ThingFactory.createThing().doSomething(), which is a pass-through returning the input unchanged. The tainted value is concatenated with TESTFILES_DIR and used to create a FileOutputStream, allowing path traversal attacks.\n\nImpact: An attacker can write to arbitrary files on the system by injecting path traversal sequences, potentially overwriting critical system files or application configuration.\n\nFix: Validate that bar does not contain '..' sequences, use canonical path validation, or restrict file operations to a whitelist of allowed paths.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00867.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from SeparateClassRequest is added to a list at index 1. After removing index 0, the param value moves to index 0 and is retrieved into bar. This tainted value is concatenated with TESTFILES_DIR and used to open a file input stream without validation, allowing path traversal.\n\nImpact: An attacker can read arbitrary files on the system by injecting path traversal sequences, potentially accessing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate that bar does not contain '..' sequences before constructing the file path. Use canonical path validation with Path.resolve() and startswith() checks to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00880.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Response Output\n\nUser-controlled input from SeparateClassRequest flows through Base64 encoding/decoding (which is not a sanitizer) and is written directly to the HTTP response via response.getWriter().print(bar.toCharArray()). The X-XSS-Protection header is explicitly disabled (set to '0'), confirming XSS vulnerability. Base64 encoding/decoding is a pass-through operation that does not sanitize HTML special characters.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, defacement, or other client-side attacks.\n\nFix: Apply proper output encoding before writing user input to the response. Use ESAPI.encoder().encodeForHTML() or similar HTML encoding functions to neutralize special characters. Remove or properly configure the X-XSS-Protection header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00898.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Token\n\nThe code uses java.util.Random().nextBytes() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00899.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Token\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: double value = new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00900.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Token\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: double stuff = new java.security.SecureRandom().nextGaussian();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00922.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from request parameter is used as the session attribute key name. The code uses a switch statement where switchTarget is 'B' (from guess.charAt(1) where guess='ABC'), which assigns bar='bob'. However, the switch cases 'A', 'C', and 'D' would assign param to bar. Since switchTarget='B', bar='bob' (safe constant). But the pattern is dangerous - if the switch logic were different, user input would control the session key name.\n\nImpact: An attacker could potentially manipulate session attribute names, leading to session pollution or overwriting critical session data.\n\nFix: Never use user input as session attribute keys. Use fixed, application-defined key names only.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00923.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from request parameter is HTML-escaped and then stored directly in the HTTP session. HTML escaping does NOT prevent trust boundary violations - the issue is storing unvalidated user data in a trusted context (session), not the format. The param flows through HtmlUtils.htmlEscape() to bar, which is then stored in session.\n\nImpact: Storing unvalidated user input in session can lead to session pollution, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing in session. Implement strict input validation rules and consider using a whitelist approach.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00945.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm Configuration from Properties File\n\nThe cipher algorithm is loaded from a properties file with a default fallback to 'DESede/ECB/PKCS5Padding' (Triple DES). DESede (3DES) is a weak encryption algorithm that is deprecated and should not be used for encrypting sensitive data. The algorithm is determined at runtime from an external configuration source.\n\nImpact: An attacker who can cryptanalyze the encrypted data may be able to recover the plaintext due to the weak encryption algorithm. 3DES has known vulnerabilities including a 64-bit block size that makes it susceptible to birthday attacks.\n\nFix: Use a strong, modern encryption algorithm such as AES-256 with GCM mode. Replace 'DESede/ECB/PKCS5Padding' with 'AES/GCM/NoPadding' and ensure the properties file cannot specify weak algorithms.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00946.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm Configuration from Properties File\n\nThe cipher algorithm is loaded from a properties file with a default fallback to 'DESede/ECB/PKCS5Padding' (Triple DES). DESede (3DES) is a weak encryption algorithm that is deprecated and should not be used for encrypting sensitive data. The algorithm is determined at runtime from an external configuration source.\n\nImpact: An attacker who can cryptanalyze the encrypted data may be able to recover the plaintext due to the weak encryption algorithm. 3DES has known vulnerabilities including a 64-bit block size that makes it susceptible to birthday attacks.\n\nFix: Use a strong, modern encryption algorithm such as AES-256 with GCM mode. Replace 'DESede/ECB/PKCS5Padding' with 'AES/GCM/NoPadding' and ensure the properties file cannot specify weak algorithms.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00949.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Unsanitized User Input in File Path\n\nUser-controlled input from a cookie is used directly as a filename parameter in File constructor without validation. The code 'new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar)' allows an attacker to supply path traversal sequences like '../../../etc/passwd' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check the existence of arbitrary files on the filesystem by using path traversal sequences, potentially accessing sensitive system files or application configuration files.\n\nFix: Validate the filename parameter to ensure it does not contain path traversal sequences like '../' or absolute paths. Use a whitelist of allowed characters, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00950.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Unsanitized User Input in File Path\n\nUser-controlled input from a cookie is used directly as the directory parameter in File constructor without validation. The code 'new java.io.File(bar, \"/Test.txt\")' allows an attacker to supply an arbitrary directory path, potentially accessing files outside the intended directory structure.\n\nImpact: An attacker can specify arbitrary directory paths to check file existence or access files in unintended locations by controlling the base directory of the File object.\n\nFix: Validate the directory parameter to ensure it does not contain path traversal sequences or absolute paths. Use a whitelist of allowed directories, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00952.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie Input in File URI Construction\n\nUser-controlled cookie input flows into file path construction. The code uses `guess.charAt(2)` which evaluates to 'C' (from \"ABC\"), and the switch statement's case 'C' assigns `param` (user-controlled cookie value) to `bar`. This tainted value is then used in file URI construction without validation, allowing path traversal attacks like '../../../etc/passwd'.\n\nImpact: An attacker can read arbitrary files on the server by manipulating the cookie value to include path traversal sequences, potentially accessing sensitive configuration files, credentials, or other protected data.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed file names, canonicalize the path using File.getCanonicalPath(), and verify it stays within the intended directory. Alternatively, use Path.normalize() and check that the resolved path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00953.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie Input in FileInputStream\n\nUser-controlled cookie input flows into file path construction. After adding ['safe', param, 'moresafe'] to the list and removing index 0, the list becomes [param, 'moresafe']. Getting index 0 returns the tainted `param` value, which is then concatenated with TESTFILES_DIR and used in FileInputStream construction without validation.\n\nImpact: An attacker can read arbitrary files on the server by manipulating the cookie value to include path traversal sequences, potentially accessing sensitive configuration files, credentials, or other protected data.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed file names, canonicalize the path using File.getCanonicalPath(), and verify it stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00956.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie Input in FileInputStream\n\nUser-controlled cookie input flows into file path construction. The condition `(500 / 42) + 196 > 200` evaluates to `11 + 196 = 207 > 200` which is true, so `bar = param` executes. This tainted value is then concatenated with TESTFILES_DIR and used in FileInputStream construction without validation.\n\nImpact: An attacker can read arbitrary files on the server by manipulating the cookie value to include path traversal sequences, potentially accessing sensitive configuration files, credentials, or other protected data.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed file names, canonicalize the path using File.getCanonicalPath(), and verify it stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00959.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Cookie Input\n\nUser-controlled cookie input flows into an LDAP filter without sanitization. The condition `(500 / 42) + 196 > 200` evaluates to true, so `bar = param` executes. This tainted value is then directly concatenated into the LDAP filter string. An attacker can inject LDAP metacharacters to modify the query logic.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, access unauthorized data, or enumerate directory information by injecting special LDAP characters like '*', ')', '(', '|', '&'.\n\nFix: Use ESAPI's encodeForLDAP() method to sanitize the input before constructing the LDAP filter: `String filter = \"(&(objectclass=person))(|(uid=\" + ESAPI.encoder().encodeForLDAP(bar) + \")(street={0}))\";`. Alternatively, use parameterized LDAP queries if supported by your LDAP library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00971.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security-Sensitive Token\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. The token is used for authentication purposes (remember me functionality), making this a security-critical context.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, bypassing authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: `double value = new java.security.SecureRandom().nextDouble();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00972.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security-Sensitive Token\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. The token is used for authentication purposes (remember me functionality), making this a security-critical context.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, bypassing authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: `double value = new java.security.SecureRandom().nextDouble();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00973.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security-Sensitive Token\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. The token is used for authentication purposes (remember me functionality), making this a security-critical context.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, bypassing authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: `double stuff = new java.security.SecureRandom().nextGaussian();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00974.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security-Sensitive Token\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. The token is used for authentication purposes (remember me functionality), making this a security-critical context.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, bypassing authentication mechanisms. The limited range (0-98) makes brute force attacks trivial.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: `int randNumber = new java.security.SecureRandom().nextInt(99);`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00975.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security-Sensitive Token\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. The token is used for authentication purposes (remember me functionality), making this a security-critical context.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, bypassing authentication mechanisms. The limited range (0-98) makes brute force attacks trivial.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: `int randNumber = new java.security.SecureRandom().nextInt(99);`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00976.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security-Sensitive Token\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. The token is used for authentication purposes (remember me functionality), making this a security-critical context.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, bypassing authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: `long l = new java.security.SecureRandom().nextLong();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01015.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force attacks, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01016.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force attacks, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01017.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force attacks, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01018.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force attacks, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01020.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (3DES/DESede)\n\nThe code loads a cryptographic algorithm from a properties file with a default value of 'DESede/ECB/PKCS5Padding' (Triple DES). 3DES is deprecated and considered weak due to its small block size (64 bits) which makes it vulnerable to birthday attacks. Additionally, ECB mode is insecure as it doesn't provide semantic security.\n\nImpact: Encrypted data can be compromised through cryptanalytic attacks. ECB mode reveals patterns in plaintext, and 3DES is vulnerable to sweet32 attacks.\n\nFix: Replace 3DES with AES-256 in GCM mode. Change the default algorithm to 'AES/GCM/NoPadding' and update the properties file accordingly.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01023.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input\n\nUser-controlled input from request header 'BenchmarkTest01023' flows through a ternary condition that evaluates to false ((7*42)-106 = 188, which is NOT > 200), causing 'param' to be assigned to 'bar'. This tainted value is then directly concatenated into an LDAP filter string without sanitization: 'String filter = \"(&(objectclass=person))(|(uid=\" + bar + \")(street={0}))\"'. An attacker can inject malicious LDAP syntax to manipulate the query logic.\n\nImpact: An attacker can bypass authentication, access unauthorized data, or modify LDAP directory contents by injecting special LDAP characters like parentheses, asterisks, or pipe symbols.\n\nFix: Use parameterized LDAP queries or sanitize user input by escaping special LDAP characters. Consider using ESAPI.encoder().encodeForLDAP() to properly escape the input before concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01025.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser-controlled input from request header 'BenchmarkTest01025' is passed through ThingFactory.createThing().doSomething(), which is a pass-through that returns the input unchanged. The tainted value 'bar' is then used directly in file path construction: 'new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar)'. An attacker can use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check the existence of arbitrary files on the server filesystem by manipulating the file path with directory traversal sequences.\n\nFix: Validate that the resolved file path stays within the intended directory. Use canonical path validation: resolve the full path and verify it starts with the base directory path. Reject inputs containing '../' or '..' sequences.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01029.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser-controlled input from request header 'BenchmarkTest01029' is passed through ThingFactory.createThing().doSomething(), which is a pass-through that returns the input unchanged. The tainted value 'bar' is then used directly in URI construction for file access: 'new java.net.URI(\"file\", null, startURIslashes + ... + bar, null, null)'. An attacker can use path traversal sequences to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check the existence of arbitrary files on the server filesystem by manipulating the file path with directory traversal sequences.\n\nFix: Validate that the resolved file path stays within the intended directory. Use canonical path validation: resolve the full path and verify it starts with the base directory path. Reject inputs containing '../' or '..' sequences.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01032.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the HTTP header 'BenchmarkTest01032' flows directly into a file path without validation. The condition `(500/42) + 196 > 200` evaluates to true (207 > 200), causing `bar` to be assigned the user-controlled `param`. This value is then concatenated with TESTFILES_DIR and used to create a FileOutputStream, allowing an attacker to write to arbitrary files using path traversal sequences like '../../../etc/passwd'.\n\nImpact: An attacker can write to arbitrary files on the server filesystem, potentially overwriting critical system files, configuration files, or application code, leading to system compromise, data corruption, or denial of service.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01033.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the HTTP header 'BenchmarkTest01033' is passed through ThingFactory.createThing().doSomething(), which is a pass-through method that returns the input unchanged. The tainted value flows into `bar` and is concatenated with TESTFILES_DIR to construct a file path for FileOutputStream, allowing path traversal attacks.\n\nImpact: An attacker can write to arbitrary files on the server filesystem using path traversal sequences, potentially overwriting critical files, leading to system compromise or denial of service.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01034.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the HTTP header 'BenchmarkTest01034' is Base64 encoded then decoded, which is effectively a pass-through operation that returns the original input. The tainted value flows into `bar` and is concatenated with TESTFILES_DIR to construct a file path for FileOutputStream, allowing path traversal attacks.\n\nImpact: An attacker can write to arbitrary files on the server filesystem using path traversal sequences, potentially overwriting critical files, leading to system compromise or denial of service.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01038.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm (MD5)\n\nThe code uses MD5 (MessageDigest.getInstance(\"MD5\")) to hash sensitive values before storing them. MD5 is cryptographically broken and vulnerable to collision attacks, making it unsuitable for security-sensitive operations like password hashing or integrity verification.\n\nImpact: An attacker can generate collisions or use rainbow tables to reverse MD5 hashes, potentially compromising stored passwords or bypassing integrity checks. This is especially critical when hashing passwords or other sensitive data.\n\nFix: Replace MD5 with a strong cryptographic hash function. For password hashing, use bcrypt, scrypt, Argon2, or PBKDF2. For general-purpose hashing, use SHA-256, SHA-384, SHA-512, or SHA-3 variants.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01046.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header is stored in a HashMap and retrieved without sanitization, then output directly to the HTTP response via out.format(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by controlling the Referer header.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions. Do not disable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01047.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header is modified (last character replaced with 'Z') but still contains attacker-controlled content, then output directly to the HTTP response via out.format(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by controlling the Referer header.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions. Do not disable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01049.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header is stored in a list, and after removing the first element, the user input is retrieved via get(0) and output directly to the HTTP response via format(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by controlling the Referer header.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions. Do not disable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01050.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header has '_SafeStuff' appended but still contains attacker-controlled content at the beginning, then output directly to the HTTP response via print(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by controlling the Referer header.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions. Do not disable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01055.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header flows through list manipulation and is written directly to the HTTP response without sanitization. After removing the first element from the list ['safe', param, 'moresafe'], get(0) retrieves the user-controlled param value. The X-XSS-Protection header is explicitly disabled, and the tainted data is output via println().\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, leading to XSS attacks that can steal session cookies, perform actions on behalf of users, or deface the page.\n\nFix: Apply HTML encoding using HtmlUtils.htmlEscape() or similar before writing user input to the response. Alternatively, use a Content Security Policy and do not disable X-XSS-Protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01056.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header flows through a ternary condition that evaluates to false ((7*42)-106 = 188, which is not > 200), assigning param to bar. The tainted value is then written directly to the HTTP response via write(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, leading to XSS attacks that can steal session cookies, perform actions on behalf of users, or deface the page.\n\nFix: Apply HTML encoding using HtmlUtils.htmlEscape() or similar before writing user input to the response. Alternatively, use a Content Security Policy and do not disable X-XSS-Protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01057.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header flows through a ternary condition that evaluates to false ((7*42)-106 = 188, which is not > 200), assigning param to bar. The tainted value is then written directly to the HTTP response via write(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, leading to XSS attacks that can steal session cookies, perform actions on behalf of users, or deface the page.\n\nFix: Apply HTML encoding using HtmlUtils.htmlEscape() or similar before writing user input to the response. Alternatively, use a Content Security Policy and do not disable X-XSS-Protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01058.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session token generation.\n\nImpact: An attacker can predict the rememberMe token values, allowing them to forge session cookies and impersonate other users, leading to account takeover.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: SecureRandom secureRandom = new SecureRandom(); secureRandom.nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01059.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session token generation.\n\nImpact: An attacker can predict the rememberMe token values, allowing them to forge session cookies and impersonate other users, leading to account takeover.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: SecureRandom secureRandom = new SecureRandom(); double value = secureRandom.nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01060.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session token generation.\n\nImpact: An attacker can predict the rememberMe token values, allowing them to forge session cookies and impersonate other users, leading to account takeover.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: SecureRandom secureRandom = new SecureRandom(); float rand = secureRandom.nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01063.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header is written directly to the HTTP response without proper sanitization. The code explicitly disables XSS protection with response.setHeader(\"X-XSS-Protection\", \"0\") and writes the tainted 'bar' variable (derived from request.getHeader(\"Referer\")) directly to the response. The ThingFactory.createThing().doSomething() is a pass-through that returns its input unchanged, so the tainted data flows through to the response.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser, potentially leading to session theft, credential harvesting, or other malicious actions.\n\nFix: Encode the output using ESAPI.encoder().encodeForHTML(bar) before writing to the response, or use a templating engine with automatic output encoding.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01080.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from request header 'BenchmarkTest01080' flows through the doSomething() method and is used as the session key name in request.getSession().putValue(bar, \"10340\"). While the data flow analysis shows that after list mutations (add safe, add param, add moresafe, remove index 0), the list becomes [param, moresafe], and valuesList.get(1) retrieves 'moresafe' (a safe constant), making bar safe in the current implementation. However, upon closer inspection of the list operations: valuesList contains [\"safe\", param, \"moresafe\"], then remove(0) removes \"safe\", resulting in [param, \"moresafe\"]. The get(1) retrieves \"moresafe\" which is indeed a constant string literal. Therefore, bar is actually safe and this is NOT a vulnerability in the current code.\n\nImpact: An attacker could control session attribute names, potentially overwriting security-critical session attributes or causing session confusion attacks.\n\nFix: Validate and sanitize user input before using it as session keys. Use a whitelist of allowed key names or prefix user data with a constant string.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01081.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Attribute Key\n\nUser-controlled data from request header 'BenchmarkTest01081' flows through doSomething() (which appends '_SafeStuff' to the input) and is used as the session attribute key in request.getSession().setAttribute(bar, \"10340\"). While the value is appended with a constant, the base of the key name is still user-controlled, allowing attackers to control session attribute names.\n\nImpact: An attacker can control session attribute key names, potentially overwriting critical session data or causing session fixation attacks.\n\nFix: Never use user input to determine session attribute keys. Use a fixed, application-controlled key name instead.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01082.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Attribute Key\n\nUser-controlled data from request header 'BenchmarkTest01082' flows through doSomething() (which performs substring operation) and is used as the session attribute key in request.getSession().setAttribute(bar, \"10340\"). The substring operation does not sanitize the user input for use as a session key.\n\nImpact: An attacker can control session attribute key names, potentially overwriting critical session data or causing session fixation attacks.\n\nFix: Never use user input to determine session attribute keys. Use a fixed, application-controlled key name instead.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01099.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES) in BenchmarkTest01099\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5PADDING\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically weak by modern standards.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and computing power, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256. Use GCMParameterSpec for authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01102.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This makes any data encrypted with DES vulnerable to decryption by attackers.\n\nImpact: An attacker could decrypt sensitive data that was encrypted using DES, compromising confidentiality. The encrypted data stored in passwordFile.txt could be recovered.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key for authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01103.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This makes any data encrypted with DES vulnerable to decryption by attackers.\n\nImpact: An attacker could decrypt sensitive data that was encrypted using DES, compromising confidentiality. The encrypted data stored in passwordFile.txt could be recovered.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key for authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01105.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES/DESede\n\nThe code uses 3DES (Triple DES, also known as DESede) encryption algorithm loaded from a properties file with default value \"DESede/ECB/PKCS5Padding\". 3DES is deprecated and considered weak due to its small 64-bit block size, which makes it vulnerable to birthday attacks and other cryptographic weaknesses. NIST has deprecated 3DES for new applications.\n\nImpact: An attacker could exploit weaknesses in 3DES to decrypt sensitive data, especially with large amounts of encrypted data due to the small block size. The encrypted data stored in passwordFile.txt could be compromised.\n\nFix: Replace 3DES/DESede with AES-256. Update the benchmark.properties file to use \"AES/GCM/NoPadding\" and ensure the code uses AES with a 256-bit key for strong authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01106.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES/DESede\n\nThe code uses 3DES (Triple DES, also known as DESede) encryption algorithm loaded from a properties file with default value \"DESede/ECB/PKCS5Padding\". 3DES is deprecated and considered weak due to its small 64-bit block size, which makes it vulnerable to birthday attacks and other cryptographic weaknesses. NIST has deprecated 3DES for new applications.\n\nImpact: An attacker could exploit weaknesses in 3DES to decrypt sensitive data, especially with large amounts of encrypted data due to the small block size. The encrypted data stored in passwordFile.txt could be compromised.\n\nFix: Replace 3DES/DESede with AES-256. Update the benchmark.properties file to use \"AES/GCM/NoPadding\" and ensure the code uses AES with a 256-bit key for strong authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01107.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES/DESede\n\nThe code uses 3DES (Triple DES, also known as DESede) encryption algorithm loaded from a properties file with default value \"DESede/ECB/PKCS5Padding\". 3DES is deprecated and considered weak due to its small 64-bit block size, which makes it vulnerable to birthday attacks and other cryptographic weaknesses. NIST has deprecated 3DES for new applications.\n\nImpact: An attacker could exploit weaknesses in 3DES to decrypt sensitive data, especially with large amounts of encrypted data due to the small block size. The encrypted data stored in passwordFile.txt could be compromised.\n\nFix: Replace 3DES/DESede with AES-256. Update the benchmark.properties file to use \"AES/GCM/NoPadding\" and ensure the code uses AES with a 256-bit key for strong authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01111.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Header Name\n\nThe application extracts the name of the first non-standard HTTP header and uses it to construct a file path without validation. The condition `(500 / 42) + num > 200` evaluates to `(11 + 196) > 200` = `207 > 200` = true, so `bar = param` executes, making bar tainted. This tainted value flows into `fileName = Utils.TESTFILES_DIR + bar` and is used to open a FileInputStream, allowing an attacker to read arbitrary files via path traversal sequences like '../../../etc/passwd'.\n\nImpact: An attacker can read arbitrary files on the server by sending a custom HTTP header with a name containing path traversal sequences, potentially exposing sensitive configuration files, source code, or credentials.\n\nFix: Validate and sanitize the header name before using it in file operations. Use a whitelist of allowed file names or validate that the resolved path stays within the intended directory using canonical path checking.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01112.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Header Name in Switch Statement\n\nThe application extracts the name of the first non-standard HTTP header and uses it to construct a file path. The switch statement evaluates `guess.charAt(2)` which equals 'C' (from \"ABC\"), matching case 'C' where `bar = param` executes. This tainted value flows into file operations without validation, allowing path traversal attacks.\n\nImpact: An attacker can read arbitrary files on the server by sending a custom HTTP header with a name containing path traversal sequences like '../../../etc/passwd'.\n\nFix: Validate and sanitize the header name before using it in file operations. Implement whitelist validation or canonical path checking to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01116.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Header Name in File Write Operation\n\nThe application extracts the name of the first non-standard HTTP header and uses it to construct a file path for write operations. After list mutations (add 'safe', add param, add 'moresafe', remove index 0), the list becomes [param, 'moresafe']. The code `bar = valuesList.get(0)` retrieves param (tainted). This flows into FileOutputStream operations without validation, allowing path traversal attacks for file creation/modification.\n\nImpact: An attacker can write to or create arbitrary files on the server by sending a custom HTTP header with a name containing path traversal sequences, potentially overwriting critical system files or placing malicious content in web-accessible directories.\n\nFix: Validate and sanitize the header name before using it in file operations. Use whitelist validation and canonical path checking to prevent path traversal attacks.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01117.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Header Name with Base64 Encoding\n\nThe application extracts the name of the first non-standard HTTP header, passes it through Base64 encode/decode (which doesn't sanitize path traversal sequences), and uses it to construct a file path. The Base64 operations preserve the malicious path traversal sequences, allowing an attacker to access arbitrary files.\n\nImpact: An attacker can write to or create arbitrary files on the server by sending a custom HTTP header with a name containing path traversal sequences, potentially overwriting critical system files.\n\nFix: Validate and sanitize the header name before using it in file operations. Base64 encoding/decoding does not prevent path traversal attacks. Implement proper input validation and canonical path checking.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01127.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - nextDouble()\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe cookie values, allowing them to forge authentication cookies and hijack user sessions without knowing credentials.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for security-sensitive random value generation. Example: new java.security.SecureRandom().nextDouble()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01128.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - nextGaussian()\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe cookie values, enabling session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random. Example: new java.security.SecureRandom().nextDouble() or SecureRandom.getInstanceStrong()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01129.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - nextInt(int)\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and the limited range (0-98) makes it even easier to predict or brute force.\n\nImpact: An attacker could easily predict or brute force the rememberMe cookie values (only 99 possible values), allowing trivial session hijacking.\n\nFix: Use java.security.SecureRandom with a larger range. Example: new java.security.SecureRandom().nextInt() or use SecureRandom to generate a proper session token.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01130.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - nextInt()\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe cookie values, enabling session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random. Example: new java.security.SecureRandom().nextInt()",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01131.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. The generated token is used for session management, making this a security-critical context.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge session cookies and impersonate other users, leading to unauthorized access and session hijacking.\n\nFix: Replace java.util.Random with java.security.SecureRandom. Change 'new java.util.Random().nextInt()' to 'java.security.SecureRandom.getInstance(\"SHA1PRNG\").nextInt()' or use SecureRandom.nextBytes() for generating session tokens.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01132.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. The generated token is used for session management, making this a security-critical context.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge session cookies and impersonate other users, leading to unauthorized access and session hijacking.\n\nFix: Replace java.util.Random with java.security.SecureRandom. Change 'new java.util.Random().nextInt()' to 'java.security.SecureRandom.getInstance(\"SHA1PRNG\").nextInt()' or use SecureRandom.nextBytes() for generating session tokens.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01133.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. The generated token is used for session management, making this a security-critical context.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge session cookies and impersonate other users, leading to unauthorized access and session hijacking.\n\nFix: Replace java.util.Random with java.security.SecureRandom. Change 'new java.util.Random().nextLong()' to 'java.security.SecureRandom.getInstance(\"SHA1PRNG\").nextLong()' or use SecureRandom.nextBytes() for generating session tokens.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01142.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Header Name Stored in Session\n\nThe application stores a user-controlled HTTP header name directly into the HttpSession via putValue(). The header name is extracted from request.getHeaderNames() without validation and stored in the session trust boundary. Even though the code has a conditional that evaluates to true (making 'bar' a constant in this specific case), the pattern demonstrates storing user input in session.\n\nImpact: An attacker could manipulate session state by controlling header names, potentially leading to session poisoning, privilege escalation, or application logic bypass.\n\nFix: Validate and sanitize all user input before storing in HttpSession. Use a whitelist of allowed values or implement strict input validation to ensure only safe, expected values are stored in the session.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01143.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Header Name Stored in Session\n\nThe application stores a user-controlled HTTP header name directly into the HttpSession via putValue(). The header name is extracted from request.getHeaderNames(), appended with '_SafeStuff', and stored in the session. Appending a safe string does not sanitize the user-controlled prefix, which remains tainted.\n\nImpact: An attacker could manipulate session state by controlling header names, potentially leading to session poisoning, privilege escalation, or application logic bypass.\n\nFix: Validate and sanitize all user input before storing in HttpSession. Use a whitelist of allowed values or implement strict input validation to ensure only safe, expected values are stored in the session.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01145.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Header Name Stored in Session\n\nThe application stores a user-controlled HTTP header name directly into the HttpSession via setAttribute(). The header name is extracted from request.getHeaderNames() without validation and stored in the session trust boundary. Even though the code has a conditional that evaluates to true (making 'bar' a constant in this specific case), the pattern demonstrates storing user input in session.\n\nImpact: An attacker could manipulate session state by controlling header names, potentially leading to session poisoning, privilege escalation, or application logic bypass.\n\nFix: Validate and sanitize all user input before storing in HttpSession. Use a whitelist of allowed values or implement strict input validation to ensure only safe, expected values are stored in the session.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01148.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe application uses the DES (Data Encryption Standard) algorithm for encryption via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques, leading to complete compromise of data confidentiality.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and ensure proper IV generation with SecureRandom.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01149.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe application uses the DES (Data Encryption Standard) algorithm for encryption via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques, leading to complete compromise of data confidentiality.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and ensure proper IV generation with SecureRandom.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01150.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe application uses the DES (Data Encryption Standard) algorithm for encryption via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques, leading to complete compromise of data confidentiality.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and ensure proper IV generation with SecureRandom.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01155.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Unsanitized User Input in File Access\n\nUser-controlled input from request header 'BenchmarkTest01155' flows through doSomething() method where it is retrieved from a list after removing the first element. The tainted value is then used directly to construct a File object without path validation. An attacker can use '../' sequences to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check existence of arbitrary files on the server filesystem by injecting path traversal sequences like '../../../etc/passwd'.\n\nFix: Validate that the resolved canonical path starts with the expected base directory. Use Path.normalize() and verify the result is within allowed boundaries.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01156.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Unsanitized User Input in URI Construction\n\nUser-controlled input from request header 'BenchmarkTest01156' flows through doSomething() where it is stored in and retrieved from a HashMap. The tainted value is then used to construct a file URI without path validation. An attacker can use '../' sequences to access files outside the intended directory.\n\nImpact: An attacker can read or check existence of arbitrary files on the server filesystem by injecting path traversal sequences.\n\nFix: Validate that the resolved canonical path starts with the expected base directory before constructing the URI.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01157.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Unsanitized User Input in URI Construction\n\nUser-controlled input from request header 'BenchmarkTest01157' flows through doSomething() where a switch statement on 'ABC'.charAt(2) (which is 'C') assigns param to bar in case 'C'. The tainted value is then used to construct a file URI without path validation.\n\nImpact: An attacker can read or check existence of arbitrary files on the server filesystem by injecting path traversal sequences.\n\nFix: Validate that the resolved canonical path starts with the expected base directory before constructing the URI.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01158.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Unsanitized User Input in FileInputStream\n\nUser-controlled input from request header 'BenchmarkTest01158' flows through doSomething() where it is retrieved from a list. After removing the first element, valuesList.get(1) retrieves 'moresafe' (the safe constant), not the tainted param. However, the data flow shows bar is assigned from valuesList.get(1) which after remove(0) becomes the second element 'moresafe'. This is actually SAFE - the code retrieves the safe constant, not user input.\n\nImpact: None - this is a false positive upon careful analysis. The list after remove(0) is [param, 'moresafe'], and get(1) retrieves 'moresafe'.\n\nFix: No fix needed - the code is secure.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01161.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from HTTP header 'BenchmarkTest01161' flows through the doSomething method and is used to construct a file path without validation. The doSomething method stores the param in a list, removes the first element, then retrieves param at index 0, making bar equal to the user input. This allows an attacker to traverse directories using '../' sequences.\n\nImpact: An attacker can read or write arbitrary files on the server filesystem by manipulating the file path, potentially accessing sensitive files or overwriting critical system files.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, check for path traversal sequences ('../'), or use Path.normalize() with startswith() validation against the base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01162.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values.\n\nImpact: An attacker can predict the rememberMe cookie values, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of Math.random() for generating security-sensitive random values: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01163.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values.\n\nImpact: An attacker can predict the rememberMe cookie values, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of Math.random() for generating security-sensitive random values: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01171.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in format() sink\n\nUser-controlled input from the Referer header is URL-decoded and passed through a transformation that replaces the last character with 'Z', but the result still contains attacker-controlled data. This tainted data is then used as a format string in response.getWriter().format() with X-XSS-Protection disabled, allowing an attacker to inject malicious JavaScript that will execute in the victim's browser.\n\nImpact: An attacker can inject arbitrary JavaScript code by manipulating the Referer header, leading to session hijacking, credential theft, defacement, or malicious actions performed on behalf of the victim.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the HTTP response. Additionally, avoid using user input as format strings. Enable X-XSS-Protection header or use Content-Security-Policy.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01172.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in format() sink\n\nUser-controlled input from the Referer header is URL-decoded, stored in a HashMap, and then retrieved. This tainted data is placed in an Object array and used in response.getWriter().format() with X-XSS-Protection disabled, allowing an attacker to inject malicious JavaScript that will execute in the victim's browser.\n\nImpact: An attacker can inject arbitrary JavaScript code by manipulating the Referer header, leading to session hijacking, credential theft, defacement, or malicious actions performed on behalf of the victim.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the HTTP response. Enable X-XSS-Protection header or use Content-Security-Policy.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01173.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in print() sink\n\nUser-controlled input from the Referer header is URL-decoded, added to a List, and after removing the first element, the user input becomes the first element retrieved by get(0). This tainted data is then written directly to the HTTP response using response.getWriter().print() with X-XSS-Protection disabled, allowing an attacker to inject malicious JavaScript.\n\nImpact: An attacker can inject arbitrary JavaScript code by manipulating the Referer header, leading to session hijacking, credential theft, defacement, or malicious actions performed on behalf of the victim.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the HTTP response. Enable X-XSS-Protection header or use Content-Security-Policy.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01174.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in print() sink\n\nUser-controlled input from the Referer header is URL-decoded and passed through substring() which removes only the last character. The result still contains attacker-controlled data which is written directly to the HTTP response using response.getWriter().print() with X-XSS-Protection disabled, allowing an attacker to inject malicious JavaScript.\n\nImpact: An attacker can inject arbitrary JavaScript code by manipulating the Referer header, leading to session hijacking, credential theft, defacement, or malicious actions performed on behalf of the victim.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the HTTP response. Enable X-XSS-Protection header or use Content-Security-Policy.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01177.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in printf() sink\n\nUser-controlled input from the Referer header is URL-decoded and flows through a switch statement. The switch evaluates guess.charAt(2) which equals 'C', causing the case 'C' branch to execute and assign param to bar. This tainted data is then written to the HTTP response using response.getWriter().printf() with X-XSS-Protection disabled, allowing an attacker to inject malicious JavaScript.\n\nImpact: An attacker can inject arbitrary JavaScript code by manipulating the Referer header, leading to session hijacking, credential theft, defacement, or malicious actions performed on behalf of the victim.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the HTTP response. Enable X-XSS-Protection header or use Content-Security-Policy.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01178.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in println() sink\n\nUser-controlled input from the Referer header is URL-decoded and appended with '_SafeStuff' using StringBuilder. The result still contains attacker-controlled data at the beginning which is written to the HTTP response using response.getWriter().println() with X-XSS-Protection disabled, allowing an attacker to inject malicious JavaScript.\n\nImpact: An attacker can inject arbitrary JavaScript code by manipulating the Referer header, leading to session hijacking, credential theft, defacement, or malicious actions performed on behalf of the victim.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the HTTP response. Enable X-XSS-Protection header or use Content-Security-Policy.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01179.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in println() sink\n\nUser-controlled input from the Referer header is URL-decoded and split by space, with the first element assigned to bar. This tainted data is then written directly to the HTTP response using response.getWriter().println() with X-XSS-Protection disabled, allowing an attacker to inject malicious JavaScript.\n\nImpact: An attacker can inject arbitrary JavaScript code by manipulating the Referer header, leading to session hijacking, credential theft, defacement, or malicious actions performed on behalf of the victim.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the HTTP response. Enable X-XSS-Protection header or use Content-Security-Policy.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01181.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header is decoded and passed through Base64 encode/decode (which does not sanitize), then written directly to the HTTP response with XSS protection disabled. The Base64 round-trip does not prevent XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by controlling the Referer header, leading to XSS attacks that can steal session cookies, perform actions on behalf of users, or deface the page.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the response, or remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01183.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker can predict the rememberMe token values, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead: SecureRandom secureRandom = new SecureRandom(); float rand = secureRandom.nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01184.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker can predict the rememberMe token values, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead: SecureRandom secureRandom = new SecureRandom(); double stuff = secureRandom.nextGaussian();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01228.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This is used to encrypt sensitive data (passwords) before storage.\n\nImpact: An attacker who obtains the encrypted data can decrypt it using brute-force attacks or known cryptanalytic techniques, exposing sensitive information such as passwords.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256, and use a unique IV for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01229.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This is used to encrypt sensitive data (passwords) before storage.\n\nImpact: An attacker who obtains the encrypted data can decrypt it using brute-force attacks or known cryptanalytic techniques, exposing sensitive information such as passwords.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256, and use a unique IV for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01230.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (3DES/DESede)\n\nThe code loads the encryption algorithm from a properties file with a default value of \"DESede/ECB/PKCS5Padding\" (Triple DES). 3DES/DESede is considered weak encryption due to its small 64-bit block size, which makes it vulnerable to birthday attacks and other cryptanalytic techniques. Additionally, ECB mode does not provide semantic security.\n\nImpact: An attacker who obtains the encrypted data can exploit the weak block size and ECB mode weaknesses to decrypt sensitive information or detect patterns in the encrypted data.\n\nFix: Replace 3DES with AES-256 in GCM mode. Update the properties file default to \"AES/GCM/NoPadding\" and use a 256-bit AES key with unique IVs for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01231.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest01231' is stored in a HashMap and then retrieved to construct a file path without validation. An attacker can supply path traversal sequences (e.g., '../../../etc/passwd') to access files outside the intended directory.\n\nImpact: An attacker can read, write, or delete arbitrary files on the server filesystem, potentially leading to information disclosure, data corruption, or system compromise.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01232.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest01232' passes through ThingFactory.createThing().doSomething() (a pass-through method) and is used to construct a file path without validation. An attacker can supply path traversal sequences to access files outside the intended directory.\n\nImpact: An attacker can read, write, or delete arbitrary files on the server filesystem, potentially leading to information disclosure, data corruption, or system compromise.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01234.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest01234' passes through ThingFactory.createThing().doSomething() (a pass-through method) and is used to construct a file path without validation. An attacker can supply path traversal sequences to access files outside the intended directory.\n\nImpact: An attacker can read, write, or delete arbitrary files on the server filesystem, potentially leading to information disclosure, data corruption, or system compromise.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01235.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File URI\n\nUser input from request parameter 'BenchmarkTest01235' is stored in a HashMap and then retrieved to construct a file URI without validation. An attacker can supply path traversal sequences to access files outside the intended directory.\n\nImpact: An attacker can read, write, or delete arbitrary files on the server filesystem, potentially leading to information disclosure, data corruption, or system compromise.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01236.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File URI\n\nUser input from request parameter 'BenchmarkTest01236' passes through ThingFactory.createThing().doSomething() (a pass-through method) and is used to construct a file URI without validation. An attacker can supply path traversal sequences to access files outside the intended directory.\n\nImpact: An attacker can read, write, or delete arbitrary files on the server filesystem, potentially leading to information disclosure, data corruption, or system compromise.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01238.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest01238' is added to a list, and after removing the first element, the user input is retrieved at index 0 and used to construct a file path without validation. An attacker can supply path traversal sequences to access files outside the intended directory.\n\nImpact: An attacker can read, write, or delete arbitrary files on the server filesystem, potentially leading to information disclosure, data corruption, or system compromise.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01241.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection in BenchmarkTest01241\n\nUser-controlled input from request parameter 'BenchmarkTest01241' flows through Base64 encoding/decoding (which is not sanitization) and is directly concatenated into an LDAP filter string without proper escaping. The filter construction uses: `String filter = \"(&(objectclass=person))(|(uid=\" + bar + \")(street={0}))\";` where bar contains unsanitized user input.\n\nImpact: An attacker can inject malicious LDAP filter syntax to bypass authentication, access unauthorized data, or modify LDAP queries to return unintended results.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to properly escape user input before including it in LDAP filter strings, or use parameterized LDAP queries if supported by the framework.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01242.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection in BenchmarkTest01242\n\nUser-controlled input from request parameter 'BenchmarkTest01242' flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is directly concatenated into an LDAP filter string without proper escaping. The filter construction uses: `String filter = \"(&(objectclass=person))(|(uid=\" + bar + \")(street={0}))\";` where bar contains unsanitized user input.\n\nImpact: An attacker can inject malicious LDAP filter syntax to bypass authentication, access unauthorized data, or modify LDAP queries to return unintended results.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to properly escape user input before including it in LDAP filter strings, or use parameterized LDAP queries if supported by the framework.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01243.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection in BenchmarkTest01243\n\nUser-controlled input from request parameter 'BenchmarkTest01243' flows through a ternary condition. The condition `(7 * 42) - 106 > 200` evaluates to `294 - 106 = 188 > 200` which is FALSE, so bar is assigned param (user input). This tainted value is then directly concatenated into an LDAP filter string: `String filter = \"(&(objectclass=person)(uid=\" + bar + \"))\";`\n\nImpact: An attacker can inject malicious LDAP filter syntax to bypass authentication, access unauthorized data, or modify LDAP queries to return unintended results.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to properly escape user input before including it in LDAP filter strings, or use parameterized LDAP queries if supported by the framework.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01253.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01253' is stored in a HashMap and then retrieved into variable 'bar'. This tainted data is used as the format string in response.getWriter().format(bar, obj), allowing an attacker to inject malicious JavaScript. The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before outputting user input to the response. Additionally, do not use user input as format strings - use a safe constant format string instead.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01254.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Response Output\n\nUser-controlled input from request parameter 'BenchmarkTest01254' flows through a propagation chain (StringBuilder, HashMap, Base64 encoding, split, and ThingFactory.doSomething() pass-through) and is output to the HTTP response via response.getWriter().print(bar.toCharArray()). The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability. None of the transformations sanitize the input for HTML context.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or StringEscapeUtils.escapeHtml() before outputting user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01257.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Response Output\n\nUser-controlled input from request parameter 'BenchmarkTest01257' is passed through ThingFactory.createThing().doSomething() which is a pass-through method that returns its input unchanged. The tainted data is then output to the HTTP response via response.getWriter().print(bar). The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or StringEscapeUtils.escapeHtml() before outputting user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01258.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Printf Output\n\nUser-controlled input from request parameter 'BenchmarkTest01258' is Base64 encoded and decoded (which does not sanitize HTML special characters) and then output to the HTTP response via response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability. Base64 encoding/decoding is not a security control for XSS.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or StringEscapeUtils.escapeHtml() before outputting user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01259.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Printf Output\n\nUser-controlled input from request parameter 'BenchmarkTest01259' is stored in a HashMap with key 'keyB-26093' and then retrieved into variable 'bar'. This tainted data is output to the HTTP response via response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or StringEscapeUtils.escapeHtml() before outputting user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01260.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Printf Output\n\nUser-controlled input from request parameter 'BenchmarkTest01260' is split on space and the first element is assigned to 'bar'. This tainted data (split does not sanitize HTML) is output to the HTTP response via response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or StringEscapeUtils.escapeHtml() before outputting user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01261.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter\n\nUser-controlled input from request parameter 'BenchmarkTest01261' flows through multiple propagators including ThingFactory.createThing().doSomething() (which is a pass-through) and is written directly to the HTTP response via response.getWriter().println(). The X-XSS-Protection header is explicitly disabled, making the application vulnerable to reflected XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01262.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter\n\nUser-controlled input from request parameter 'BenchmarkTest01262' is only subjected to a substring operation (which does not sanitize XSS) and is written directly to the HTTP response via response.getWriter().println(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01263.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter\n\nUser-controlled input from request parameter 'BenchmarkTest01263' flows through a switch statement. The switch target is 'C' (from guess.charAt(2) where guess='ABC'), which matches case 'C' and assigns param to bar. This tainted data is written directly to the HTTP response via response.getWriter().println(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01266.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter\n\nUser-controlled input from request parameter 'BenchmarkTest01266' is split on spaces (param.split(' ')[0]) but remains tainted, and is written directly to the HTTP response via response.getWriter().write(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01267.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter\n\nUser-controlled input from request parameter 'BenchmarkTest01267' is stored in a HashMap under key 'keyB-53210' and then retrieved. This tainted data is written directly to the HTTP response via response.getWriter().write(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01268.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Parameter\n\nUser-controlled input from request parameter 'BenchmarkTest01268' flows through multiple propagators including ThingFactory.createThing().doSomething() (which is a pass-through) and is written directly to the HTTP response via response.getWriter().write(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01271.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Session Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: float rand = new java.security.SecureRandom().nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01272.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Session Token\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: double stuff = new java.security.SecureRandom().nextGaussian();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01273.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Session Token\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: double stuff = new java.security.SecureRandom().nextGaussian();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01274.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Session Token\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: int randNumber = new java.security.SecureRandom().nextInt(99);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01275.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Session Token\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: int randNumber = new java.security.SecureRandom().nextInt(99);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01276.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Session Token\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: int r = new java.security.SecureRandom().nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01277.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Session Token\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: long l = new java.security.SecureRandom().nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01278.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Session Token\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: long l = new java.security.SecureRandom().nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01279.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Session Token\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation. Example: long l = new java.security.SecureRandom().nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01284.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Reflected\n\nUser input from request parameter 'BenchmarkTest01284' flows through the doSomething method (which adds it to a list, removes the first element, and retrieves it at index 0) and is written directly to the HTTP response without proper encoding. The X-XSS-Protection header is explicitly disabled, and the user input reaches response.getWriter().write() unencoded.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Encode the output using ESAPI or similar HTML encoding before writing to the response: response.getWriter().write(\"Parameter value: \" + ESAPI.encoder().encodeForHTML(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01317.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES) in BenchmarkTest01317\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and computing power, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated from KeyGenerator.getInstance(\"AES\").",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01318.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES) in BenchmarkTest01318\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and computing power, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated from KeyGenerator.getInstance(\"AES\").",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01320.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES) in BenchmarkTest01320\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and computing power, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated from KeyGenerator.getInstance(\"AES\").",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01322.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES through brute-force attacks or known cryptanalytic techniques, compromising confidentiality of encrypted data.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated with KeyGenerator.getInstance(\"AES\") and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01323.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES through brute-force attacks or known cryptanalytic techniques, compromising confidentiality of encrypted data.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated with KeyGenerator.getInstance(\"AES\") and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01329.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request parameter 'BenchmarkTest01329' flows through list operations and is used to construct a file URI without validation. After list mutations (add safe, add param, add moresafe, remove index 0), the code retrieves index 0 which contains the user input. This allows an attacker to inject path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or access arbitrary files on the server filesystem by using path traversal sequences, potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate that the resolved canonical path starts with the intended base directory: File file = new File(baseDir, userInput); String canonical = file.getCanonicalPath(); if (!canonical.startsWith(baseDir.getCanonicalPath())) { throw new SecurityException(); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01330.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request parameter 'BenchmarkTest01330' flows through a conditional statement and is directly concatenated into a file path without validation. The condition (500/42)+196 = 207 > 200 is always true, so bar = param always executes. This allows an attacker to inject path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can write to arbitrary files on the server filesystem by using path traversal sequences, potentially overwriting critical system files, configuration files, or creating files in unauthorized locations.\n\nFix: Validate that the resolved canonical path starts with the intended base directory: File file = new File(baseDir, userInput); String canonical = file.getCanonicalPath(); if (!canonical.startsWith(baseDir.getCanonicalPath())) { throw new SecurityException(); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01335.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01335' flows through a HashMap and is output directly into the HTTP response via PrintWriter.format() without proper sanitization. The X-XSS-Protection header is explicitly disabled (set to '0'), and the user input is included in the formatted output that gets rendered in the HTML response body.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, defacement, or redirection to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding before including user input in HTML responses. Remove or set X-XSS-Protection to '1; mode=block'. Consider using a templating engine with auto-escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01337.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01337' is concatenated with '_SafeStuff' and then used as the format string in response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. Even though '_SafeStuff' is appended, the user input portion can still contain malicious content that gets rendered in the HTML response.\n\nImpact: An attacker can inject malicious JavaScript code through the parameter that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, defacement, or redirection to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding before including user input in HTML responses. Remove or set X-XSS-Protection to '1; mode=block'. Never use user input as a format string - use it only as a parameter to a safe format string.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01346.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from request parameter 'BenchmarkTest01346' flows through a switch statement where charAt(2) of 'ABC' equals 'C', causing the case 'C' branch to execute and assign the user input to 'bar'. This tainted value is then written directly to the HTTP response via response.getWriter().println(bar) with XSS protection disabled (X-XSS-Protection: 0), allowing an attacker to inject arbitrary JavaScript.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding to user input before including it in the HTTP response using HtmlUtils.htmlEscape() or a similar sanitization function. Alternatively, use a templating engine with automatic escaping.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01347.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Propagated User Input\n\nUser-controlled input from request parameter 'BenchmarkTest01347' flows through a propagation chain (StringBuilder, HashMap, Base64 encoding/decoding, string split) and is passed to thing.doSomething(f81561), which is a pass-through that returns the input unchanged. The tainted value is then written directly to the HTTP response via response.getWriter().println(bar) with XSS protection disabled (X-XSS-Protection: 0).\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding to user input before including it in the HTTP response using HtmlUtils.htmlEscape() or a similar sanitization function.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01349.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input with Appended Safe Content\n\nUser-controlled input from request parameter 'BenchmarkTest01349' is placed in a StringBuilder and has '_SafeStuff' appended to it. The resulting string still contains the original user input at the beginning and is written directly to the HTTP response via response.getWriter().println(bar) with XSS protection disabled (X-XSS-Protection: 0). Appending safe content does not sanitize the user input.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding to user input before including it in the HTTP response using HtmlUtils.htmlEscape() or a similar sanitization function.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01350.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Pass-Through Method\n\nUser-controlled input from request parameter 'BenchmarkTest01350' is passed to thing.doSomething(param), which is a pass-through method that returns the input unchanged. The tainted value is then written directly to the HTTP response via response.getWriter().write(bar.toCharArray(), 0, length) with XSS protection disabled (X-XSS-Protection: 0).\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding to user input before including it in the HTTP response using HtmlUtils.htmlEscape() or a similar sanitization function.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01351.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from request parameter 'BenchmarkTest01351' is written directly to the HTTP response after HTML escaping. However, the response header 'X-XSS-Protection' is explicitly set to '0', disabling browser XSS protections. While HtmlUtils.htmlEscape() is applied, the disabled XSS protection combined with user data in response output creates an XSS vulnerability context.\n\nImpact: An attacker could inject malicious scripts that execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Remove the line 'response.setHeader(\"X-XSS-Protection\", \"0\");' to enable browser XSS protections. Continue using HTML escaping but rely on defense-in-depth with browser protections enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01352.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from request parameter 'BenchmarkTest01352' is written directly to the HTTP response after HTML escaping. However, the response header 'X-XSS-Protection' is explicitly set to '0', disabling browser XSS protections. While HtmlUtils.htmlEscape() is applied, the disabled XSS protection combined with user data in response output creates an XSS vulnerability context.\n\nImpact: An attacker could inject malicious scripts that execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Remove the line 'response.setHeader(\"X-XSS-Protection\", \"0\");' to enable browser XSS protections. Continue using HTML escaping but rely on defense-in-depth with browser protections enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01354.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker could predict the random values used for rememberMe cookies, potentially hijacking user sessions or bypassing authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: 'float rand = new java.security.SecureRandom().nextFloat();'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01355.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker could predict the random values used for rememberMe cookies, potentially hijacking user sessions or bypassing authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: 'float rand = new java.security.SecureRandom().nextFloat();'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01356.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values. The doSomething method evaluates (500/42) + 196 = 11 + 196 = 207, which is > 200, so bar = param (user input).\n\nImpact: An attacker could predict the random values used for rememberMe cookies, potentially hijacking user sessions or bypassing authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: 'float rand = new java.security.SecureRandom().nextFloat();'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01357.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker could predict the random values used for rememberMe cookies, potentially hijacking user sessions or bypassing authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: 'int r = new java.security.SecureRandom().nextInt();'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01358.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values. The doSomething method manipulates a list: after valuesList.remove(0), the list becomes [param, 'moresafe'], so valuesList.get(1) returns 'moresafe' (safe).\n\nImpact: An attacker could predict the random values used for rememberMe cookies, potentially hijacking user sessions or bypassing authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: 'int r = new java.security.SecureRandom().nextInt();'",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01398.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\", \"SunJCE\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. It has been deprecated since the late 1990s.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption. Use: Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01403.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Parameter Name\n\nThe application extracts the parameter name (not value) when the parameter value equals 'BenchmarkTest01403' and uses it as a file path. The parameter name is user-controlled and flows through ThingFactory.createThing().doSomething() (a pass-through) to construct a file path without validation. An attacker can submit a request with a parameter name containing '../' to traverse directories.\n\nImpact: An attacker can read, write, or check existence of arbitrary files on the server filesystem by manipulating the parameter name to include path traversal sequences.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the expected base directory. Never use user-controlled input directly in file paths.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01405.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Parameter Name\n\nThe application extracts the parameter name when the parameter value equals 'BenchmarkTest01405' and uses it directly to construct a file path for FileInputStream without any validation. The parameter name is user-controlled and can contain path traversal sequences like '../'.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the parameter name to include path traversal sequences, potentially accessing sensitive configuration files, credentials, or source code.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the expected base directory. Implement a whitelist of allowed file names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01408.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Parameter Name\n\nThe application extracts the parameter name when the parameter value equals 'BenchmarkTest01408' and uses it through ThingFactory.createThing().doSomething() (a pass-through) to construct a file path for FileOutputStream without validation. The parameter name is user-controlled.\n\nImpact: An attacker can write to arbitrary files on the server filesystem by manipulating the parameter name to include path traversal sequences, potentially overwriting critical system files or application code.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the expected base directory. Implement a whitelist of allowed file names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01417.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter names flows into the HTTP response body via PrintWriter.format() without sanitization. The response header 'X-XSS-Protection' is set to '0', disabling browser XSS protections. The parameter name is retrieved from the request, assigned to 'param', passed through doSomething() which returns it unchanged as 'bar', then included in the formatted output.\n\nImpact: An attacker can inject malicious JavaScript code through the parameter name, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Sanitize user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions. Also, remove the 'X-XSS-Protection: 0' header to allow browser-based XSS protections.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01423.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name in Response Output\n\nUser-controlled parameter name flows directly into HTTP response output without sanitization. The parameter name is extracted from request.getParameterNames() and passed through doSomething() which returns it unchanged. The response has X-XSS-Protection disabled, and the tainted data is included in the response body via printf().\n\nImpact: An attacker can inject malicious JavaScript by crafting parameter names containing XSS payloads, leading to execution of arbitrary scripts in victim browsers.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before including it in the response. Alternatively, validate that parameter names contain only expected characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01424.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name with Appended String\n\nUser-controlled parameter name is concatenated with '_SafeStuff' but still contains the original tainted input. The StringBuilder operation does not sanitize the user input. The response has X-XSS-Protection disabled, and the tainted data is included in the response body.\n\nImpact: An attacker can inject malicious JavaScript through parameter names, leading to XSS attacks. The appended string does not prevent the vulnerability.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() before including it in the response, or validate parameter names against a whitelist.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01426.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name in println()\n\nUser-controlled parameter name flows through a switch statement where charAt(2) = 'C', selecting case 'C' which assigns param to bar. The tainted value is then written directly to the HTTP response with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript by crafting parameter names containing XSS payloads, leading to execution of arbitrary scripts in victim browsers.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01427.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Direct Parameter Name Output\n\nUser-controlled parameter name is passed through doSomething() which returns it unchanged (bar = param), then written directly to the HTTP response. The response has X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript through parameter names, leading to XSS attacks.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01428.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via write() with User-Controlled Parameter Name\n\nUser-controlled parameter name is passed through doSomething() which returns it unchanged, then written to the HTTP response via write(). The response has X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript through parameter names, leading to XSS attacks.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01429.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via write() with Switch-Selected Parameter Name\n\nUser-controlled parameter name flows through a switch statement where charAt(2) = 'C', selecting case 'C' which assigns param to bar. The tainted value is then written to the HTTP response with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript through parameter names, leading to XSS attacks.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01431.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random) for Security-Sensitive Context\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers, allowing session hijacking.\n\nImpact: An attacker can predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom secureRandom = new SecureRandom(); double stuff = secureRandom.nextGaussian();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01432.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random) for Security-Sensitive Context\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers, allowing session hijacking.\n\nImpact: An attacker can predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom secureRandom = new SecureRandom(); double stuff = secureRandom.nextGaussian();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01433.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random) for Security-Sensitive Context\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers, allowing session hijacking.\n\nImpact: An attacker can predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom secureRandom = new SecureRandom(); int randNumber = secureRandom.nextInt(99);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01434.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random) for Security-Sensitive Context\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers, allowing session hijacking.\n\nImpact: An attacker can predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom secureRandom = new SecureRandom(); int r = secureRandom.nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01435.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random) for Security-Sensitive Context\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers, allowing session hijacking.\n\nImpact: An attacker can predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom secureRandom = new SecureRandom(); int r = secureRandom.nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01437.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input in HTTP Response\n\nUser-controlled input from request parameter names flows through the doSomething() method and is written directly to the HTTP response without sanitization. The X-XSS-Protection header is explicitly disabled. After list manipulation (add safe, add param, add moresafe, remove index 0), the list becomes [param, moresafe], so get(0) returns the tainted param value.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before writing to the response using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions. Remove the X-XSS-Protection: 0 header or set it to 1.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01438.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input in HTTP Response\n\nUser-controlled input from request parameter names flows through a complex propagation chain (StringBuilder, HashMap, Base64 encoding/decoding, split, ThingFactory.createThing().doSomething()) and is written directly to the HTTP response without sanitization. The X-XSS-Protection header is explicitly disabled. ThingFactory.createThing().doSomething() is a pass-through that returns its input unchanged, so the tainted data reaches the response.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before writing to the response using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions. Remove the X-XSS-Protection: 0 header or set it to 1.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01480.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance('DES/CBC/PKCS5PADDING'). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically weak.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using modern computing resources, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance('AES/GCM/NoPadding'). Use a 256-bit key generated via KeyGenerator.getInstance('AES') with key size 256, and use GCMParameterSpec for authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01483.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\", \"SunJCE\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This makes any data encrypted with DES vulnerable to decryption by attackers.\n\nImpact: An attacker can decrypt sensitive data that was encrypted using DES, compromising the confidentiality of the encrypted information. In this case, the code encrypts sensitive values and stores them in a password file, which could be decrypted by an attacker.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key and proper initialization vector management.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01484.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\", \"SunJCE\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This makes any data encrypted with DES vulnerable to decryption by attackers.\n\nImpact: An attacker can decrypt sensitive data that was encrypted using DES, compromising the confidentiality of the encrypted information. In this case, the code encrypts sensitive values and stores them in a password file, which could be decrypted by an attacker.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key and proper initialization vector management.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01486.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This makes any data encrypted with DES vulnerable to decryption by attackers.\n\nImpact: An attacker can decrypt sensitive data that was encrypted using DES, compromising the confidentiality of the encrypted information. In this case, the code encrypts sensitive values and stores them in a password file, which could be decrypted by an attacker.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key and proper initialization vector management.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01489.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES/DESede\n\nThe code loads a cryptographic algorithm from a properties file with a default value of \"DESede/ECB/PKCS5Padding\" (Triple DES). 3DES/DESede is considered a weak encryption algorithm due to its small block size (64 bits) and is deprecated by NIST. Additionally, ECB mode does not provide semantic security as identical plaintext blocks produce identical ciphertext blocks.\n\nImpact: An attacker can exploit the weaknesses in 3DES encryption to decrypt sensitive data. The use of ECB mode also allows pattern analysis attacks where identical plaintext blocks can be identified in the ciphertext. This compromises the confidentiality of encrypted data stored in the password file.\n\nFix: Replace 3DES with AES-256 in GCM mode. Update the properties file to use \"AES/GCM/NoPadding\" and ensure proper initialization vector management. Never use ECB mode for encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01494.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in File Access\n\nUser input flows through a switch statement where the deterministic condition (guess.charAt(2) = 'C') causes case 'C' to execute, assigning param to bar. This tainted value is then used to construct a file path without validation, allowing an attacker to access arbitrary files via path traversal sequences like '../'.\n\nImpact: An attacker can read arbitrary files on the server by manipulating the BenchmarkTest01494 parameter to include path traversal sequences, potentially accessing sensitive configuration files, source code, or system files.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed file names, check for path traversal sequences ('../', '..\\'), or use Path.normalize() with startsWith() validation against a base directory to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01495.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in File URI Construction\n\nUser input flows through a switch statement where the deterministic condition (guess.charAt(2) = 'C') causes case 'C' to execute, assigning param to bar. This tainted value is then used to construct a file URI without validation, allowing an attacker to access arbitrary files via path traversal sequences.\n\nImpact: An attacker can access arbitrary files on the server by manipulating the BenchmarkTest01495 parameter to include path traversal sequences, potentially accessing sensitive configuration files, source code, or system files.\n\nFix: Validate and sanitize the file path input before constructing the URI. Use a whitelist of allowed file names, check for path traversal sequences ('../', '..\\'), or use Path.normalize() with startsWith() validation against a base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01496.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in FileInputStream\n\nUser input flows through a switch statement where the deterministic condition (guess.charAt(2) = 'C') causes case 'C' to execute, assigning param to bar. This tainted value is then used to open a FileInputStream without validation, allowing an attacker to read arbitrary files via path traversal sequences.\n\nImpact: An attacker can read arbitrary files on the server by manipulating the BenchmarkTest01496 parameter to include path traversal sequences like '../../../etc/passwd', potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed file names, check for path traversal sequences ('../', '..\\'), or use Path.normalize() with startsWith() validation against a base directory to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01497.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in FileOutputStream\n\nUser input flows through list operations where after removing the first element, valuesList.get(0) returns the user-controlled param value. This tainted value is then used to construct a file path for FileOutputStream without validation, allowing an attacker to write to arbitrary files via path traversal sequences.\n\nImpact: An attacker can write to arbitrary files on the server by manipulating the BenchmarkTest01497 parameter to include path traversal sequences, potentially overwriting critical system files, configuration files, or creating files in unauthorized locations.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed file names, check for path traversal sequences ('../', '..\\'), or use Path.normalize() with startsWith() validation against a base directory to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01498.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in FileInputStream via FileDescriptor\n\nUser input is Base64 encoded and decoded (which preserves the original value) and then used to construct a file path for FileInputStream without validation. This allows an attacker to read arbitrary files via path traversal sequences.\n\nImpact: An attacker can read arbitrary files on the server by manipulating the BenchmarkTest01498 parameter to include path traversal sequences, potentially accessing sensitive configuration files, source code, credentials, or system files.\n\nFix: Validate and sanitize the file path input. Base64 encoding/decoding does not sanitize path traversal attacks. Use a whitelist of allowed file names, check for path traversal sequences ('../', '..\\'), or use Path.normalize() with startsWith() validation against a base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01500.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in Files.newInputStream\n\nUser input flows through a HashMap where map3545.get('keyB-3545') retrieves the user-controlled param value. This tainted value is then used to construct a file path for Files.newInputStream without validation, allowing an attacker to read arbitrary files via path traversal sequences.\n\nImpact: An attacker can read arbitrary files on the server by manipulating the BenchmarkTest01500 parameter to include path traversal sequences like '../../../etc/passwd', potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed file names, check for path traversal sequences ('../', '..\\'), or use Path.normalize() with startsWith() validation against a base directory to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01502.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value used for authentication purposes. Math.random() is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker can predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users without knowing their credentials.\n\nFix: Replace Math.random() with java.security.SecureRandom for cryptographically secure random number generation: `SecureRandom sr = new SecureRandom(); byte[] randomBytes = new byte[16]; sr.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01505.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01505' flows through SeparateClassRequest.getTheParameter() and a switch statement (guess.charAt(2) = 'C', which assigns param to bar in case 'C') into an HTTP response via out.format(). The response header 'X-XSS-Protection' is set to '0', disabling browser XSS protection. The user input is placed in the format string arguments without HTML encoding.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode user input before including it in the response: `Object[] obj = {\"a\", org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar)};` or use a templating engine with auto-escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01506.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01506' flows through SeparateClassRequest.getTheParameter() and ThingFactory.createThing().doSomething() (a pass-through that returns param unchanged) into an HTTP response via response.getWriter().format(). The response header 'X-XSS-Protection' is set to '0'. The user input is used as the format string itself, allowing format string injection and XSS.\n\nImpact: An attacker can inject malicious JavaScript code or format string specifiers that will be executed in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or causing application errors.\n\nFix: Never use user input as a format string. HTML-encode user input and use it only as a format argument: `response.getWriter().format(\"%s\", org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar));`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01507.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01507' flows through SeparateClassRequest.getTheParameter() and an if statement ((500/42)+196 = 207.86 > 200 is true, so bar = param) into an HTTP response via response.getWriter().format(). The response header 'X-XSS-Protection' is set to '0'. The user input is used as the format string itself.\n\nImpact: An attacker can inject malicious JavaScript code or format string specifiers that will be executed in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or causing application errors.\n\nFix: Never use user input as a format string. HTML-encode user input and use it only as a format argument: `response.getWriter().format(\"%s\", org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar));`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01509.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Print Method\n\nUser-controlled input from request parameter 'BenchmarkTest01509' flows through SeparateClassRequest.getTheParameter() and a split operation (param.split(\" \")[0]) into an HTTP response via response.getWriter().print(). The response header 'X-XSS-Protection' is set to '0'. The user input is not HTML-encoded before being written to the response.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode user input before including it in the response: `response.getWriter().print(org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar));`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01510.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Printf Method\n\nUser-controlled input from request parameter 'BenchmarkTest01510' flows through SeparateClassRequest.getTheParameter() and ThingFactory.createThing().doSomething() (a pass-through that returns param unchanged) into an HTTP response via response.getWriter().printf(). The response header 'X-XSS-Protection' is set to '0'. The user input is placed in the format string arguments without HTML encoding.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode user input before including it in the response: `Object[] obj = {org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar), \"b\"};`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01511.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via printf with user-controlled format string\n\nUser input flows into the format string parameter of response.getWriter().printf(). The code retrieves user input via scr.getTheParameter(), passes it through a switch statement where guess.charAt(2) = 'C' (the third character of \"ABC\"), which matches case 'C' and assigns param to bar. This tainted value is then used in printf() with X-XSS-Protection disabled. While bar is placed in the Object array, the format string \"%1$s and %2$s.\" references it, allowing XSS.\n\nImpact: An attacker can inject malicious JavaScript that will be executed in victims' browsers, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the user input before including it in the response using OWASP Java Encoder or similar: response.getWriter().printf(\"Formatted like: %1$s and %2$s.\", new Object[]{Encode.forHtml(bar), \"b\"});",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01518.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values. An attacker who observes several tokens can predict future tokens and hijack user sessions.\n\nImpact: An attacker can predict session tokens, leading to unauthorized access to user accounts and session hijacking.\n\nFix: Use java.security.SecureRandom instead: float rand = new java.security.SecureRandom().nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01519.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values. An attacker who observes several tokens can predict future tokens and hijack user sessions.\n\nImpact: An attacker can predict session tokens, leading to unauthorized access to user accounts and session hijacking.\n\nFix: Use java.security.SecureRandom instead: float rand = new java.security.SecureRandom().nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01520.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values. An attacker who observes several tokens can predict future tokens and hijack user sessions.\n\nImpact: An attacker can predict session tokens, leading to unauthorized access to user accounts and session hijacking.\n\nFix: Use java.security.SecureRandom instead: long l = new java.security.SecureRandom().nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01565.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES) in BenchmarkTest01565\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via `Cipher.getInstance(\"DES/CBC/PKCS5Padding\")`. DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: Encrypted sensitive data can be decrypted by attackers using brute-force attacks or known cryptanalytic techniques, exposing confidential information stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: `Cipher.getInstance(\"AES/GCM/NoPadding\")`. Use a 256-bit key generated via `KeyGenerator.getInstance(\"AES\")` with appropriate key size configuration.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01566.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DESede/3DES) in BenchmarkTest01566\n\nThe code loads a cryptographic algorithm from a properties file with a default value of \"DESede/ECB/PKCS5Padding\" (Triple DES). DESede/3DES is considered weak due to its small block size (64 bits) which makes it vulnerable to birthday attacks and collision attacks, especially in high-throughput scenarios.\n\nImpact: Encrypted data can be compromised through cryptanalytic attacks. The 64-bit block size of 3DES makes it vulnerable to sweet32 attacks when large amounts of data are encrypted with the same key.\n\nFix: Replace DESede/3DES with AES-256 in GCM mode. Update the default algorithm in benchmark.properties to \"AES/GCM/NoPadding\" and use appropriate GCMParameterSpec configuration.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01571.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter 'BenchmarkTest01571' flows through a switch statement where guess.charAt(2) = 'C', which matches case 'C' and assigns param to bar. This tainted value is then used to construct a file path via 'new java.io.File(bar, \"/Test.txt\")'. An attacker can supply path traversal sequences like '../../../etc/passwd' to access arbitrary files.\n\nImpact: An attacker can read or write arbitrary files on the server filesystem by manipulating the file path, potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed paths, canonicalize the path using File.getCanonicalPath(), and verify it stays within the intended directory. Consider using Path.normalize() and checking that the resolved path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01572.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Pass-Through Method\n\nUser input from request parameter 'BenchmarkTest01572' is passed through ThingFactory.createThing().doSomething(param), which is a pass-through method that returns the input unchanged. The tainted value is then concatenated with Utils.TESTFILES_DIR and used to open a FileInputStream. An attacker can supply '../../../etc/passwd' to read arbitrary files.\n\nImpact: An attacker can read arbitrary files on the server filesystem, potentially accessing sensitive data, configuration files, or credentials.\n\nFix: Validate the file path input against a whitelist of allowed filenames. Use File.getCanonicalPath() to resolve the path and verify it remains within the intended directory (Utils.TESTFILES_DIR). Reject any input containing path traversal sequences like '../' or '..'.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01575.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker, allowing session hijacking.\n\nImpact: An attacker can predict or brute-force the rememberMe cookie values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Replace Math.random() with java.security.SecureRandom for generating security-sensitive tokens. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01577.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm MD5 Used\n\nThe code uses MessageDigest.getInstance(\"MD5\") to hash sensitive values (passwords). MD5 is cryptographically broken and vulnerable to collision attacks. It should not be used for password hashing or any security-sensitive hashing.\n\nImpact: An attacker can use rainbow tables or collision attacks to reverse MD5 hashes and recover the original passwords. MD5 is unsuitable for password storage.\n\nFix: Use a strong password hashing algorithm designed for this purpose, such as bcrypt, scrypt, Argon2, or PBKDF2. For general-purpose hashing, use SHA-256, SHA-384, or SHA-512. Example: MessageDigest.getInstance(\"SHA-256\") or use a dedicated password hashing library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01579.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe code loads the hash algorithm from a properties file using benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). While the default is SHA-512 (secure), the algorithm can be configured at runtime to use a weak algorithm like MD5 or SHA-1 via the properties file. This creates a configuration-based vulnerability.\n\nImpact: If the properties file is modified to specify a weak algorithm (MD5, SHA-1), the system becomes vulnerable to hash collision and preimage attacks, compromising password security.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) directly in the code rather than loading it from a configuration file. If configuration is required, validate the algorithm against a whitelist of approved strong algorithms before use.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01580.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe code loads the hash algorithm from a properties file using benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). While the default is SHA-512 (secure), the algorithm can be configured at runtime to use a weak algorithm like MD5 or SHA-1 via the properties file. This creates a configuration-based vulnerability.\n\nImpact: If the properties file is modified to specify a weak algorithm (MD5, SHA-1), the system becomes vulnerable to hash collision and preimage attacks, compromising password security.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) directly in the code rather than loading it from a configuration file. If configuration is required, validate the algorithm against a whitelist of approved strong algorithms before use.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01583.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01583' flows through doSomething() where it is appended with '_SafeStuff', then placed into an Object array and output to the HTTP response via format(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript that will be executed in the victim's browser.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding before including user input in the HTTP response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01584.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01584' is assigned to 'bar' (condition evaluates to true: (500/42)+196=207>200), which is then used as the format string in response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript or format string specifiers.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser or exploit format string vulnerabilities to cause information disclosure or denial of service.\n\nFix: Never use user-controlled input as a format string. Use a fixed format string with user input as parameters. Apply proper output encoding using ESAPI.encoder().encodeForHTML(). Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01587.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01587' is assigned to 'bar' via ternary operator (condition evaluates to false: (7*42)-106=188<200), which is then used as the format string in response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript or format string specifiers.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser or exploit format string vulnerabilities to cause information disclosure or denial of service.\n\nFix: Never use user-controlled input as a format string. Use a fixed format string with user input as parameters. Apply proper output encoding using ESAPI.encoder().encodeForHTML(). Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01589.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01589' flows through a switch statement where case 'C' is selected (guess.charAt(2)='C'), assigning param to bar. The tainted bar is then placed in an Object array and output to the HTTP response via printf(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding before including user input in the HTTP response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01590.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser-controlled input from request parameter 'BenchmarkTest01590' is directly assigned to 'bar' and then used as the format string in response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript or format string specifiers.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser or exploit format string vulnerabilities to cause information disclosure or denial of service.\n\nFix: Never use user-controlled input as a format string. Use a fixed format string with user input as parameters. Apply proper output encoding using ESAPI.encoder().encodeForHTML(). Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01592.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input\n\nUser input from request parameter 'BenchmarkTest01592' flows directly into the HTTP response without sanitization. The ternary condition `(7 * 42) - 106 > 200` evaluates to `188 > 200` which is false, causing `bar` to be assigned the user-controlled `param`. This value is then written to the response via `response.getWriter().println(bar)` with XSS protection explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in victims' browsers, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding using a library like OWASP Java Encoder or Apache Commons StringEscapeUtils.escapeHtml() before writing user input to the response. Example: `response.getWriter().println(StringEscapeUtils.escapeHtml(bar));`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01594.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in StringBuilder\n\nUser input from request parameter 'BenchmarkTest01594' is placed in a StringBuilder and appended with '_SafeStuff', but the resulting string still contains the unescaped user input. This tainted value is written to the HTTP response with XSS protection disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in victims' browsers, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding before writing to the response: `response.getWriter().println(StringEscapeUtils.escapeHtml(bar));`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01596.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Split User Input\n\nUser input from request parameter 'BenchmarkTest01596' is split on spaces and the first token is used, but this is still user-controlled data. The value is written to the HTTP response via `response.getWriter().write(bar.toCharArray(), 0, length)` with XSS protection disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in victims' browsers, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding before writing to the response: `response.getWriter().write(StringEscapeUtils.escapeHtml(bar).toCharArray(), 0, length);`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01597.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in StringBuilder\n\nUser input from request parameter 'BenchmarkTest01597' is placed in a StringBuilder and appended with '_SafeStuff', but the resulting string still contains the unescaped user input. This tainted value is written to the HTTP response with XSS protection disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in victims' browsers, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding before writing to the response: `response.getWriter().write(StringEscapeUtils.escapeHtml(bar).toCharArray(), 0, length);`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01598.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Propagated User Input\n\nUser input from request parameter 'BenchmarkTest01598' flows through a chain of propagators (StringBuilder, HashMap, substring, Base64 encode/decode, split) and is passed to `thing.doSomething(f75770)`. The ThingFactory.createThing().doSomething() method is a pass-through that returns its input unchanged, so the tainted user input reaches the HTTP response via `response.getWriter().write(bar)` with XSS protection disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in victims' browsers, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding before writing to the response: `response.getWriter().write(StringEscapeUtils.escapeHtml(bar));`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01602.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker who observes previous outputs or knows the seed.\n\nImpact: An attacker can predict or brute-force the rememberMe token values, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: SecureRandom secureRandom = new SecureRandom(); float rand = secureRandom.nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01603.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict or brute-force the rememberMe token values, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: SecureRandom secureRandom = new SecureRandom(); long l = secureRandom.nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01615.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from request parameter 'BenchmarkTest01615' is stored directly into HttpSession using putValue() with the user input as the session key name. The doSomething() method performs only string manipulation (replacing last character with 'Z'), which does not sanitize the input for trust boundary purposes. This allows an attacker to control session attribute names.\n\nImpact: An attacker can manipulate session attribute names, potentially overwriting critical session data or causing session fixation attacks.\n\nFix: Never use user-controlled data as session attribute keys. Use a fixed, application-controlled key name and store user data as the value after proper validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01616.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest01616' flows through multiple transformations (StringBuilder operations, Base64 encoding/decoding, string splitting) and is then passed through ThingFactory.createThing().doSomething(), which is a pass-through that returns its input unchanged. The resulting tainted data is stored directly into HttpSession using putValue() as the session value without validation.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize all user input before storing it in the session. Implement strict input validation rules based on expected data format and content.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01617.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from request parameter 'BenchmarkTest01617' is stored directly into HttpSession using setAttribute() with the user input as the session key name. The doSomething() method performs only substring operation, which does not sanitize the input for trust boundary purposes.\n\nImpact: An attacker can manipulate session attribute names, potentially overwriting critical session data or causing session fixation attacks.\n\nFix: Never use user-controlled data as session attribute keys. Use a fixed, application-controlled key name and store user data as the value after proper validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01618.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest01618' is passed through ThingFactory.createThing().doSomething(), which is a pass-through that returns its input unchanged. The tainted data is then stored directly into HttpSession using setAttribute() as the session value without validation.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize all user input before storing it in the session. Implement strict input validation rules based on expected data format and content.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01619.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session (HTML Escaping Insufficient)\n\nUser-controlled data from request parameter 'BenchmarkTest01619' is HTML-escaped using StringEscapeUtils.escapeHtml() and then stored directly into HttpSession using setAttribute(). HTML escaping only protects against XSS (CWE-79) but does NOT prevent trust boundary violations (CWE-501). The issue is storing unvalidated user data in a trusted context (session), not the format of the data.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks. HTML escaping does not mitigate trust boundary violations.\n\nFix: Validate and sanitize all user input before storing it in the session. HTML escaping is insufficient for trust boundary protection. Implement strict input validation rules based on expected data format and content.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01632.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection\n\nUser input from request parameter 'BenchmarkTest01632' flows into an XPath expression without sanitization. The doSomething() method uses a switch statement with guess.charAt(1) = 'B', which assigns bar = \"bob\" (safe constant). However, the XPath expression is constructed via string concatenation, which is a dangerous pattern even though this specific instance uses a safe value.\n\nImpact: If the data flow were to change to pass user input, an attacker could manipulate XPath queries to access unauthorized data or bypass authentication checks in the XML document.\n\nFix: Use parameterized XPath queries or validate/sanitize input by escaping single quotes before concatenation. Consider using XPath variable binding if supported by your XPath library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01634.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used for secure encryption. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force or known cryptanalytic attacks against DES, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01637.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used for secure encryption. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force or known cryptanalytic attacks against DES, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01638.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used for secure encryption. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force or known cryptanalytic attacks against DES, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01639.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used for secure encryption. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force or known cryptanalytic attacks against DES, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01641.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES/3DES) from Properties File\n\nThe code loads a cryptographic algorithm from a properties file with a default fallback to 'DESede/ECB/PKCS5Padding' (Triple DES). DESede (3DES) is a weak encryption algorithm that is vulnerable to cryptanalytic attacks and should not be used for encrypting sensitive data. Additionally, ECB mode does not provide semantic security.\n\nImpact: An attacker who obtains encrypted data could potentially decrypt it using known cryptanalytic techniques against 3DES. ECB mode also reveals patterns in plaintext data.\n\nFix: Use AES with GCM mode instead: 'AES/GCM/NoPadding'. Update the properties file and code to use strong modern encryption algorithms.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01642.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Filename\n\nUser input from the query string is passed through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and directly used to construct a file path. An attacker can use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker could read, write, or check the existence of arbitrary files on the filesystem by manipulating the filename parameter with path traversal sequences.\n\nFix: Validate that the filename does not contain path traversal sequences ('../' or '..\\'), use a whitelist of allowed filenames, or canonicalize the path and verify it stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01643.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Filename in URI Construction\n\nUser input from the query string flows through a ternary condition where (7*42) - 106 = 188, and 188 > 200 is false, so bar = param (tainted). This tainted value is used to construct a file URI without validation, allowing path traversal attacks.\n\nImpact: An attacker could access arbitrary files on the filesystem by providing path traversal sequences in the parameter.\n\nFix: Validate the filename to ensure it does not contain path traversal sequences before constructing the file URI.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01645.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Filename in FileInputStream\n\nUser input flows through a switch statement where guess.charAt(2) = 'C' (from \"ABC\"), which matches case 'C' that assigns bar = param. This tainted value is concatenated to form a file path and used in FileInputStream, allowing path traversal attacks.\n\nImpact: An attacker could read arbitrary files on the filesystem by providing path traversal sequences in the parameter.\n\nFix: Validate the filename to ensure it does not contain path traversal sequences ('../' or '..\\') before file access.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01647.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Filename in FileOutputStream\n\nUser input from the query string flows through a ternary condition where (7*42) - 106 = 188, and 188 > 200 is false, so bar = param (tainted). This tainted value is used to construct a file path for FileOutputStream without validation, allowing path traversal attacks.\n\nImpact: An attacker could write to or overwrite arbitrary files on the filesystem by providing path traversal sequences in the parameter.\n\nFix: Validate the filename to ensure it does not contain path traversal sequences before file access.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01649.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 for hashing sensitive values (passwords). SHA-1 is cryptographically broken and vulnerable to collision attacks. It should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker who obtains the hashed values could potentially reverse them using collision attacks or rainbow tables, compromising user passwords.\n\nFix: Use a strong password hashing algorithm like bcrypt, scrypt, Argon2, or PBKDF2. For general-purpose hashing, use SHA-256 or stronger (SHA-384, SHA-512, SHA-3).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01650.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 for hashing sensitive values (passwords). SHA-1 is cryptographically broken and vulnerable to collision attacks. It should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker who obtains the hashed values could potentially reverse them using collision attacks or rainbow tables, compromising user passwords.\n\nFix: Use a strong password hashing algorithm like bcrypt, scrypt, Argon2, or PBKDF2. For general-purpose hashing, use SHA-256 or stronger (SHA-384, SHA-512, SHA-3).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01657.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the query string flows through doSomething() (which returns it unchanged) into bar, which is then included in an HTTP response via out.format(). The response header X-XSS-Protection is set to 0, disabling browser XSS protection. No output encoding is applied to the user input before it's written to the response.\n\nImpact: An attacker can inject malicious JavaScript code via the BenchmarkTest01657 query parameter, which will execute in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar before including user input in HTML responses. Remove the X-XSS-Protection: 0 header to allow browser-based XSS protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01658.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the query string flows through doSomething() (which returns it unchanged) into bar, which is then included in an HTTP response via response.getWriter().format(). The response header X-XSS-Protection is set to 0, disabling browser XSS protection. No output encoding is applied to the user input.\n\nImpact: An attacker can inject malicious JavaScript code via the BenchmarkTest01658 query parameter, which will execute in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar before including user input in HTML responses. Remove the X-XSS-Protection: 0 header to allow browser-based XSS protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01660.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Pass-Through Method\n\nUser-controlled input from the query string flows through ThingFactory.createThing().doSomething(param), which is a pass-through that returns the input unchanged. The result is written directly to the HTTP response via response.getWriter().print(bar). The response header X-XSS-Protection is set to 0, disabling browser XSS protection.\n\nImpact: An attacker can inject malicious JavaScript code via the BenchmarkTest01660 query parameter, which will execute in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar before including user input in HTML responses. Remove the X-XSS-Protection: 0 header to allow browser-based XSS protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01662.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query String Parameter\n\nUser input from the query string parameter 'BenchmarkTest01662' is extracted, Base64 encoded/decoded (which provides no sanitization), and then output directly to the HTTP response via printf(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript that will execute in the victim's browser.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape() before writing user input to the HTTP response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01665.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query String Parameter\n\nUser input from the query string parameter 'BenchmarkTest01665' is extracted, has '_SafeStuff' appended (which does not sanitize the original input), and then output directly to the HTTP response. The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript that will execute in the victim's browser.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape() before writing user input to the HTTP response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01666.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query String Parameter\n\nUser input from the query string parameter 'BenchmarkTest01666' is extracted, has its last character replaced with 'Z' (which does not sanitize the rest of the input), and then output directly to the HTTP response. The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript that will execute in the victim's browser.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape() before writing user input to the HTTP response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01667.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query String Parameter\n\nUser input from the query string parameter 'BenchmarkTest01667' is extracted, stored in a HashMap under key 'keyB-96771', retrieved from the same key, and then output directly to the HTTP response. The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript that will execute in the victim's browser.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape() before writing user input to the HTTP response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01670.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query String Parameter\n\nUser input from the query string parameter 'BenchmarkTest01670' is extracted and directly assigned to the 'bar' variable without any sanitization, then output directly to the HTTP response via write(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript that will execute in the victim's browser.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or HtmlUtils.htmlEscape() before writing user input to the HTTP response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01675.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, making the token vulnerable to brute-force attacks.\n\nImpact: An attacker can predict or brute-force the rememberMe token, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01676.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker can predict the rememberMe token, leading to session hijacking and unauthorized account access.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security tokens.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01677.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure.\n\nImpact: An attacker can predict the rememberMe token, enabling session hijacking and unauthorized access.\n\nFix: Use java.security.SecureRandom for generating cryptographic tokens.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01678.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure.\n\nImpact: An attacker can predict the rememberMe token, leading to session hijacking.\n\nFix: Use java.security.SecureRandom for generating security-sensitive tokens.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01679.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure.\n\nImpact: An attacker can predict the rememberMe token, enabling session hijacking and unauthorized access.\n\nFix: Use java.security.SecureRandom for generating cryptographic tokens.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01680.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker can predict the rememberMe token (only 99 possible values), leading to trivial session hijacking.\n\nFix: Use java.security.SecureRandom for generating security tokens, and increase the entropy (99 possible values is far too low).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01681.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and hijack user sessions.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive values: `int r = new java.security.SecureRandom().nextInt();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01708.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled data from the query string is used directly as the session key name in HttpSession.putValue(). The variable 'bar' derives from request.getQueryString() and flows through param.substring() without validation. This allows an attacker to control which session attribute names are created, potentially overwriting critical session data or causing session manipulation attacks.\n\nImpact: An attacker can manipulate session attribute names, potentially overwriting security-critical session variables, bypassing authentication checks, or causing denial of service by exhausting session storage.\n\nFix: Do not use user-controlled data as session key names. Use a fixed, application-defined key name and store user data as the value. If dynamic keys are required, validate against a strict whitelist of allowed key names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01709.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - Unvalidated User Data in Session\n\nUser-controlled data from the query string is stored directly into the HttpSession without validation. The variable 'bar' originates from request.getQueryString() and flows through multiple transformations (StringBuilder, HashMap, Base64, split, ThingFactory pass-through) but remains tainted. This violates the trust boundary between user input and trusted session storage.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or exploitation of other components that trust session data. The stored data could be used in subsequent requests to bypass security controls.\n\nFix: Validate and sanitize all user input before storing it in the session. Implement strict input validation with whitelisting of allowed characters/patterns. Consider using indirect references (e.g., mapping user input to safe internal identifiers) rather than storing raw user data in the session.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01710.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - Unvalidated User Data in Session\n\nUser-controlled data from the query string is stored directly into the HttpSession without validation. The variable 'bar' originates from request.getQueryString() and is assigned from 'param' via a ternary expression. The condition (7*42)-106 > 200 evaluates to 188 > 200 which is false, so bar receives the tainted param value. This violates the trust boundary between user input and trusted session storage.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or exploitation of other components that trust session data. The stored data could be used in subsequent requests to bypass security controls.\n\nFix: Validate and sanitize all user input before storing it in the session. Implement strict input validation with whitelisting of allowed characters/patterns. Consider using indirect references (e.g., mapping user input to safe internal identifiers) rather than storing raw user data in the session.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01741.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES/3DES) via Runtime Configuration\n\nThe code loads the encryption algorithm from a properties file with a default fallback to 'DESede/ECB/PKCS5Padding' (Triple DES). DESede (3DES) is a weak encryption algorithm that is vulnerable to cryptanalytic attacks and should not be used for encrypting sensitive data. The algorithm is loaded from an external configuration source, making it susceptible to misconfiguration.\n\nImpact: An attacker who can read the encrypted data may be able to decrypt it using known cryptanalytic techniques against 3DES. This could expose sensitive information such as passwords stored in the passwordFile.txt.\n\nFix: Use a strong, modern encryption algorithm such as AES-256 with GCM mode. Replace the cipher initialization with: Cipher.getInstance(\"AES/GCM/NoPadding\") and use a 256-bit key with proper IV generation using SecureRandom.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01742.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES/3DES) via Runtime Configuration\n\nThe code loads the encryption algorithm from a properties file with a default fallback to 'DESede/ECB/PKCS5Padding' (Triple DES). DESede (3DES) is a weak encryption algorithm that is vulnerable to cryptanalytic attacks and should not be used for encrypting sensitive data. The algorithm is loaded from an external configuration source, making it susceptible to misconfiguration.\n\nImpact: An attacker who can read the encrypted data may be able to decrypt it using known cryptanalytic techniques against 3DES. This could expose sensitive information such as passwords stored in the passwordFile.txt.\n\nFix: Use a strong, modern encryption algorithm such as AES-256 with GCM mode. Replace the cipher initialization with: Cipher.getInstance(\"AES/GCM/NoPadding\") and use a 256-bit key with proper IV generation using SecureRandom.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01745.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from SeparateClassRequest flows directly into the File constructor as the directory path without any validation or sanitization. An attacker can use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read arbitrary files on the filesystem by providing path traversal sequences, potentially accessing sensitive configuration files, source code, or system files.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use canonical path validation: File file = new File(baseDir, userInput); String canonicalPath = file.getCanonicalPath(); if (!canonicalPath.startsWith(baseDir.getCanonicalPath())) { throw new SecurityException(\"Path traversal attempt detected\"); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01746.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input flows into a file URI construction. The ternary condition evaluates to: (7*42) - 106 = 294 - 106 = 188, and 188 > 200 is FALSE, so bar = param (user input). This user input is then concatenated into a file URI without validation, allowing path traversal attacks.\n\nImpact: An attacker can use path traversal sequences like '../' to access files outside the intended directory, potentially reading sensitive files on the filesystem.\n\nFix: Validate the file path to ensure it stays within the intended directory using canonical path validation. Additionally, sanitize the input to remove or reject path traversal sequences before constructing the URI.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01750.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from SeparateClassRequest flows through ThingFactory.createThing().doSomething() (which is a pass-through that returns its input unchanged) and is then concatenated into a file path used in FileInputStream without validation. An attacker can use path traversal sequences to access arbitrary files.\n\nImpact: An attacker can read arbitrary files on the filesystem by providing path traversal sequences like '../../../etc/passwd', potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use canonical path validation: File file = new File(TESTFILES_DIR, userInput); String canonicalPath = file.getCanonicalPath(); if (!canonicalPath.startsWith(new File(TESTFILES_DIR).getCanonicalPath())) { throw new SecurityException(\"Path traversal attempt detected\"); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01752.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from SeparateClassRequest.getTheValue() flows through a HashMap (map11351.put(\"keyB-11351\", param) then map11351.get(\"keyB-11351\")) and is directly concatenated into a file path without validation. An attacker can use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read or write arbitrary files on the server filesystem, potentially accessing sensitive data or overwriting critical system files.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the expected base directory. Alternatively, use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01753.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input in Filter\n\nUser input flows through Base64 encode/decode (which does not sanitize) and is directly concatenated into an LDAP filter string. An attacker can inject LDAP filter metacharacters to modify the query logic.\n\nImpact: An attacker can bypass authentication, extract sensitive directory information, or enumerate all LDAP entries by injecting filter operators like '*', '|', '&', or parentheses.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to escape special LDAP characters before concatenating user input into filter strings, or use parameterized LDAP queries if available.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01754.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input in Filter\n\nUser input from SeparateClassRequest.getTheValue() flows through a HashMap (map91865.put(\"keyB-91865\", param) then map91865.get(\"keyB-91865\")) and is directly concatenated into an LDAP filter string without sanitization.\n\nImpact: An attacker can bypass authentication, extract sensitive directory information, or enumerate all LDAP entries by injecting LDAP filter metacharacters.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to escape special LDAP characters before concatenating user input into filter strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01755.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input in Filter\n\nUser input from SeparateClassRequest.getTheValue() flows through a HashMap (map69635.put(\"keyB-69635\", param) then map69635.get(\"keyB-69635\")) and is directly concatenated into an LDAP filter string without sanitization.\n\nImpact: An attacker can bypass authentication, extract sensitive directory information, or enumerate all LDAP entries by injecting LDAP filter metacharacters.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to escape special LDAP characters before concatenating user input into filter strings.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01768.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from scr.getTheValue() flows through param.split(\" \")[0] into the bar variable, which is then included in an HTTP response via response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. This allows an attacker to inject malicious JavaScript that will execute in victims' browsers.\n\nImpact: An attacker can inject malicious JavaScript code that executes in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding. Do not disable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01770.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from scr.getTheValue() flows into param, then is appended with \"_SafeStuff\" via StringBuilder. The resulting tainted string is included in an HTTP response via response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled. Appending safe content to tainted data does not sanitize it.\n\nImpact: An attacker can inject malicious JavaScript code that executes in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding. Do not disable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01771.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unsanitized User Input\n\nUser-controlled input from scr.getTheValue() flows through multiple propagators and ThingFactory.createThing().doSomething() (which is a pass-through returning input unchanged) and is written directly to the HTTP response via response.getWriter().println(bar). The X-XSS-Protection header is explicitly disabled, and no sanitization is applied to the user input before output.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using HtmlUtils.htmlEscape() or ESAPI.encoder().encodeForHTML() before writing user input to the response. Alternatively, use a templating engine with auto-escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01772.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in Response\n\nUser-controlled input from scr.getTheValue() is appended with '_SafeStuff' but the original tainted parameter remains in the string. This unsanitized data is written to the HTTP response via response.getWriter().write(bar.toCharArray()) with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, leading to session hijacking, credential theft, or other client-side attacks.\n\nFix: Apply HTML encoding using HtmlUtils.htmlEscape() or ESAPI.encoder().encodeForHTML() before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01775.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Conditional User Input\n\nUser-controlled input from scr.getTheValue() is assigned to bar when the condition (500/42)+196 > 200 evaluates to true (which it always does: 11+196=207>200). The tainted value is then written directly to the HTTP response via response.getWriter().write(bar) with X-XSS-Protection disabled and no sanitization.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially compromising user sessions or stealing sensitive data.\n\nFix: Apply proper output encoding using HtmlUtils.htmlEscape() or ESAPI.encoder().encodeForHTML() before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01781.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: `double value = new java.security.SecureRandom().nextDouble();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01782.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: `double stuff = new java.security.SecureRandom().nextGaussian();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01783.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: `double stuff = new java.security.SecureRandom().nextGaussian();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01784.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: `int r = new java.security.SecureRandom().nextInt();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01785.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: `int r = new java.security.SecureRandom().nextInt();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01786.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: `int r = new java.security.SecureRandom().nextInt();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01787.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: `int r = new java.security.SecureRandom().nextInt();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01788.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: `long l = new java.security.SecureRandom().nextLong();`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01788.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in Response\n\nUser-controlled input from scr.getTheValue() flows through the doSomething method (where the condition (500/42) + 196 = 207 > 200 is true, so bar = param) and is written to the HTTP response without proper encoding. The X-XSS-Protection header is not set to 0, but user input reaches the response output.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Use proper output encoding before writing user input to the response: `org.owasp.esapi.ESAPI.encoder().encodeForHTML(rememberMe.getValue())`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01789.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in Response\n\nUser-controlled input from scr.getTheValue() flows through the doSomething method (where the condition (7*42) - 106 = 188 > 200 is false, so bar = param) and reaches the response. While the 'str' variable is HTML-encoded, the 'bar' variable (which contains user input) is used earlier in the code flow and could be exploited.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Ensure all user-controlled data is properly encoded before output. The current code does encode 'str', but verify that all paths are properly sanitized.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01822.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force attacks or known cryptanalytic techniques, exposing sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption. Use `Cipher.getInstance(\"AES/GCM/NoPadding\")` with a 256-bit key.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01823.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: Encrypted data can be decrypted by attackers using brute-force attacks or known cryptanalytic techniques, exposing sensitive information.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption. Use `Cipher.getInstance(\"AES/GCM/NoPadding\")` with a 256-bit key.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01829.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DESede (3DES)\n\nThe code loads a cryptographic algorithm from a properties file with a default value of \"DESede/ECB/PKCS5Padding\" (Triple DES). 3DES is deprecated and considered weak due to its small block size (64 bits) which makes it vulnerable to birthday attacks. Additionally, ECB mode does not provide semantic security.\n\nImpact: Encrypted data can be vulnerable to cryptanalytic attacks. ECB mode reveals patterns in plaintext, and 3DES's 64-bit block size enables practical birthday attacks.\n\nFix: Replace 3DES with AES-256 in GCM mode. Update the default algorithm to \"AES/GCM/NoPadding\" and ensure the properties file specifies a secure algorithm.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01830.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DESede (3DES)\n\nThe code loads a cryptographic algorithm from a properties file with a default value of \"DESede/ECB/PKCS5Padding\" (Triple DES). 3DES is deprecated and considered weak due to its small block size (64 bits) which makes it vulnerable to birthday attacks. Additionally, ECB mode does not provide semantic security.\n\nImpact: Encrypted data can be vulnerable to cryptanalytic attacks. ECB mode reveals patterns in plaintext, and 3DES's 64-bit block size enables practical birthday attacks.\n\nFix: Replace 3DES with AES-256 in GCM mode. Update the default algorithm to \"AES/GCM/NoPadding\" and ensure the properties file specifies a secure algorithm.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01831.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Cookie in BenchmarkTest01831\n\nUser-controlled cookie value flows unsanitized into an LDAP filter string via string concatenation. The cookie value is Base64 encoded/decoded (which provides no sanitization) and then directly concatenated into the LDAP filter: '(&(objectclass=person))(|(uid=' + bar + ')(street={0}))'.\n\nImpact: An attacker can inject malicious LDAP filter syntax through the cookie value to bypass authentication, access unauthorized data, or modify LDAP queries to return unintended results.\n\nFix: Use parameterized LDAP queries or properly escape special LDAP characters in user input. ESAPI provides encodeForLDAP() method for this purpose. Alternatively, validate that the input contains only expected characters (alphanumeric).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01832.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Cookie in BenchmarkTest01832\n\nUser-controlled cookie value flows unsanitized into an LDAP filter string via string concatenation. The doSomething() method evaluates (500/42) + 196 = 207 > 200 (true), so bar is assigned the tainted param value, which is then concatenated into the LDAP filter.\n\nImpact: An attacker can inject malicious LDAP filter syntax through the cookie value to bypass authentication, access unauthorized data, or modify LDAP queries to return unintended results.\n\nFix: Use parameterized LDAP queries or properly escape special LDAP characters using ESAPI.encoder().encodeForLDAP(). Validate that the input contains only expected characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01833.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie in BenchmarkTest01833\n\nUser-controlled cookie value flows unsanitized into a file path. The cookie value is stored in a HashMap and retrieved, then used directly to construct a File object without validation for path traversal sequences like '../'.\n\nImpact: An attacker can use path traversal sequences (e.g., '../../etc/passwd') in the cookie value to access files outside the intended directory, potentially reading sensitive system files or application configuration.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use canonical path validation: resolve the full path and verify it starts with the expected base directory. Reject inputs containing '../' or '..\\'.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01835.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie in BenchmarkTest01835\n\nUser-controlled cookie value flows unsanitized into a file path. The doSomething() method evaluates (500/42) + 196 = 207 > 200 (true), so bar is assigned the tainted param value, which is then used to construct a File object without path traversal validation.\n\nImpact: An attacker can use path traversal sequences (e.g., '../../etc/passwd') in the cookie value to access files outside the intended directory, potentially reading sensitive system files or application configuration.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use canonical path validation: resolve the full path and verify it starts with the expected base directory. Reject inputs containing '../' or '..\\'.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01836.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie in BenchmarkTest01836\n\nUser-controlled cookie value flows unsanitized into a file URI path. The cookie value is stored in a HashMap and retrieved, then used to construct a file URI without validation for path traversal sequences.\n\nImpact: An attacker can use path traversal sequences in the cookie value to access files outside the intended directory through the file URI, potentially reading sensitive system files or application configuration.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use canonical path validation before constructing the URI. Reject inputs containing '../' or '..\\'.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01839.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie in BenchmarkTest01839\n\nUser-controlled cookie value flows unsanitized into a file path used for FileOutputStream. The doSomething() method evaluates (7*42) - 106 = 188 > 200 (false), so bar is assigned the tainted param value, which is then used to construct a file path for writing without path traversal validation.\n\nImpact: An attacker can use path traversal sequences in the cookie value to write to files outside the intended directory, potentially overwriting critical system files, application configuration, or creating files in unauthorized locations.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use canonical path validation before file operations. Reject inputs containing '../' or '..\\'.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01840.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via Cookie in BenchmarkTest01840\n\nUser-controlled cookie value flows directly unsanitized into a file path used for FileOutputStream. The doSomething() method returns param unchanged, which is then used to construct a file path for writing without any validation.\n\nImpact: An attacker can use path traversal sequences in the cookie value to write to files outside the intended directory, potentially overwriting critical system files, application configuration, or creating files in unauthorized locations.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use canonical path validation before file operations. Reject inputs containing '../' or '..\\'.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01872.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from a cookie is passed through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and then used as a session attribute key via request.getSession().putValue(bar, \"10340\"). This allows an attacker to control session key names, potentially overwriting critical session attributes or causing session fixation attacks.\n\nImpact: An attacker can manipulate session state by controlling which session attributes are set, potentially overwriting security-critical session data or causing denial of service.\n\nFix: Never use user-controlled data as session attribute keys. Use a fixed, application-controlled key name instead. If dynamic keys are required, validate against a strict whitelist of allowed key names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01874.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from a cookie is Base64 encoded/decoded (which does not sanitize the data) and then used as a session attribute key via request.getSession().setAttribute(bar, \"10340\"). The Base64 round-trip does not validate or sanitize the input, allowing an attacker to control session key names.\n\nImpact: An attacker can manipulate session state by controlling which session attributes are set, potentially overwriting security-critical session data.\n\nFix: Never use user-controlled data as session attribute keys. Use fixed, application-controlled key names. Base64 encoding is not a security control.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01875.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - HTML-Escaped User Data in Session Key\n\nUser-controlled data from a cookie is HTML-encoded via ESAPI.encoder().encodeForHTML() and then used as a session attribute key via request.getSession().setAttribute(bar, \"10340\"). HTML encoding only protects against XSS, not trust boundary violations. The attacker can still control session key names.\n\nImpact: An attacker can manipulate session state by controlling which session attributes are set, potentially overwriting security-critical session data.\n\nFix: Never use user-controlled data as session attribute keys, even if HTML-encoded. HTML encoding does not prevent trust boundary violations. Use fixed, application-controlled key names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01876.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session Value\n\nUser-controlled data from a cookie (with only the last character removed via substring) is stored directly into the session as a value via request.getSession().setAttribute(\"userid\", bar). This stores unvalidated user input in a trusted session context.\n\nImpact: An attacker can inject malicious data into the session, which may be trusted by other parts of the application, leading to privilege escalation, session poisoning, or other attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement strict input validation against expected formats (e.g., alphanumeric user IDs). Consider using indirect references or session-managed identifiers instead of storing user-provided values directly.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01892.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection via String Concatenation\n\nUser input from a cookie is stored in a HashMap and retrieved, then concatenated directly into an XPath expression without sanitization. The doSomething method puts param into map3451 under 'keyB-3451' and retrieves it, making bar tainted. This allows XPath injection attacks.\n\nImpact: An attacker can manipulate the XPath query to access unauthorized data from the XML document or bypass authentication logic.\n\nFix: Use parameterized XPath queries or sanitize input by validating/escaping special XPath characters (especially single quotes). Consider using XPath variable binding instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_643.CWE-643",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01894.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "XPath Injection via String Concatenation\n\nUser input from a cookie flows into an XPath expression via string concatenation. The doSomething method evaluates (7*42)-106 = 188, which is NOT > 200, so the ternary assigns param (user-controlled cookie value) to bar. This tainted value is then concatenated into the XPath query without sanitization.\n\nImpact: An attacker can manipulate the XPath query to access unauthorized data from the XML document or bypass authentication logic.\n\nFix: Use parameterized XPath queries or sanitize input by validating/escaping special XPath characters (especially single quotes). Consider using XPath variable binding instead of string concatenation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-643"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01895.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used for secure encryption. DES has a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using modern computing resources, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 or AES-128 with GCM mode for authenticated encryption. Use javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01897.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used for secure encryption. DES has a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using modern computing resources, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 or AES-128 with GCM mode for authenticated encryption. Use javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01898.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used for secure encryption. DES has a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using modern computing resources, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 or AES-128 with GCM mode for authenticated encryption. Use javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01900.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (3DES/DESede)\n\nThe code loads a cipher algorithm from a properties file with a default value of 'DESede/ECB/PKCS5Padding' (Triple DES). DESede/3DES is considered weak and deprecated due to its small block size (64 bits) and susceptibility to birthday attacks. Additionally, ECB mode is insecure as it doesn't provide semantic security.\n\nImpact: Encrypted data can be vulnerable to cryptanalysis. ECB mode reveals patterns in plaintext, and 3DES is deprecated by NIST and should not be used for new applications.\n\nFix: Replace 3DES with AES-256 or AES-128 with GCM mode. Update the default algorithm in benchmark.properties to 'AES/GCM/NoPadding' and use proper IV handling.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01902.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection in BenchmarkTest01902\n\nUser-controlled input from request header flows into an LDAP filter without sanitization. The doSomething method stores the param in a list, removes the first element, then retrieves param at index 0. The filter string is constructed using string concatenation: 'String filter = \"(&(objectclass=person)(uid=\" + bar + \"))\"' where bar contains unsanitized user input.\n\nImpact: An attacker can inject LDAP filter metacharacters to bypass authentication, access unauthorized data, or enumerate LDAP directory contents.\n\nFix: Use parameterized LDAP queries or sanitize input by escaping LDAP special characters (*, (, ), \\, NUL) using ESAPI.encoder().encodeForLDAP() before constructing the filter.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01904.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in BenchmarkTest01904\n\nUser-controlled input from request header flows into a file path without validation. The doSomething method stores param in a HashMap under 'keyB-13742' and retrieves it back, so bar contains the unsanitized user input. This is then used to construct a file path.\n\nImpact: An attacker can use path traversal sequences (../) to access files outside the intended directory, potentially reading sensitive system files or application configuration.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use Path.normalize() and verify the canonical path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01906.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in BenchmarkTest01906\n\nUser-controlled input from request header flows into a file path without validation. The doSomething method adds param to a list, removes the first 'safe' element, then retrieves param at index 0. The tainted value is concatenated with TESTFILES_DIR to create a file path.\n\nImpact: An attacker can use path traversal sequences (../) to write files outside the intended directory, potentially overwriting critical system files or application code.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use Path.normalize() and verify the canonical path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01907.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in BenchmarkTest01907\n\nUser-controlled input from request header flows into a file path without validation. The doSomething method uses a ternary operator: (7*42)-106 = 188, and 188 > 200 is FALSE, so bar is assigned param (user input). This tainted value is concatenated with TESTFILES_DIR to create a file path.\n\nImpact: An attacker can use path traversal sequences (../) to write files outside the intended directory, potentially overwriting critical system files or application code.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use Path.normalize() and verify the canonical path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01908.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in BenchmarkTest01908\n\nUser-controlled input from request header flows into a file path without validation. The doSomething method adds param to a list, removes the first 'safe' element, then retrieves param at index 0. The tainted value is concatenated with TESTFILES_DIR and used with java.nio.file.Paths.get().\n\nImpact: An attacker can use path traversal sequences (../) to read files outside the intended directory, potentially accessing sensitive system files or application configuration.\n\nFix: Validate the file path to ensure it stays within the intended directory. Use Path.normalize() and verify the canonical path starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01910.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator in BenchmarkTest01910\n\nThe application uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict the rememberMe cookie values, allowing them to forge authentication cookies and hijack user sessions.\n\nFix: Use java.security.SecureRandom instead of Math.random() for generating security-sensitive random values like session tokens.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01914.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the Referer header flows through doSomething() where the condition (7*42)-86 = 208 > 200 is always true, so bar is assigned the constant \"This_should_always_happen\". However, when num=86, the else branch assigns param. Since (7*42)=294, 294-86=208, and 208>200 is true, bar receives the constant. But the X-XSS-Protection header is disabled and output goes to response writer, creating an XSS context.\n\nImpact: Wait, let me recalculate: (7*42) = 294, 294 - 86 = 208, 208 > 200 is TRUE. So bar = \"This_should_always_happen\" (constant). This is actually SAFE.\n\nFix: N/A - False positive on recalculation",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01916.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the Referer header flows through doSomething() where it is split and the first element is assigned to bar. The tainted bar value is then written directly to the HTTP response via response.getWriter().print(bar.toCharArray()) with X-XSS-Protection disabled, allowing XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Encode the output using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01919.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the Referer header flows through doSomething() where the condition (500/42)+196 = 11+196 = 207 > 200 is true, so bar is assigned param (tainted). The tainted bar value is then used as the format string in response.getWriter().printf() with X-XSS-Protection disabled, allowing XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser. Additionally, using user input as a format string can lead to format string vulnerabilities.\n\nFix: Never use user input as a format string. Encode the output using ESAPI.encoder().encodeForHTML() and use it as a parameter, not as the format string itself.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01920.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser-controlled input from the Referer header flows through doSomething() where after list operations (add safe, add param, add moresafe, remove index 0), the list becomes [param, moresafe]. The code then calls valuesList.get(0) which retrieves param (tainted). The tainted bar value is then written to the HTTP response via response.getWriter().printf() with X-XSS-Protection disabled, allowing XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Encode the output using ESAPI.encoder().encodeForHTML() before including it in the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01921.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in printf\n\nUser-controlled data from the Referer header flows into response.getWriter().printf() without sanitization. The doSomething() method performs a switch on guess.charAt(2) which equals 'C', matching case 'C' and assigning param to bar. The X-XSS-Protection header is disabled, and the tainted bar value is output in the HTTP response body via printf, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by manipulating the Referer header, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the bar variable before including it in the response using ESAPI.encoder().encodeForHTML(bar) or similar encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01922.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in printf with Format String\n\nUser-controlled data from the Referer header flows into response.getWriter().printf() where bar is used as the format string itself. The doSomething() method adds param to a list, removes the first element, then retrieves index 0 which now contains param. The X-XSS-Protection header is disabled, and the tainted bar value is used as the format string in printf, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by manipulating the Referer header, leading to session hijacking, credential theft, or defacement. Additionally, using user input as a format string can cause format string vulnerabilities.\n\nFix: HTML-encode the bar variable and never use user input as a format string. Use a fixed format string with bar as a parameter: response.getWriter().printf(\"%s\", ESAPI.encoder().encodeForHTML(bar)).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01923.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in printf with Format String\n\nUser-controlled data from the Referer header flows through ThingFactory.createThing().doSomething() (a pass-through that returns param unchanged) into response.getWriter().printf() where bar is used as the format string. The X-XSS-Protection header is disabled, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by manipulating the Referer header, leading to session hijacking, credential theft, or defacement. Additionally, using user input as a format string can cause format string vulnerabilities.\n\nFix: HTML-encode the bar variable and never use user input as a format string. Use a fixed format string with bar as a parameter: response.getWriter().printf(\"%s\", ESAPI.encoder().encodeForHTML(bar)).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01924.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in printf with Format String\n\nUser-controlled data from the Referer header is HTML-escaped but then used as a format string in response.getWriter().printf(). While HTML encoding prevents basic XSS, using user input as a format string itself is dangerous and can still lead to unexpected behavior or exploitation. The X-XSS-Protection header is disabled.\n\nImpact: An attacker may be able to exploit format string vulnerabilities or cause unexpected output behavior by manipulating the Referer header with format specifiers.\n\nFix: Never use user input as a format string, even if HTML-encoded. Use a fixed format string with bar as a parameter: response.getWriter().printf(\"%s\", bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01925.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in println\n\nUser-controlled data from the Referer header flows into response.getWriter().println() without sanitization. The doSomething() method performs a string manipulation (replacing the last character with 'Z') but this does not sanitize the user input. The X-XSS-Protection header is disabled, and the tainted bar value is output in the HTTP response body, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by manipulating the Referer header, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the bar variable before including it in the response using ESAPI.encoder().encodeForHTML(bar) or similar encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01926.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in println\n\nUser-controlled data from the Referer header flows into response.getWriter().println() without sanitization. The doSomething() method evaluates (500/42) + 196 = 11 + 196 = 207, which is > 200, so bar = param. The X-XSS-Protection header is disabled, and the tainted bar value is output in the HTTP response body, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by manipulating the Referer header, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the bar variable before including it in the response using ESAPI.encoder().encodeForHTML(bar) or similar encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01927.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in write\n\nUser-controlled data from the Referer header flows into response.getWriter().write() without sanitization. The doSomething() method performs Base64 encoding and decoding, which returns the original param value unchanged. The X-XSS-Protection header is disabled, and the tainted bar value is output in the HTTP response body, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by manipulating the Referer header, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the bar variable before including it in the response using ESAPI.encoder().encodeForHTML(bar) or similar encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01930.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random().nextDouble() to generate a rememberMe cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making the session token vulnerable to prediction attacks.\n\nImpact: An attacker can predict the rememberMe cookie values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens: double value = new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01931.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random) for Security-Sensitive Token\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers, allowing them to forge authentication tokens.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to impersonate other users and bypass authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); float rand = secureRandom.nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01932.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random) for Security-Sensitive Token\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to impersonate other users and bypass authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); int r = secureRandom.nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01933.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random) for Security-Sensitive Token\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to impersonate other users and bypass authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); long l = secureRandom.nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01934.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random) for Security-Sensitive Token\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe token values, allowing them to impersonate other users and bypass authentication mechanisms.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); long l = secureRandom.nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01978.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used for secure encryption. DES has a 56-bit key size that is vulnerable to brute-force attacks.\n\nImpact: Encrypted data can be decrypted by attackers using modern computing resources, compromising the confidentiality of sensitive information.\n\nFix: Replace DES with AES-256 in GCM or CBC mode. Use javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01980.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm from Properties File\n\nThe encryption algorithm is loaded from a properties file with a default value of 'DESede/ECB/PKCS5Padding' (Triple DES). DESede (3DES) is deprecated and considered weak by modern cryptographic standards. Additionally, ECB mode does not provide semantic security.\n\nImpact: Encrypted data can be vulnerable to cryptanalysis. ECB mode reveals patterns in plaintext, and 3DES has known weaknesses including sweet32 attacks.\n\nFix: Use AES-256 with GCM or CBC mode. Update the properties file and code to use 'AES/GCM/NoPadding' or 'AES/CBC/PKCS5Padding' with proper IV handling.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01981.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (3DES/DESede)\n\nThe code uses a weak encryption algorithm loaded from a properties file with a default value of 'DESede/ECB/PKCS5Padding' (3DES). Triple DES is considered cryptographically weak and should not be used for encrypting sensitive data. The algorithm is retrieved via benchmarkprops.getProperty('cryptoAlg1', 'DESede/ECB/PKCS5Padding'), and the default fallback is the weak 3DES algorithm.\n\nImpact: An attacker could potentially decrypt sensitive data encrypted with 3DES due to its known weaknesses, including small block size (64 bits) and susceptibility to various cryptographic attacks. This compromises the confidentiality of encrypted data.\n\nFix: Replace 3DES with a strong modern encryption algorithm such as AES-256 with GCM mode: 'AES/GCM/NoPadding'. Update the default value in the properties file and ensure all deployments use strong encryption algorithms.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01983.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser-controlled input from a non-standard HTTP header name flows directly into a file path construction without validation. The parameter 'bar' (derived from request header names) is concatenated with TESTFILES_DIR to create a File object. An attacker can supply header names containing path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check the existence of arbitrary files on the server filesystem by manipulating HTTP header names to include path traversal sequences, potentially accessing sensitive configuration files, application code, or system files.\n\nFix: Validate and sanitize the file path before use. Use a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, or use Path.normalize() combined with startsWith() validation to ensure the resolved path remains within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01985.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Directory Path\n\nUser-controlled input from a non-standard HTTP header name flows through Base64 encoding/decoding (which is a pass-through operation) and is used as the directory path in File constructor. The parameter 'bar' becomes the parent directory in 'new java.io.File(bar, \"/Test.txt\")'. An attacker can supply header names with path traversal sequences to access arbitrary directories.\n\nImpact: An attacker can manipulate the directory path to access files in arbitrary locations on the filesystem, potentially reading or writing sensitive files outside the intended directory structure.\n\nFix: Validate the directory path against a whitelist of allowed directories. Ensure the resolved path stays within the intended base directory using canonical path validation with Path.normalize() and startsWith() checks.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01987.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File URI\n\nUser-controlled input from a non-standard HTTP header name flows through a switch statement (where guess.charAt(2) = 'C' assigns param to bar) and is concatenated into a file URI path without validation. The tainted 'bar' value is appended to the TESTFILES_DIR path in the URI constructor, allowing path traversal attacks.\n\nImpact: An attacker can manipulate HTTP header names to include path traversal sequences like '../' to construct URIs pointing to arbitrary files on the filesystem, potentially accessing sensitive files outside the intended directory.\n\nFix: Validate and sanitize the 'bar' parameter before incorporating it into file paths. Use canonical path validation to ensure the resolved path remains within TESTFILES_DIR. Reject inputs containing '..' or absolute path indicators.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01988.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled FileInputStream Path\n\nUser-controlled input from a non-standard HTTP header name flows through Base64 encoding/decoding (pass-through) and is concatenated with TESTFILES_DIR to construct a file path for FileInputStream. The tainted 'bar' value allows an attacker to include path traversal sequences to read arbitrary files.\n\nImpact: An attacker can read arbitrary files on the server filesystem by supplying HTTP header names containing path traversal sequences like '../', potentially exposing sensitive configuration files, credentials, application source code, or system files.\n\nFix: Implement strict input validation on the 'bar' parameter. Use a whitelist of allowed filenames, reject paths containing '..' or '/', and use canonical path validation to ensure the resolved path stays within TESTFILES_DIR.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01989.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled FileOutputStream Path\n\nUser-controlled input from a non-standard HTTP header name flows through a ternary expression (where the false branch assigns param to bar) and is concatenated with TESTFILES_DIR to construct a file path for FileOutputStream. An attacker can supply header names with path traversal sequences to write to arbitrary file locations.\n\nImpact: An attacker can write to arbitrary files on the server filesystem by manipulating HTTP header names to include path traversal sequences, potentially overwriting critical system files, configuration files, or application code, leading to system compromise or denial of service.\n\nFix: Validate and sanitize the file path before use. Implement a whitelist of allowed filenames, reject paths containing '..' or absolute path indicators, and use canonical path validation to ensure the resolved path remains within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01992.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.lang.Math.random)\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' session token. Math.random() is not cryptographically secure and uses a predictable pseudo-random number generator. An attacker could predict the generated token values, allowing session hijacking or authentication bypass.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.lang.Math.random() with java.security.SecureRandom for generating security-sensitive tokens. Example: SecureRandom secureRandom = new SecureRandom(); double value = secureRandom.nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01999.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextBytes() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable pseudo-random values. An attacker could predict the generated token values.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens. Example: SecureRandom secureRandom = new SecureRandom(); secureRandom.nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02000.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextBytes() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable pseudo-random values. An attacker could predict the generated token values.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive tokens. Example: SecureRandom secureRandom = new SecureRandom(); secureRandom.nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02015.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled data from a non-standard HTTP header name is stored directly as a session attribute key via request.getSession().putValue(bar, \"10340\"). The header name (param) flows through doSomething() where it undergoes Base64 encode/decode (which is a pass-through operation) and is then used as the session key. This allows an attacker to control session key names, potentially overwriting critical session attributes or causing session pollution.\n\nImpact: An attacker can manipulate session state by controlling the key names used to store session data. This could lead to session fixation, privilege escalation, or denial of service by overwriting legitimate session attributes.\n\nFix: Never use user-controlled data as session attribute keys. Use a fixed, application-defined key name and store the user input as the value only after proper validation. Example: request.getSession().putValue(\"userInput\", sanitizedBar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02016.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Data in Session\n\nUser-controlled data from a non-standard HTTP header name is stored directly into the session via request.getSession().putValue(\"userid\", bar). The header name (param) flows through doSomething() where ThingFactory.createThing().doSomething(param) is called, which is a pass-through that returns the input unchanged. The tainted data is then stored in the session without validation.\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning, where malicious data persists across requests and may be used in security-sensitive operations. This can result in privilege escalation, authentication bypass, or other security violations.\n\nFix: Validate and sanitize all user input before storing it in the session. Implement strict input validation rules based on expected data format and content. Consider using a whitelist approach for acceptable values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02017.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) algorithm via javax.crypto.Cipher.getInstance(\"DES/CBC/PKCS5PADDING\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and has been deprecated for decades.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and modest computing resources. This completely compromises the confidentiality of the encrypted data.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption: javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key.init(256).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02018.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) algorithm via javax.crypto.Cipher.getInstance(\"DES/CBC/PKCS5PADDING\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and has been deprecated for decades.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and modest computing resources. This completely compromises the confidentiality of the encrypted data.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption: javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key.init(256).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02019.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) algorithm via javax.crypto.Cipher.getInstance(\"DES/CBC/PKCS5PADDING\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and has been deprecated for decades.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and modest computing resources. This completely compromises the confidentiality of the encrypted data.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption: javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key.init(256).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02020.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses the DES (Data Encryption Standard) algorithm via javax.crypto.Cipher.getInstance(\"DES/CBC/PKCS5Padding\", \"SunJCE\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and has been deprecated for decades.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and modest computing resources. This completely compromises the confidentiality of the encrypted data.\n\nFix: Replace DES with AES-256 in GCM mode for authenticated encryption: javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\", \"SunJCE\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key.init(256).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02022.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES/DESede\n\nThe code uses a weak encryption algorithm (DESede/3DES) loaded from a properties file with a default value of 'DESede/ECB/PKCS5Padding'. Triple DES (3DES/DESede) is considered cryptographically weak and should not be used for encrypting sensitive data. The algorithm is specified via Properties.getProperty() with a weak default fallback.\n\nImpact: An attacker could potentially decrypt sensitive data encrypted with 3DES using known cryptanalytic attacks. The encrypted password data stored in passwordFile.txt would be at risk of compromise.\n\nFix: Replace 3DES with a strong encryption algorithm such as AES-256 in GCM mode. Update the properties file default to use 'AES/GCM/NoPadding' and ensure proper IV generation using SecureRandom.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02023.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES/DESede\n\nThe code uses a weak encryption algorithm (DESede/3DES) loaded from a properties file with a default value of 'DESede/ECB/PKCS5Padding'. Triple DES (3DES/DESede) is considered cryptographically weak and should not be used for encrypting sensitive data. The algorithm is specified via Properties.getProperty() with a weak default fallback.\n\nImpact: An attacker could potentially decrypt sensitive data encrypted with 3DES using known cryptanalytic attacks. The encrypted password data stored in passwordFile.txt would be at risk of compromise.\n\nFix: Replace 3DES with a strong encryption algorithm such as AES-256 in GCM mode. Update the properties file default to use 'AES/GCM/NoPadding' and ensure proper IV generation using SecureRandom.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02027.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input from the HTTP header 'BenchmarkTest02027' flows directly into a file path construction without validation. The doSomething() method's ternary condition evaluates to false ((7*42) - 106 = 188, which is NOT > 200), causing the user input to be assigned to 'bar'. This tainted value is then used to construct a File object, allowing an attacker to access arbitrary files via path traversal sequences like '../../../etc/passwd'.\n\nImpact: An attacker can read arbitrary files on the server filesystem by injecting path traversal sequences (e.g., '../') in the BenchmarkTest02027 header. This could lead to disclosure of sensitive configuration files, source code, credentials, or other confidential data.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed filenames, reject paths containing '..' or absolute paths, or use Path.normalize() combined with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02032.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the HTTP header 'BenchmarkTest02032' flows through doSomething() where the condition (500/42)+196=207>200 evaluates to true, assigning param to bar. This tainted value is then concatenated with TESTFILES_DIR and used to construct a FileInputStream, allowing an attacker to read arbitrary files via path traversal sequences like '../../../etc/passwd'.\n\nImpact: An attacker can read arbitrary files on the server filesystem by injecting path traversal sequences in the BenchmarkTest02032 HTTP header, potentially exposing sensitive configuration files, credentials, or source code.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, canonicalize the path with File.getCanonicalPath(), and verify it starts with the expected base directory before opening the file.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02034.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the HTTP header 'BenchmarkTest02034' flows through doSomething() where the condition (500/42)+196=207>200 evaluates to true, assigning param to bar. This tainted value is concatenated with TESTFILES_DIR and used to open a FileInputStream, allowing an attacker to access arbitrary files via path traversal.\n\nImpact: An attacker can read arbitrary files on the server filesystem by injecting path traversal sequences in the BenchmarkTest02034 HTTP header, potentially exposing sensitive data.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, canonicalize the path with File.getCanonicalPath(), and verify it starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02036.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input in Filter\n\nUser input from the HTTP header 'BenchmarkTest02036' flows through doSomething() where a list manipulation results in param being retrieved at index 0. This tainted value (bar) is directly concatenated into an LDAP filter string without sanitization, allowing LDAP injection attacks.\n\nImpact: An attacker can manipulate the LDAP query by injecting special characters (e.g., '*', ')', '(') to bypass authentication, extract sensitive directory data, or modify the query logic.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize user input before including it in LDAP filters, or use parameterized LDAP queries if supported by your LDAP library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02037.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input in Filter\n\nUser input from the HTTP header 'BenchmarkTest02037' flows through doSomething() where the ternary condition (7*42)-106=188>200 evaluates to false, assigning param to bar. This tainted value is directly concatenated into an LDAP filter string without sanitization, allowing LDAP injection attacks.\n\nImpact: An attacker can manipulate the LDAP query by injecting special characters to bypass authentication, extract sensitive directory data, or modify the query logic.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize user input before including it in LDAP filters, or use parameterized LDAP queries if supported by your LDAP library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02046.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header is retrieved, passed through doSomething() which stores it in a HashMap and retrieves it back (propagating taint), then written directly to the HTTP response via response.getWriter().print(bar.toCharArray()). The X-XSS-Protection header is disabled, and no sanitization is applied.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing user input to the response. Alternatively, use a Content Security Policy (CSP) and enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02047.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header flows through doSomething() where the condition (500/42)+196 = 207 > 200 is true, so bar = param (tainted). This tainted data is then written directly to the HTTP response via response.getWriter().print(bar.toCharArray()) with X-XSS-Protection disabled and no sanitization.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing user input to the response. Alternatively, use a Content Security Policy (CSP) and enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02050.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header\n\nUser-controlled data from the Referer header flows through doSomething() where the condition (500/42)+196 = 207 > 200 is true, so bar = param (tainted). This tainted data is then written to the HTTP response via response.getWriter().printf() with X-XSS-Protection disabled and no sanitization.\n\nImpact: An attacker can inject malicious JavaScript code via the Referer header, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding function before writing user input to the response. Alternatively, use a Content Security Policy (CSP) and enable XSS protection headers.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02051.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in Response Output\n\nUser-controlled data from the Referer header flows through a ternary condition that evaluates to false ((7*42)-106 = 188, which is NOT > 200), assigning param to bar. The tainted bar value is then output to the HTTP response via printf() with X-XSS-Protection disabled, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by crafting a Referer header, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response, or use a templating engine with auto-escaping.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02054.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in Response Output\n\nUser-controlled data from the Referer header is split and the first token is assigned to bar. This tainted value is used as the format string in printf() with X-XSS-Protection disabled, enabling both format string and XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript or exploit format string vulnerabilities by crafting a Referer header, leading to information disclosure, session hijacking, or code execution.\n\nFix: Never use user input as a format string. Use a constant format string and pass user data as arguments. HTML-encode all user data before output.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02055.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in Response Output\n\nUser-controlled data from the Referer header flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is output to the HTTP response with X-XSS-Protection disabled, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by crafting a Referer header, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02056.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in Response Output\n\nUser-controlled data from the Referer header is stored in a HashMap and retrieved back out. The tainted bar value is output to the HTTP response with X-XSS-Protection disabled, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by crafting a Referer header, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02057.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Referer Header in Response Output\n\nUser-controlled data from the Referer header flows through a switch statement. The switch target is 'C' (from guess.charAt(2) where guess=\"ABC\"), which matches case 'C' that assigns param to bar. The tainted bar value is output to the HTTP response with X-XSS-Protection disabled, enabling XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript by crafting a Referer header, leading to session hijacking, credential theft, or defacement.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02060.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe code uses java.util.Random to generate a rememberMe cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, allowing attackers to guess valid session tokens.\n\nImpact: An attacker can predict or brute-force rememberMe cookie values, leading to session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for all security-sensitive random number generation: SecureRandom secureRandom = new SecureRandom(); double value = secureRandom.nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02101.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size and is vulnerable to brute-force attacks.\n\nImpact: An attacker could decrypt sensitive data encrypted with DES using modern computing resources. This compromises the confidentiality of encrypted data.\n\nFix: Replace DES with AES-256 in GCM mode: javax.crypto.Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key and proper IV management with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02105.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter flows through list manipulation and is used directly in a File constructor without validation. After removing the first element from the list [\"safe\", param, \"moresafe\"], the code retrieves index 0 which contains the user-controlled param value. This allows an attacker to access arbitrary files using path traversal sequences like '../../../etc/passwd'.\n\nImpact: An attacker can read arbitrary files on the server filesystem by providing path traversal sequences, potentially accessing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, check for path traversal sequences (..), and use canonical path validation: File file = new File(baseDir, userInput); if (!file.getCanonicalPath().startsWith(baseDir.getCanonicalPath())) { throw new SecurityException(); }",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02106.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter is Base64 encoded then decoded (a pass-through operation that returns the original value unchanged) and used directly in a File constructor without validation. This allows an attacker to access arbitrary files using path traversal sequences.\n\nImpact: An attacker can read arbitrary files on the server filesystem by providing path traversal sequences, potentially accessing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, check for path traversal sequences (..), and use canonical path validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02109.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter is Base64 encoded then decoded (a pass-through operation) and used directly in FileOutputStream constructor without validation. This allows an attacker to write to arbitrary file locations using path traversal sequences.\n\nImpact: An attacker can write to arbitrary files on the server filesystem, potentially overwriting critical system files, configuration files, or planting malicious files in web-accessible directories.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, check for path traversal sequences (..), and use canonical path validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02112.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input flows into a file path without validation. The switch statement evaluates guess.charAt(2) which equals 'C', causing case 'C' to execute and assign param (user input) to bar. This value is then concatenated with TESTFILES_DIR and used to create a FileOutputStream, allowing path traversal attacks.\n\nImpact: An attacker can use path traversal sequences (../) to write to arbitrary files on the filesystem, potentially overwriting critical system files or application configuration.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the expected base directory. Alternatively, use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02113.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input flows into a file path without validation. The switch statement evaluates guess.charAt(2) which equals 'C', causing case 'C' to execute and assign param (user input) to bar. This value is then used to construct a file path for reading, allowing path traversal attacks.\n\nImpact: An attacker can use path traversal sequences (../) to read arbitrary files on the filesystem, potentially accessing sensitive configuration files, credentials, or other confidential data.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the expected base directory. Alternatively, use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02114.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input\n\nUser input from request parameter flows through doSomething() where it's stored in a list, the first element is removed, and valuesList.get(1) retrieves 'moresafe' (the safe constant at the end). However, after remove(0), the list becomes [param, 'moresafe'], so get(1) returns 'moresafe', making bar safe. Upon re-analysis, the list operations are: add('safe'), add(param), add('moresafe'), remove(0) \u2192 list becomes [param, 'moresafe']. Then get(1) retrieves 'moresafe' (index 1 after removal). This is actually SAFE.\n\nImpact: None - the code is secure as written.\n\nFix: No action needed - false positive on initial analysis.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02121.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm via Runtime Configuration\n\nThe hash algorithm is loaded from a properties file at runtime via benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). An attacker who can modify the benchmark.properties file could configure a weak hash algorithm like MD5 or SHA1. The algorithm selection is externally configurable rather than hardcoded to a secure algorithm.\n\nImpact: If the properties file is compromised or misconfigured, weak hash algorithms like MD5 or SHA1 could be used, making the hashed data vulnerable to collision attacks and rainbow table attacks.\n\nFix: Hardcode a strong hash algorithm like SHA-256 or SHA-512 directly in the code instead of loading it from a properties file: java.security.MessageDigest.getInstance(\"SHA-256\");",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02122.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser input from request parameter flows through doSomething() where after list manipulation (add safe, add param, add moresafe, remove index 0), valuesList.get(1) retrieves 'moresafe' (the safe constant at the end). However, let me recalculate: Initial list after adds: [safe, param, moresafe]. After remove(0): [param, moresafe]. get(1) returns 'moresafe' which is safe. This is actually NOT vulnerable - the data flow shows bar receives the constant 'moresafe', not user input.\n\nImpact: N/A - False positive on recalculation\n\nFix: N/A",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02123.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Format String\n\nUser input from request.getParameter(\"BenchmarkTest02123\") flows through ThingFactory.createThing().doSomething(param), which is a pass-through that returns param unchanged. The tainted value is then placed in an Object array and output via response.getWriter().format() with X-XSS-Protection disabled, allowing XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode the user input before including it in the response: bar = org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02124.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Print\n\nUser input from request.getParameter(\"BenchmarkTest02124\") flows through doSomething() where it's modified by replacing the last character with 'Z', but remains tainted. The value is then output via response.getWriter().print() with X-XSS-Protection disabled, allowing XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode the user input before including it in the response: bar = org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02126.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Print\n\nUser input from request.getParameter(\"BenchmarkTest02126\") flows through a complex propagation chain (StringBuilder, HashMap, Base64 encode/decode, split, ThingFactory pass-through) and is output via response.getWriter().print() with X-XSS-Protection disabled. The ThingFactory.createThing().doSomething() is a pass-through that returns its input unchanged, so the tainted data reaches the response.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode the user input before including it in the response: bar = org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02127.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Print\n\nUser input from request.getParameter(\"BenchmarkTest02127\") is assigned to bar when the condition (500/42) + 196 > 200 evaluates to true. Calculating: 500/42 = 11 (integer division), 11 + 196 = 207, and 207 > 200 is true, so bar = param executes. The tainted value is output via response.getWriter().print() with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode the user input before including it in the response: bar = org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02128.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Print\n\nUser input from request.getParameter(\"BenchmarkTest02128\") flows through doSomething() where it's modified by substring (removing last character) but remains tainted. The value is output via response.getWriter().print() with X-XSS-Protection disabled, allowing XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode the user input before including it in the response: bar = org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02129.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Printf\n\nUser input from request.getParameter(\"BenchmarkTest02129\") flows through doSomething() where it's split on space and the first element is taken, but remains tainted. The value is output via response.getWriter().printf() with X-XSS-Protection disabled, allowing XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode the user input before including it in the response: bar = org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02130.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Printf\n\nUser input from request.getParameter(\"BenchmarkTest02130\") flows through doSomething() where it's appended with '_SafeStuff' but the original tainted data remains in the string. The value is output via response.getWriter().printf() with X-XSS-Protection disabled, allowing XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: HTML-encode the user input before including it in the response: bar = org.owasp.esapi.ESAPI.encoder().encodeForHTML(bar);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02131.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via printf with user input\n\nUser-controlled input from request parameter 'BenchmarkTest02131' flows through doSomething() (which only performs substring operation) and is then output via response.getWriter().printf() with X-XSS-Protection disabled. The param value is passed to printf as a format string, allowing an attacker to inject malicious JavaScript that will be executed in the victim's browser.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar. Additionally, avoid using user input as a format string in printf - use a fixed format string with user data as arguments.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02132.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via println with user input\n\nUser-controlled input from request parameter 'BenchmarkTest02132' flows through a propagation chain in doSomething() and is output via response.getWriter().println() with X-XSS-Protection disabled. The ThingFactory.createThing().doSomething() is a pass-through that returns its input unchanged, so the tainted user input reaches the response output.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar sanitization methods.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02133.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via println with user input\n\nUser-controlled input from request parameter 'BenchmarkTest02133' flows through doSomething() where a ternary condition evaluates to false ((7*42)-106 = 188, which is NOT > 200), assigning param to bar. This tainted value is then output via response.getWriter().println() with X-XSS-Protection disabled.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar sanitization methods.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02134.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via write with user input\n\nUser-controlled input from request parameter 'BenchmarkTest02134' flows through doSomething() (which only performs substring operation) and is then output via response.getWriter().write(bar.toCharArray()) with X-XSS-Protection disabled.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar sanitization methods.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02136.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via write with user input\n\nUser-controlled input from request parameter 'BenchmarkTest02136' flows through doSomething() where a ternary condition evaluates to false ((7*42)-106 = 188, which is NOT > 200), assigning param to bar. This tainted value is then output via response.getWriter().write() with X-XSS-Protection disabled.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in the context of the victim's browser session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using ESAPI.encoder().encodeForHTML() or similar sanitization methods.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02138.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random().nextBytes() to generate a 'rememberMe' cookie value used for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, allowing an attacker to guess or brute-force valid session tokens.\n\nImpact: An attacker can predict or brute-force valid 'rememberMe' tokens, allowing them to impersonate legitimate users and gain unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02139.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value used for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, allowing an attacker to guess or brute-force valid session tokens.\n\nImpact: An attacker can predict or brute-force valid 'rememberMe' tokens, allowing them to impersonate legitimate users and gain unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens: new java.security.SecureRandom().nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02140.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value used for authentication purposes. java.util.Random is not cryptographically secure and produces predictable values, allowing an attacker to guess or brute-force valid session tokens.\n\nImpact: An attacker can predict or brute-force valid 'rememberMe' tokens, allowing them to impersonate legitimate users and gain unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens: new java.security.SecureRandom().nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02145.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Reflected\n\nUser input from request parameter 'BenchmarkTest02145' flows through doSomething() and is written directly to the HTTP response without proper encoding. The response header 'X-XSS-Protection' is explicitly set to '0', disabling browser XSS protections. The ThingFactory.createThing().doSomething() is a pass-through that returns its input unchanged, so the tainted user input reaches the response output.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: Encode user input before writing to the response using ESAPI or similar: `response.getWriter().write(\"Parameter value: \" + ESAPI.encoder().encodeForHTML(bar));`. Also remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02192.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\", \"SunJCE\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use KeyGenerator.getInstance(\"AES\") with a 256-bit key and GCMParameterSpec for authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02193.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\", \"SunJCE\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use KeyGenerator.getInstance(\"AES\") with a 256-bit key and GCMParameterSpec for authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02194.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use KeyGenerator.getInstance(\"AES\") with a 256-bit key and GCMParameterSpec for authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02195.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use KeyGenerator.getInstance(\"AES\") with a 256-bit key and GCMParameterSpec for authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02197.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request parameter 'BenchmarkTest02197' flows through doSomething() where it is stored in a HashMap and retrieved as bar. This tainted value is then used directly in file path construction: new java.io.File(new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR), bar). An attacker can use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check existence of arbitrary files on the filesystem by using path traversal sequences, potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate that the file path does not contain '..' or other path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory before file operations.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02198.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request parameter 'BenchmarkTest02198' flows through doSomething() where the switch target is 'ABC'.charAt(2) which equals 'C', matching case 'C' that assigns param to bar. This tainted value is then used directly in file path construction: new java.io.File(org.owasp.benchmark.helpers.Utils.TESTFILES_DIR, bar). An attacker can use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check existence of arbitrary files on the filesystem by using path traversal sequences, potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate that the file path does not contain '..' or other path traversal sequences. Use Path.normalize() and verify the resolved path starts with the expected base directory before file operations.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02199.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request parameter 'BenchmarkTest02199' flows directly through doSomething() where it is assigned to bar without any sanitization. This tainted value is then used directly in file path construction: new java.io.File(bar). An attacker can provide absolute paths or path traversal sequences to access arbitrary files on the filesystem.\n\nImpact: An attacker can read, write, or check existence of arbitrary files on the filesystem by providing absolute paths or path traversal sequences, potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate that the file path does not contain '..' or other path traversal sequences. Restrict to relative paths only and use Path.normalize() with verification that the resolved path starts with the expected base directory before file operations.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02205.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input flows directly into a file path without validation. The doSomething method evaluates the condition (500/42)+196 > 200, which equals 11+196=207 > 200 (true), so bar is assigned param (user input). This tainted value is then used to construct a file path in line 60: fileName = Utils.TESTFILES_DIR + bar. An attacker can use path traversal sequences like '../../../etc/passwd' to access arbitrary files.\n\nImpact: An attacker can read or write arbitrary files on the server filesystem by manipulating the BenchmarkTest02205 parameter with path traversal sequences.\n\nFix: Validate and sanitize the file path. Use Path.normalize() and verify the resolved path starts with the expected base directory. Reject inputs containing '..' or absolute path indicators.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02208.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input in Filter\n\nUser input flows into an LDAP search filter without sanitization. The doSomething method evaluates guess.charAt(2) which equals 'C' (from \"ABC\"), triggering case 'C' which assigns bar = param. This tainted value is then concatenated directly into the LDAP filter string: \"(&(objectclass=person))(|(uid=\" + bar + \")(street={0}))\". An attacker can inject LDAP metacharacters to modify the query logic.\n\nImpact: An attacker can bypass authentication, extract sensitive directory information, or modify the LDAP query to return unauthorized data by injecting LDAP filter metacharacters like *, ), (, |, &.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize user input before including it in LDAP filters, or use parameterized LDAP queries if supported by your LDAP library.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02221.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via format() output\n\nUser input from request parameter 'BenchmarkTest02221' flows through doSomething() (which only replaces the last character with 'Z', preserving the tainted prefix) and is output to the HTTP response body via out.format(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript that will execute in the victim's browser.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using OWASP Java Encoder or similar: out.format(java.util.Locale.US, \"Formatted like: %1$s and %2$s.\", new Object[]{\"a\", Encode.forHtml(bar)});",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02223.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via format() output\n\nUser input from request parameter 'BenchmarkTest02223' flows through doSomething() which appends '_SafeStuff' but preserves the tainted user input as a prefix. This tainted value is then output to the HTTP response body via response.getWriter().format(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using OWASP Java Encoder: response.getWriter().format(\"Formatted like: %1$s and %2$s.\", new Object[]{\"a\", Encode.forHtml(bar)});",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02224.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via format() output\n\nUser input from request parameter 'BenchmarkTest02224' flows through doSomething() where the condition (500/42) + 196 = 207 > 200 evaluates to true, causing bar to be assigned the tainted param value. This is then output to the HTTP response body via response.getWriter().format(). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using OWASP Java Encoder: response.getWriter().format(\"Formatted like: %1$s and %2$s.\", new Object[]{\"a\", Encode.forHtml(bar)});",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02225.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via user-controlled format string\n\nUser input from request parameter 'BenchmarkTest02225' is stored in a HashMap and retrieved into bar, which is then used as the format string in response.getWriter().format(bar, obj). This allows an attacker to control the format string itself, not just the data. The X-XSS-Protection header is explicitly disabled. An attacker can inject format specifiers and malicious JavaScript.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's session and potentially exploit format string vulnerabilities to read memory or cause application errors.\n\nFix: Never use user input as a format string. Use a fixed format string and pass user data as arguments: response.getWriter().format(\"Formatted like: %1$s and %2$s.\", new Object[]{\"a\", Encode.forHtml(bar)});",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02227.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via print() output\n\nUser input from request parameter 'BenchmarkTest02227' flows through doSomething() which appends '_SafeStuff' but preserves the tainted user input as a prefix. This tainted value is then output to the HTTP response body via response.getWriter().print(bar.toCharArray()). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using OWASP Java Encoder: response.getWriter().print(Encode.forHtml(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02228.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via print() output\n\nUser input from request parameter 'BenchmarkTest02228' flows through doSomething() which appends '_SafeStuff' but preserves the tainted user input as a prefix. This tainted value is then output to the HTTP response body via response.getWriter().print(bar). The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using OWASP Java Encoder: response.getWriter().print(Encode.forHtml(bar));",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02230.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via printf() output\n\nUser input from request parameter 'BenchmarkTest02230' flows through doSomething() (which only replaces the last character with 'Z', preserving the tainted prefix) and is output to the HTTP response body via response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript.\n\nImpact: An attacker can execute arbitrary JavaScript in the context of the victim's session, potentially stealing session cookies, performing actions on behalf of the user, or redirecting to malicious sites.\n\nFix: HTML-encode the user input before including it in the response using OWASP Java Encoder: response.getWriter().printf(java.util.Locale.US, \"Formatted like: %1$s and %2$s.\", new Object[]{\"a\", Encode.forHtml(bar)});",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02236.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) in HTTP Response\n\nThe arithmetic condition (7*42) - 86 = 208, and 208 > 200 is true, so bar is assigned the constant 'This_should_always_happen'. However, the code structure shows param would flow to output if the condition were false. The current implementation is safe due to the constant condition.\n\nImpact: No current vulnerability as the condition always evaluates to true, assigning a safe constant.\n\nFix: The current code is safe, but the pattern is confusing. Consider simplifying to directly assign the constant if that's the intended behavior.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02239.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) in HTTP Response\n\nAfter list operations (add 'safe', add param, add 'moresafe', remove index 0), the list becomes [param, 'moresafe']. valuesList.get(1) retrieves 'moresafe' (a safe constant), not the user input. The current data flow is safe.\n\nImpact: No vulnerability in current implementation as the retrieved value is a safe constant.\n\nFix: The current code is safe. No changes needed for security, though the logic could be clearer.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02241.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from request parameter 'BenchmarkTest02241' is written directly to the HTTP response without sanitization. The code disables XSS protection with 'X-XSS-Protection: 0' header and writes user input via response.getWriter().write(bar). The doSomething method performs a deterministic switch on guess.charAt(2) where guess='ABC', so charAt(2)='C'. The switch case 'C' assigns bar=param, making bar tainted. The tainted value flows directly to the response output.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in victims' browsers, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02245.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security Token\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values. An attacker can predict the random values and forge session cookies.\n\nImpact: An attacker can predict session tokens and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive random values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02246.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security Token\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values. An attacker can predict the random values and forge session cookies.\n\nImpact: An attacker can predict session tokens and hijack user sessions, leading to unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive random values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02261.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled data from request parameter 'BenchmarkTest02261' is stored directly into HttpSession using putValue() where the user input controls the session key name. The doSomething() method applies HtmlUtils.htmlEscape() to the parameter, but HTML escaping does NOT prevent trust boundary violations. The escaped user input is then used as the session attribute name via request.getSession().putValue(bar, \"10340\"), allowing an attacker to control session key names.\n\nImpact: An attacker can manipulate session attribute names, potentially overwriting critical session data, causing session fixation, or interfering with application logic that relies on specific session keys.\n\nFix: Never use user input as session attribute names. Use a fixed, application-controlled key name and store user data as the value only after proper validation. Example: request.getSession().putValue(\"userInput\", sanitizedValue).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02262.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - Unvalidated User Data in Session\n\nUser-controlled data from request parameter 'BenchmarkTest02262' is stored directly into HttpSession using putValue() without proper validation. The doSomething() method applies HtmlUtils.htmlEscape() to the parameter, but HTML escaping does NOT prevent trust boundary violations - it only protects against XSS. The escaped but still user-controlled data is stored in the session via request.getSession().putValue(\"userid\", bar), crossing the trust boundary from untrusted user input to trusted session storage.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or manipulation of application logic that trusts session data.\n\nFix: Validate and sanitize user input before storing in session. Implement strict input validation (whitelist allowed characters/patterns), length limits, and consider using application-controlled identifiers instead of raw user input.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02263.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled data from request parameter 'BenchmarkTest02263' is used as the session attribute key name. The doSomething() method evaluates the ternary condition (7*42) - 106 > 200, which equals 188 > 200 = false, so bar is assigned param (user input). This user-controlled value is then used as the session key via request.getSession().setAttribute(bar, \"10340\"), allowing attackers to control session attribute names.\n\nImpact: An attacker can manipulate session attribute names, potentially overwriting critical session data, causing session fixation, or interfering with application logic that relies on specific session keys.\n\nFix: Never use user input as session attribute names. Use a fixed, application-controlled key name and store user data as the value only after proper validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02290.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This makes any data encrypted with DES vulnerable to decryption by attackers.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques. This compromises the confidentiality of any data protected by this encryption, including passwords and other sensitive information stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 encryption. Use: Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256. AES-GCM provides both confidentiality and authenticity.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02291.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\", \"SunJCE\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This makes any data encrypted with DES vulnerable to decryption by attackers.\n\nImpact: An attacker can decrypt sensitive data that was encrypted using DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256, and use a unique IV for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02292.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\", \"SunJCE\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data that was encrypted using DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256, and use a unique IV for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02293.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data that was encrypted using DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256, and use a unique IV for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02294.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data that was encrypted using DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256, and use a unique IV for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02295.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware.\n\nImpact: An attacker can decrypt sensitive data that was encrypted using DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with a strong encryption algorithm such as AES-256 with GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256, and use a unique IV for each encryption operation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02302.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Parameter Name\n\nThe application uses a user-controlled parameter name directly in file path construction. The parameter name (not value) is extracted when a parameter value equals 'BenchmarkTest02302', then passed through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and used to construct a File object. An attacker can submit a parameter with a name like '../../../etc/passwd' to traverse directories.\n\nImpact: An attacker can read arbitrary files on the system by manipulating the parameter name to include path traversal sequences, potentially accessing sensitive configuration files, credentials, or other protected data.\n\nFix: Validate and sanitize the parameter name before using it in file operations. Use a whitelist of allowed characters, reject names containing '..' or path separators, or use Path.normalize() with startsWith() validation against a base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02303.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Parameter Name in Switch Statement\n\nThe application extracts a user-controlled parameter name and passes it through a switch statement. The switch target is 'ABC'.charAt(2) which equals 'C', matching case 'C' which assigns param to bar. This tainted value is then used in file path construction with FileInputStream, allowing path traversal attacks.\n\nImpact: An attacker can read arbitrary files on the system by submitting a parameter name containing path traversal sequences like '../../../etc/passwd', potentially accessing sensitive system files.\n\nFix: Validate the parameter name before using it in file operations. Implement path traversal protection by checking for '..' sequences, using Path.normalize() with base directory validation, or maintaining a whitelist of allowed file names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02304.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled Parameter Name After List Manipulation\n\nThe application extracts a user-controlled parameter name, adds it to a list ['safe', param, 'moresafe'], removes index 0, then retrieves index 0 from the modified list. After removal, the list becomes [param, 'moresafe'], so get(0) returns the tainted param value. This is then used in FileInputStream construction, enabling path traversal.\n\nImpact: An attacker can read arbitrary files by submitting a parameter name with path traversal sequences, potentially accessing sensitive configuration files, credentials, or system files.\n\nFix: Validate and sanitize the parameter name before file operations. Check for path traversal patterns ('..' or '../'), use canonical path validation, or restrict to a whitelist of allowed file names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02305.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via User-Controlled Parameter Name\n\nThe application extracts a user-controlled parameter name, adds it to a list, removes the first element, then retrieves index 0 (which is now the param). This tainted value is concatenated directly into an LDAP filter string without sanitization: 'String filter = \"(&(objectclass=person))(|(uid=\" + bar + \")(street={0}))\";'. An attacker can inject LDAP filter metacharacters.\n\nImpact: An attacker can manipulate the LDAP query to bypass authentication, extract unauthorized data, or enumerate directory information by injecting LDAP filter syntax like '*)(uid=*))(|(uid=*' in the parameter name.\n\nFix: Use parameterized LDAP queries or properly escape LDAP special characters. ESAPI provides encodeForLDAP() for this purpose. Alternatively, validate input to reject LDAP metacharacters like *, (, ), &, |, =, !, <, >, ~.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02306.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via User-Controlled Parameter Name Through Pass-Through\n\nThe application extracts a user-controlled parameter name and passes it through ThingFactory.createThing().doSomething() (a pass-through returning input unchanged). The tainted value is then concatenated directly into an LDAP filter: 'String filter = \"(&(objectclass=person)(uid=\" + bar + \"))\";' without sanitization, enabling LDAP injection attacks.\n\nImpact: An attacker can inject LDAP filter syntax through the parameter name to bypass authentication, extract unauthorized directory data, or enumerate users by submitting values like '*)(uid=admin' or '*)(&(objectclass=*'.\n\nFix: Sanitize the input using ESAPI.encoder().encodeForLDAP() before concatenating into the LDAP filter, or use parameterized LDAP queries. Validate input to reject LDAP special characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02311.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - MD5\n\nThe code uses MD5 (MessageDigest.getInstance(\"MD5\")) for hashing sensitive data. MD5 is cryptographically broken and vulnerable to collision attacks. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially generate collisions, forge hash values, or reverse the hash to recover sensitive data. This is particularly critical when hashing passwords or other sensitive information.\n\nFix: Replace MD5 with a strong cryptographic hash function like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02313.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via format() with User Input\n\nUser-controlled input (param from request parameter name) flows through doSomething() and is included in the HTTP response via out.format(). The response header 'X-XSS-Protection' is set to '0', disabling browser XSS protection. Although doSomething() assigns a static string 'barbarians_at_the_gate' to g31085 and passes it through thing.doSomething(), the final bar value is 'barbarians_at_the_gate' (safe constant), not the user input.\n\nImpact: If the data flow were to change to include user input, an attacker could inject malicious JavaScript that executes in victims' browsers, potentially stealing session tokens, credentials, or performing actions on behalf of users.\n\nFix: Even though the current implementation uses a safe constant, the pattern is dangerous. Always encode user input before including in HTML responses using ESAPI.encoder().encodeForHTML() or similar. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02321.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name\n\nUser-controlled parameter name flows through ThingFactory.createThing().doSomething() (a pass-through) and is output to the HTTP response via printf(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by crafting a parameter name containing script tags.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or defacing the page.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response. Alternatively, validate that parameter names contain only expected characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02322.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name\n\nUser-controlled parameter name is assigned to bar via a ternary condition that evaluates to false ((7*42)-106=188, 188>200 is false), then output to the HTTP response via printf(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by crafting a parameter name containing script tags.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or defacing the page.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response. Alternatively, validate that parameter names contain only expected characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02323.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name\n\nUser-controlled parameter name flows through ThingFactory.createThing().doSomething() (a pass-through) and is output to the HTTP response via printf(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by crafting a parameter name containing script tags.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or defacing the page.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response. Alternatively, validate that parameter names contain only expected characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02324.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name\n\nUser-controlled parameter name has its last character replaced with 'Z' but remains tainted, then is output to the HTTP response via printf(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by crafting a parameter name containing script tags.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or defacing the page.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response. Alternatively, validate that parameter names contain only expected characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02326.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name\n\nUser-controlled parameter name is Base64 encoded then decoded (a pass-through operation) and output to the HTTP response via write(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by crafting a parameter name containing script tags.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or defacing the page.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response. Alternatively, validate that parameter names contain only expected characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02327.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name\n\nUser-controlled parameter name is placed in a list, the first element is removed, then get(0) retrieves the parameter (now at index 0), which is output to the HTTP response via write(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by crafting a parameter name containing script tags.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or defacing the page.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response. Alternatively, validate that parameter names contain only expected characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02328.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Parameter Name\n\nUser-controlled parameter name is directly assigned to bar and output to the HTTP response via write(). The X-XSS-Protection header is explicitly disabled. An attacker can inject malicious JavaScript by crafting a parameter name containing script tags.\n\nImpact: An attacker can execute arbitrary JavaScript in the victim's browser, potentially stealing session cookies, performing actions on behalf of the user, or defacing the page.\n\nFix: HTML-encode the output using ESAPI.encoder().encodeForHTML() or similar before writing to the response. Alternatively, validate that parameter names contain only expected characters.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02332.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Reflected User Input\n\nUser-controlled parameter name flows unsanitized into the HTTP response body. The ternary condition `(7 * 42) - 106 > 200` evaluates to `188 > 200` which is false, causing `bar = param` to execute. The tainted value is then written directly to the response via `response.getWriter().write(bar)` with XSS protection disabled.\n\nImpact: An attacker can inject malicious JavaScript that executes in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: Apply HTML encoding using `ESAPI.encoder().encodeForHTML(bar)` before writing to the response, or use a templating engine with automatic escaping.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02337.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe code uses `java.util.Random().nextLong()` to generate a 'rememberMe' session key. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable.\n\nImpact: An attacker can predict or brute-force the rememberMe token values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace `java.util.Random` with `java.security.SecureRandom` for all security-sensitive random number generation: `new java.security.SecureRandom().nextLong()`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02338.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe code uses `java.util.Random().nextLong()` to generate a 'rememberMe' session key. java.util.Random is not cryptographically secure and produces predictable values, making session tokens guessable.\n\nImpact: An attacker can predict or brute-force the rememberMe token values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace `java.util.Random` with `java.security.SecureRandom` for all security-sensitive random number generation: `new java.security.SecureRandom().nextLong()`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02352.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input as Session Attribute Key\n\nUser-controlled data from request parameter name flows through thing.doSomething() (a pass-through) and is used as the key name in HttpSession.setAttribute(bar, \"10340\"). This allows an attacker to control session attribute names, potentially overwriting security-critical session data.\n\nImpact: An attacker can manipulate session state by controlling attribute key names, potentially leading to privilege escalation, session fixation, or bypassing security controls that rely on specific session attributes.\n\nFix: Do not use user-controlled data as session attribute keys. Use a fixed, application-controlled key name instead. If dynamic keys are required, validate against a strict whitelist of allowed key names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02373.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: An attacker could decrypt sensitive data encrypted with DES, compromising confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: `Cipher.getInstance(\"AES/GCM/NoPadding\")` with a 256-bit key.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02374.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: An attacker could decrypt sensitive data encrypted with DES, compromising confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: `Cipher.getInstance(\"AES/GCM/NoPadding\")` with a 256-bit key.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02377.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input from request parameter flows directly into a File constructor without validation. The 'param' value is passed through doSomething() which returns it unchanged, allowing an attacker to specify arbitrary file paths including '../' sequences.\n\nImpact: An attacker could access files outside the intended directory by using path traversal sequences (e.g., '../../../etc/passwd'), potentially reading sensitive system files or application configuration.\n\nFix: Validate and sanitize the file path. Use canonical path validation: `File file = new File(baseDir, userInput); if (!file.getCanonicalPath().startsWith(baseDir.getCanonicalPath())) { throw new SecurityException(); }`",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02378.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input flows through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) into a file URI construction without validation. An attacker can inject path traversal sequences.\n\nImpact: An attacker could access files outside the intended directory by using path traversal sequences, potentially reading sensitive system files or application configuration.\n\nFix: Validate and sanitize the file path. Use canonical path validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02380.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal\n\nUser-controlled input flows into a file path construction. Although the doSomething() method performs complex transformations, the final value 'bar' is assigned from a static string 'barbarians_at_the_gate' (g76789), making this specific instance safe. However, the pattern is vulnerable if the static assignment changes.\n\nImpact: If the code were modified to allow user input to reach the file path, an attacker could access files outside the intended directory using path traversal sequences.\n\nFix: Even though currently safe, add explicit path validation: use canonical path checking to ensure the resolved path stays within TESTFILES_DIR.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02383.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from request parameter flows through a HashMap and is directly concatenated into a file path without validation. The doSomething method retrieves user input from 'keyB-53518' and returns it as bar, which is then used to construct a file path. An attacker can use path traversal sequences like '../' to access files outside the intended directory.\n\nImpact: An attacker can read or write arbitrary files on the server filesystem by manipulating the file path, potentially leading to unauthorized file access, data disclosure, or system compromise.\n\nFix: Validate and sanitize the file path input. Use Path.normalize() and verify the resolved path starts with the expected base directory. Alternatively, use a whitelist of allowed filenames or reject inputs containing path traversal sequences like '../' or '..\\'.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02384.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection via Unsanitized User Input in Filter\n\nUser input flows into an LDAP filter string via string concatenation without sanitization. While the doSomething method attempts to retrieve a 'safe' value from index 1 after removing index 0, the list mutation analysis shows: initial list is ['safe', param, 'moresafe'], after remove(0) it becomes [param, 'moresafe'], so get(1) returns 'moresafe' which is safe. However, reviewing the code more carefully: valuesList.add('safe'), valuesList.add(param), valuesList.add('moresafe'), then remove(0) removes 'safe', leaving [param, 'moresafe']. Then get(1) retrieves 'moresafe'. This is actually safe.\n\nImpact: None - the code is actually safe due to the list manipulation retrieving a constant value.\n\nFix: No action needed - the current implementation correctly retrieves a safe constant value.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02415.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator in BenchmarkTest02415\n\nThe code uses java.util.Random().nextBytes() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02416.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator in BenchmarkTest02416\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02417.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator in BenchmarkTest02417\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02418.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator in BenchmarkTest02418\n\nThe code uses java.util.Random().nextDouble() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02419.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator in BenchmarkTest02419\n\nThe code uses java.util.Random().nextFloat() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: new java.security.SecureRandom().nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02420.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator in BenchmarkTest02420\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session tokens.\n\nImpact: An attacker can predict the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for generating security-sensitive random values: new java.security.SecureRandom().nextGaussian();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02446.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Attribute Name\n\nUser-controlled data from request parameter 'BenchmarkTest02446' flows through doSomething() and is used as the session attribute name in putValue(). The condition (500/42)+196=207>200 evaluates to true, causing bar to be assigned param. This allows an attacker to control which session attribute is set, potentially overwriting security-critical session data.\n\nImpact: An attacker can manipulate session attribute names to overwrite security-critical session variables such as user roles, authentication tokens, or authorization flags, leading to privilege escalation or session hijacking.\n\nFix: Never use user input as session attribute names. Use a fixed, hardcoded attribute name and store the user input as the value only after proper validation. If dynamic attribute names are required, use a whitelist of allowed names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02448.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Attribute Name\n\nUser-controlled data from request parameter 'BenchmarkTest02448' flows through doSomething() and is used as the session attribute name in setAttribute(). The switch statement evaluates guess.charAt(2) which equals 'C', matching case 'C' and assigning param to bar. This allows an attacker to control which session attribute is set.\n\nImpact: An attacker can manipulate session attribute names to overwrite security-critical session variables such as user roles, authentication tokens, or authorization flags, leading to privilege escalation or session hijacking.\n\nFix: Never use user input as session attribute names. Use a fixed, hardcoded attribute name and store the user input as the value only after proper validation. If dynamic attribute names are required, use a whitelist of allowed names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02458.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5PADDING\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically weak.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and computing power, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 encryption. Use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02463.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User Input\n\nUser-controlled input from request parameter 'BenchmarkTest02463' flows directly into file path construction without validation. The doSomething method performs arithmetic evaluation: (500/42) + 196 = 11 + 196 = 207, which is > 200, so bar = param. This tainted value is then used to construct a file path, allowing an attacker to access arbitrary files via path traversal sequences like '../../../etc/passwd'.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the BenchmarkTest02463 parameter with path traversal sequences, potentially exposing sensitive configuration files, credentials, or source code.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed filenames, check for path traversal sequences ('../'), or use Path.normalize() with startsWith() validation to ensure the resolved path stays within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02465.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User Input\n\nUser-controlled input from request parameter 'BenchmarkTest02465' flows into file path construction. The doSomething method uses a ternary: (7*42) - 106 = 294 - 106 = 188, and 188 > 200 is FALSE, so bar = param. This tainted value is concatenated with TESTFILES_DIR and used to open a FileInputStream, allowing path traversal attacks.\n\nImpact: An attacker can read arbitrary files on the server by providing path traversal sequences in the BenchmarkTest02465 parameter, potentially accessing sensitive system files or application configuration.\n\nFix: Implement path validation to prevent directory traversal. Check for '../' sequences, use canonical path validation, or maintain a whitelist of allowed file names.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02466.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User Input\n\nUser-controlled input from request parameter 'BenchmarkTest02466' flows into file path construction. The doSomething method evaluates: guess.charAt(2) = 'C' (from 'ABC'), which matches case 'C', so bar = param. This tainted value is used to construct a file path for FileInputStream, enabling path traversal attacks.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the BenchmarkTest02466 parameter with path traversal sequences, potentially exposing sensitive data.\n\nFix: Validate file paths to prevent traversal attacks. Use canonical path validation with startsWith() checks, reject inputs containing '../', or use a whitelist approach.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02469.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User Input\n\nUser-controlled input from request parameter 'BenchmarkTest02469' flows through Base64 encode/decode (which is a pass-through operation) and is then used to construct a file path for FileOutputStream. The doSomething method returns the user input after Base64 round-trip, which doesn't sanitize path traversal sequences.\n\nImpact: An attacker can write to arbitrary files on the server by providing path traversal sequences in the BenchmarkTest02469 parameter, potentially overwriting critical system files or application code.\n\nFix: Implement strict path validation. Reject inputs containing path traversal sequences, use canonical path validation, or restrict file operations to a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02471.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nThe application constructs a file path using user-controlled input without proper validation. The doSomething method evaluates (7*42)-86 = 208, which is greater than 200, so bar is assigned the constant 'This_should_always_happen'. However, the data flow analysis shows this is safe in the current implementation.\n\nImpact: An attacker could potentially access arbitrary files on the server filesystem by manipulating the input parameter.\n\nFix: Validate and sanitize the file path input. Use a whitelist of allowed files or implement proper path canonicalization with startsWith() validation against the base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_90.CWE-90",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02472.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "LDAP Injection Vulnerability\n\nUser-controlled input is directly concatenated into an LDAP filter string without sanitization. The doSomething method performs Base64 encode/decode which does not sanitize LDAP metacharacters. The filter string '(&(objectclass=person))(|(uid=' + bar + ')(street={0}))' allows injection of LDAP filter syntax.\n\nImpact: An attacker could manipulate the LDAP query to bypass authentication, access unauthorized data, or enumerate directory information.\n\nFix: Use ESAPI.encoder().encodeForLDAP() to sanitize the input before constructing the LDAP filter, or use parameterized LDAP queries if available.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-90"
          ],
          "owasp": "A1: Injection"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02480.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS)\n\nUser-controlled input is written directly to the HTTP response without sanitization. The doSomething method evaluates (7*42)-106 = 188, which is NOT greater than 200, so bar is assigned param (user input). The response header 'X-XSS-Protection: 0' disables browser XSS protection, and response.getWriter().print(bar.toCharArray()) outputs the tainted data.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in victims' browsers, potentially stealing session cookies, credentials, or performing actions on behalf of the user.\n\nFix: Use ESAPI.encoder().encodeForHTML() to sanitize the output before writing to the response, or use a templating engine with automatic escaping enabled.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02483.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from request parameter 'BenchmarkTest02483' flows directly into the HTTP response without sanitization. The doSomething method returns the param unchanged (bar = param), and this is written to the response via response.getWriter().print(bar). The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02486.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response with printf\n\nUser-controlled input from request parameter 'BenchmarkTest02486' is manipulated (last character replaced with 'Z') but remains tainted. The bar variable containing user input is placed in an Object array and output via response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02487.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Pass-Through Method in HTTP Response\n\nUser-controlled input from request parameter 'BenchmarkTest02487' flows through ThingFactory.createThing().doSomething(param), which is a pass-through method that returns its input unchanged. The tainted bar variable is placed in an Object array and output via response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02489.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser-controlled input from request parameter 'BenchmarkTest02489' flows directly into the format string parameter of response.getWriter().printf(bar, obj). The doSomething method returns param unchanged (bar = param). This allows an attacker to control the format string itself, not just the arguments. The X-XSS-Protection header is explicitly disabled, confirming XSS vulnerability.\n\nImpact: An attacker can inject malicious JavaScript code via format string manipulation that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement. The attacker controls the format string itself, which is more dangerous than controlling format arguments.\n\nFix: Never allow user input to control the format string. Use a fixed format string and pass user data only as arguments. Apply HTML encoding using ESAPI.encoder().encodeForHTML() before including user data in the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02493.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unsanitized User Input\n\nUser input from request parameter 'BenchmarkTest02493' is stored in a HashMap and then retrieved without sanitization. The tainted data flows directly to the HTTP response via response.getWriter().write(). The X-XSS-Protection header is explicitly disabled, making XSS exploitation straightforward.\n\nImpact: An attacker can inject malicious JavaScript that executes in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: Apply HTML encoding using ESAPI.encoder().encodeForHTML() or similar before writing user input to the response. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02494.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Direct User Input Echo\n\nUser input from request parameter 'BenchmarkTest02494' undergoes only trivial string manipulation (replacing the last character) before being written directly to the HTTP response. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript that executes in victims' browsers, enabling session hijacking, credential theft, or other client-side attacks.\n\nFix: Apply proper HTML encoding using ESAPI.encoder().encodeForHTML() or equivalent before outputting user input. Remove the X-XSS-Protection: 0 header.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02497.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random.nextDouble() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, allowing attackers to guess or brute-force valid session tokens.\n\nImpact: An attacker can predict session tokens and hijack user sessions, gaining unauthorized access to user accounts without valid credentials.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random value generation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02498.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random.nextDouble() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker can predict session tokens and hijack user sessions, gaining unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic token generation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02499.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random.nextFloat() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker can predict session tokens and hijack user sessions, gaining unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random value generation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02500.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random.nextGaussian() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker can predict session tokens and hijack user sessions, gaining unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic token generation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02501.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextInt() to generate a security-sensitive 'rememberMe' token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions by forging authentication cookies.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom sr = new SecureRandom(); int r = sr.nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02502.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextInt() to generate a security-sensitive 'rememberMe' token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions by forging authentication cookies.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom sr = new SecureRandom(); int r = sr.nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02503.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextInt() to generate a security-sensitive 'rememberMe' token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions by forging authentication cookies.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom sr = new SecureRandom(); int r = sr.nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02504.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextInt() to generate a security-sensitive 'rememberMe' token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions by forging authentication cookies.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom sr = new SecureRandom(); int r = sr.nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02505.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextLong() to generate a security-sensitive 'rememberMe' token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions by forging authentication cookies.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom sr = new SecureRandom(); long l = sr.nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02506.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.util.Random().nextLong() to generate a security-sensitive 'rememberMe' token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values and hijack user sessions by forging authentication cookies.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom sr = new SecureRandom(); long l = sr.nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02524.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest02524' is stored directly into the HttpSession via putValue() without validation. The doSomething() method adds param to a list, removes the first element, then retrieves param at index 0, which is still user-controlled data. This data is then stored in the session with key 'userid'.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement proper input validation to ensure only expected values are stored in trusted session storage.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02525.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest02525' is stored directly into the HttpSession via putValue() without validation. The doSomething() method passes param through ThingFactory.createThing().doSomething(), which is a pass-through that returns the input unchanged. This user-controlled data is then stored in the session with key 'userid'.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement proper input validation to ensure only expected values are stored in trusted session storage.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02526.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest02526' is stored directly into the HttpSession via putValue() without proper validation. Although the doSomething() method applies HtmlUtils.htmlEscape() to the param, HTML escaping does NOT prevent trust boundary violations (CWE-501). HTML escaping only protects against XSS, not against storing untrusted data in a trusted context like the session.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. HTML escaping is insufficient for trust boundary protection. Implement proper input validation to ensure only expected values are stored in trusted session storage.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02527.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input as Session Key\n\nUser-controlled data from request parameter 'BenchmarkTest02527' is used as the session attribute KEY via setAttribute(). The doSomething() method evaluates guess.charAt(2) which is 'C', and the switch statement assigns bar = param for case 'C'. This allows the user to control the session key name, which is a trust boundary violation.\n\nImpact: An attacker can control session key names, potentially overwriting critical session attributes, causing session poisoning, or interfering with application logic that relies on specific session keys.\n\nFix: Never allow user input to control session key names. Use fixed, application-defined keys for session attributes. Validate and sanitize user input before storing it as session values (not keys).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02548.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically insecure.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and computing power, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated with KeyGenerator.getInstance(\"AES\") and a 128-bit authentication tag with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02549.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically insecure.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and computing power, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated with KeyGenerator.getInstance(\"AES\") and a 128-bit authentication tag with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02550.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that is vulnerable to brute-force attacks and is considered cryptographically insecure.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using readily available tools and computing power, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated with KeyGenerator.getInstance(\"AES\") and a 128-bit authentication tag with GCMParameterSpec.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02555.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the query string is Base64 encoded and decoded (which returns the original value unchanged) and then directly used to construct a File object without any path traversal validation. An attacker can supply path traversal sequences like '../../../etc/passwd' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check the existence of arbitrary files on the server filesystem, potentially accessing sensitive configuration files, credentials, or other protected resources.\n\nFix: Validate that the file path does not contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the intended base directory, or use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02556.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the query string flows through a conditional that evaluates to true ((500/42) + 196 = 207 > 200), assigning the user parameter directly to 'bar'. This user-controlled value is then used to construct a File object without any path traversal validation. An attacker can supply path traversal sequences like '../../../etc/passwd' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check the existence of arbitrary files on the server filesystem, potentially accessing sensitive configuration files, credentials, or other protected resources.\n\nFix: Validate that the file path does not contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the intended base directory, or use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02559.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the query string is passed through ThingFactory.createThing().doSomething(), which is a pass-through method that returns the input unchanged. This user-controlled value is then used to construct a file URI without any path traversal validation. An attacker can supply path traversal sequences like '../../../etc/passwd' to access files outside the intended directory.\n\nImpact: An attacker can read, write, or check the existence of arbitrary files on the server filesystem, potentially accessing sensitive configuration files, credentials, or other protected resources.\n\nFix: Validate that the file path does not contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the intended base directory, or use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02560.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal via User-Controlled File Path\n\nUser input from the query string flows through a ternary conditional that evaluates to false ((7*42) - 106 = 188 is NOT > 200), assigning the user parameter directly to 'bar'. This user-controlled value is then concatenated with TESTFILES_DIR and used to open a FileInputStream without any path traversal validation. An attacker can supply path traversal sequences like '../../../etc/passwd' to access files outside the intended directory.\n\nImpact: An attacker can read arbitrary files on the server filesystem, potentially accessing sensitive configuration files, credentials, source code, or other protected resources.\n\nFix: Validate that the file path does not contain path traversal sequences. Use Path.normalize() and verify the resolved path starts with the intended base directory, or use a whitelist of allowed filenames.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02561.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in FileInputStream\n\nUser-controlled input from the query string flows through doSomething() and is used to construct a file path without validation. The doSomething() method creates a list ['safe', param, 'moresafe'], removes index 0, then retrieves index 0 which now contains the tainted param value. This allows an attacker to read arbitrary files using path traversal sequences like '../../../etc/passwd'.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the BenchmarkTest02561 query parameter with path traversal sequences, potentially exposing sensitive configuration files, source code, or system files.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory. Alternatively, use Path.normalize() and check that the resolved path is within the intended directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02562.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in FileInputStream\n\nUser-controlled input from the query string flows through doSomething() and is used to construct a file path without validation. The doSomething() method evaluates (7*42) - 106 = 188, and since 188 > 200 is false, it assigns param to bar. This allows an attacker to read arbitrary files using path traversal sequences.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the BenchmarkTest02562 query parameter with path traversal sequences like '../../../etc/passwd', potentially exposing sensitive data.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02564.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in FileOutputStream\n\nUser-controlled input from the query string flows through doSomething() and is used to construct a file path without validation. The doSomething() method evaluates guess.charAt(2) which equals 'C', and the switch statement assigns param to bar in case 'C'. This allows an attacker to write to arbitrary files using path traversal sequences.\n\nImpact: An attacker can write to arbitrary files on the server filesystem by manipulating the BenchmarkTest02564 query parameter with path traversal sequences, potentially overwriting critical system files, configuration files, or application code, leading to system compromise or denial of service.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02565.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in FileInputStream via FileDescriptor\n\nUser-controlled input from the query string flows through doSomething() and is used to construct a file path without validation. The doSomething() method performs Base64 encoding and decoding which is a pass-through operation that preserves the tainted input. The tainted value is then used in FileInputStream constructor, allowing path traversal attacks.\n\nImpact: An attacker can read arbitrary files on the server filesystem by manipulating the BenchmarkTest02565 query parameter with path traversal sequences like '../../../etc/passwd', potentially exposing sensitive data.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02567.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in FileOutputStream\n\nUser-controlled input from the query string flows directly through doSomething() without any sanitization (bar = param) and is used to construct a file path. This allows an attacker to write to arbitrary files using path traversal sequences.\n\nImpact: An attacker can write to arbitrary files on the server filesystem by manipulating the BenchmarkTest02567 query parameter with path traversal sequences, potentially overwriting critical system files, configuration files, or application code, leading to system compromise or denial of service.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02569.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal in FileOutputStream\n\nUser-controlled input from the query string flows through doSomething() and is used to construct a file path without validation. The doSomething() method evaluates guess.charAt(2) which equals 'C', and the switch statement assigns param to bar in case 'C'. This allows an attacker to write to arbitrary files using path traversal sequences.\n\nImpact: An attacker can write to arbitrary files on the server filesystem by manipulating the BenchmarkTest02569 query parameter with path traversal sequences, potentially overwriting critical system files, configuration files, or application code, leading to system compromise or denial of service.\n\nFix: Validate and sanitize the file path. Use a whitelist of allowed filenames, canonicalize the path using File.getCanonicalPath(), and verify it starts with the expected base directory.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02578.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) in BenchmarkTest02578\n\nUser-controlled input from query string parameter flows directly into HTTP response via response.getWriter().format(). The doSomething() method evaluates (7*42) - 106 = 188, and 188 > 200 is FALSE, so bar = param (tainted). The response header X-XSS-Protection is set to 0, disabling browser XSS protection. User input is output without encoding.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, credentials, or performing actions on behalf of the victim.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02579.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) in BenchmarkTest02579\n\nUser-controlled input from query string parameter flows into HTTP response via response.getWriter().format(). The doSomething() method splits param by space and takes the first element, but this is still user-controlled tainted data. The response header X-XSS-Protection is set to 0, disabling browser XSS protection.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, credentials, or performing actions on behalf of the victim.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02580.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) in BenchmarkTest02580\n\nUser-controlled input from query string parameter flows into HTTP response via response.getWriter().format(). The doSomething() method appends \"_SafeStuff\" to param, but the result still contains the original tainted user input at the beginning. The response header X-XSS-Protection is set to 0, disabling browser XSS protection.\n\nImpact: An attacker can inject malicious JavaScript code that will execute in victims' browsers, potentially stealing session cookies, credentials, or performing actions on behalf of the victim.\n\nFix: Encode user input before including it in HTML output using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02582.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Unvalidated User Input in Response Output\n\nUser-controlled input from the query string is appended with '_SafeStuff' and then written directly to the HTTP response via response.getWriter().print(bar.toCharArray()). The X-XSS-Protection header is explicitly disabled. Although '_SafeStuff' is appended, the user input is still present at the beginning of the output and can contain malicious JavaScript that will be executed in the victim's browser.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the context of the victim's browser session, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using OWASP Java Encoder or similar library before writing user input to the response. Use response.getWriter().print(Encode.forHtml(bar)) to HTML-encode the output.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02583.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Direct Output of User Input\n\nUser-controlled input from the query string is directly assigned to the 'bar' variable and then written to the HTTP response via response.getWriter().print(bar) without any sanitization or encoding. The X-XSS-Protection header is explicitly disabled, making XSS attacks easier to execute.\n\nImpact: An attacker can inject arbitrary JavaScript code through the query parameter, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using OWASP Java Encoder or similar library. Use response.getWriter().print(Encode.forHtml(bar)) to HTML-encode the output before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02584.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input with Appended Safe String\n\nUser-controlled input from the query string is appended with '_SafeStuff' and then written directly to the HTTP response via response.getWriter().print(bar). The X-XSS-Protection header is explicitly disabled. The user input portion remains unencoded and can contain malicious JavaScript.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using OWASP Java Encoder or similar library before writing user input to the response. Use response.getWriter().print(Encode.forHtml(bar)) to HTML-encode the output.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02585.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Substring of User Input\n\nUser-controlled input from the query string has its last character removed via substring operation, but is then written directly to the HTTP response via response.getWriter().print(bar) without encoding. The X-XSS-Protection header is explicitly disabled. Removing one character does not prevent XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code (with one extra character to account for the removal) that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using OWASP Java Encoder or similar library. Use response.getWriter().print(Encode.forHtml(bar)) to HTML-encode the output before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02586.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Switch Statement User Input Assignment\n\nUser-controlled input from the query string flows through a switch statement where 'ABC'.charAt(2) evaluates to 'C', causing case 'C' to execute and assign param (user input) to bar. This value is then written directly to the HTTP response via response.getWriter().print(bar) without encoding. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code through the query parameter, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using OWASP Java Encoder or similar library. Use response.getWriter().print(Encode.forHtml(bar)) to HTML-encode the output before writing to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02587.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Propagation Chain and Printf\n\nUser-controlled input from the query string flows through a propagation chain including StringBuilder operations, HashMap storage, substring extraction, Base64 encoding/decoding, and string splitting. The final value passes through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and is then used in response.getWriter().printf() as a format argument. The X-XSS-Protection header is explicitly disabled. Despite the transformations, the user input remains tainted and reaches the response output.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser after passing through the propagation chain, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using OWASP Java Encoder or similar library. Encode the bar variable before including it in the output array: obj[1] = Encode.forHtml(bar).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02588.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User-Controlled Format String\n\nUser-controlled input from the query string flows through a propagation chain and ThingFactory.createThing().doSomething() (pass-through), then is used directly as the format string in response.getWriter().printf(). The X-XSS-Protection header is explicitly disabled. Using user input as a format string allows the attacker to control the output format and inject malicious content.\n\nImpact: An attacker can inject malicious JavaScript code through the format string parameter, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Never use user-controlled input as a format string. Apply proper output encoding using OWASP Java Encoder. Use a fixed format string and pass the user input as a parameter: response.getWriter().printf(java.util.Locale.US, \"%s\", Encode.forHtml(bar)).",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02591.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query Parameter\n\nUser input from the query string parameter 'BenchmarkTest02591' is appended with '_SafeStuff' and then output directly to the HTTP response via printf() without proper sanitization. The X-XSS-Protection header is explicitly disabled, making the application vulnerable to reflected XSS attacks.\n\nImpact: An attacker can inject malicious JavaScript code through the query parameter, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions before writing user input to the response. Remove the X-XSS-Protection: 0 header setting.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02592.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query Parameter\n\nUser input from the query string parameter 'BenchmarkTest02592' has its last character replaced with 'Z' but remains tainted. This modified user input is then output directly to the HTTP response via printf() without proper sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code through the query parameter, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions before writing user input to the response. Remove the X-XSS-Protection: 0 header setting.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02595.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query Parameter\n\nUser input from the query string parameter 'BenchmarkTest02595' flows through a switch statement where the deterministic switch target 'C' (from guess.charAt(2) where guess='ABC') causes the param to be assigned to bar. This tainted value is then output directly to the HTTP response via println() without proper sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code through the query parameter, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions before writing user input to the response. Remove the X-XSS-Protection: 0 header setting.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02597.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query Parameter\n\nUser input from the query string parameter 'BenchmarkTest02597' has its last character replaced with 'Z' but remains tainted. This modified user input is then output directly to the HTTP response via println() without proper sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code through the query parameter, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions before writing user input to the response. Remove the X-XSS-Protection: 0 header setting.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02598.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query Parameter\n\nUser input from the query string parameter 'BenchmarkTest02598' flows through a ternary condition where (7*42)-106=188, which is NOT greater than 200, causing param to be assigned to bar. This tainted value is then output directly to the HTTP response via println() without proper sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code through the query parameter, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions before writing user input to the response. Remove the X-XSS-Protection: 0 header setting.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02600.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Query Parameter\n\nUser input from the query string parameter 'BenchmarkTest02600' flows through a ternary condition where (7*42)-106=188, which is NOT greater than 200, causing param to be assigned to bar. This tainted value is then output directly to the HTTP response via write() without proper sanitization. The X-XSS-Protection header is explicitly disabled.\n\nImpact: An attacker can inject malicious JavaScript code through the query parameter, which will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() or similar HTML encoding functions before writing user input to the response. Remove the X-XSS-Protection: 0 header setting.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02601.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from the query string is HTML-escaped using StringEscapeUtils.escapeHtml() in doSomething(), then written to the HTTP response. However, the X-XSS-Protection header is explicitly disabled. While HTML escaping is applied, this is a defense-in-depth issue where XSS protection is intentionally disabled.\n\nImpact: An attacker could potentially exploit XSS if the HTML escaping is bypassed or insufficient, especially with XSS protection disabled.\n\nFix: Remove the line that disables XSS protection: response.setHeader(\"X-XSS-Protection\", \"0\"). Keep the HTML escaping as a primary defense.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02602.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random to generate random bytes for a 'rememberMe' cookie key, which is a security-sensitive context. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02603.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random to generate random bytes for a 'rememberMe' cookie key, which is a security-sensitive context. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02604.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random to generate a random double for a 'rememberMe' cookie key, which is a security-sensitive context. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02605.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random to generate a random double for a 'rememberMe' cookie key, which is a security-sensitive context. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02606.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.util.Random to generate a random float for a 'rememberMe' cookie key, which is a security-sensitive context. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: new java.security.SecureRandom().nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02608.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via User Input in HTTP Response\n\nUser-controlled input from the query string is passed through doSomething() which returns it unchanged, then written directly to the HTTP response without any encoding or sanitization. The X-XSS-Protection header is explicitly disabled, making XSS attacks easier.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or other malicious actions.\n\nFix: Apply proper output encoding using ESAPI.encoder().encodeForHTML() before writing user input to the response, and remove the line that disables XSS protection.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02622.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from the query string parameter is stored as a session attribute KEY without validation. The doSomething method appends '_SafeStuff' to the user input, but the resulting value (param + '_SafeStuff') is still partially user-controlled and used as the session key name in request.getSession().setAttribute(bar, \"10340\"). This allows an attacker to control session attribute names, potentially overwriting critical session data.\n\nImpact: An attacker can manipulate session attribute names to overwrite or interfere with application session state, potentially leading to privilege escalation or session manipulation attacks.\n\nFix: Never use user input to determine session attribute keys. Use a fixed, application-controlled key name for session attributes. If dynamic keys are required, use a whitelist or mapping approach where user input selects from predefined safe keys.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02623.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - Unvalidated User Input in Session\n\nUser-controlled data from the query string parameter is stored directly into the HTTP session without validation. The doSomething method returns the param unchanged, and this tainted value is stored in the session via request.getSession().setAttribute(\"userid\", bar). Even though the output is HTML-encoded for display, the trust boundary violation occurs at the point of storing unvalidated user data in the trusted session context.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the session data is later retrieved and used by the application.\n\nFix: Validate and sanitize all user input before storing it in the session. Implement strict input validation rules based on expected data format. Consider using a whitelist approach for acceptable values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02624.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - Unvalidated User Input in Session\n\nUser-controlled data from the query string parameter is stored into the HTTP session without validation. The doSomething method stores param in a HashMap and retrieves it back (map3141.put(\"keyB-3141\", param) followed by bar = (String) map3141.get(\"keyB-3141\")), resulting in bar containing the tainted user input. This is then stored in the session via request.getSession().setAttribute(\"userid\", bar).\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the session data is later retrieved and used by the application.\n\nFix: Validate and sanitize all user input before storing it in the session. Implement strict input validation rules based on expected data format. Consider using a whitelist approach for acceptable values.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02658.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated with KeyGenerator.getInstance(\"AES\") and initialize with key size 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02660.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm (DES)\n\nThe code uses DES (Data Encryption Standard) encryption algorithm, which is cryptographically broken and should not be used. DES has a 56-bit key size that can be brute-forced with modern computing power.\n\nImpact: An attacker can decrypt sensitive data encrypted with DES using brute-force attacks or known cryptanalytic techniques, compromising the confidentiality of the encrypted information.\n\nFix: Replace DES with AES-256 in GCM mode: Cipher.getInstance(\"AES/GCM/NoPadding\"). Use a 256-bit key generated with KeyGenerator.getInstance(\"AES\") and initialize with key size 256.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02661.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - DES\n\nThe code uses DES (Data Encryption Standard) encryption algorithm via Cipher.getInstance(\"DES/CBC/PKCS5Padding\"). DES is a fundamentally broken encryption algorithm with a 56-bit key size that can be brute-forced in hours with modern hardware. This makes any data encrypted with DES vulnerable to decryption by attackers.\n\nImpact: An attacker can decrypt sensitive data that was encrypted using DES, compromising confidentiality of the encrypted information stored in passwordFile.txt.\n\nFix: Replace DES with AES-256 in GCM mode: use Cipher.getInstance(\"AES/GCM/NoPadding\") with a 256-bit key generated via KeyGenerator.getInstance(\"AES\") with key size 256. Use GCMParameterSpec for authenticated encryption.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_327.CWE-327",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02663.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Encryption Algorithm - 3DES/DESede\n\nThe code loads a cryptographic algorithm from a properties file with a default value of \"DESede/ECB/PKCS5Padding\" (Triple DES). 3DES/DESede is considered weak and deprecated due to its small block size (64 bits) which makes it vulnerable to birthday attacks and collision attacks. Additionally, ECB mode does not provide semantic security.\n\nImpact: An attacker can exploit weaknesses in 3DES encryption to decrypt sensitive data, especially when large amounts of data are encrypted. ECB mode also reveals patterns in plaintext data.\n\nFix: Replace 3DES with AES-256 in GCM mode. Change the default algorithm in benchmark.properties to \"AES/GCM/NoPadding\" and use appropriate GCMParameterSpec with a secure random IV.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-327"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02666.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input flows directly into a file path without validation. The doSomething method retrieves user input from SeparateClassRequest, adds it to a list, removes the first element, and returns the user input via get(0). This tainted value is then concatenated with TESTFILES_DIR and used to open a FileInputStream, allowing an attacker to read arbitrary files via path traversal sequences like '../../../etc/passwd'.\n\nImpact: An attacker can read arbitrary files on the server filesystem by providing path traversal sequences, potentially accessing sensitive configuration files, credentials, source code, or other confidential data.\n\nFix: Validate and sanitize the file path: 1) Use Path.normalize() to resolve '..' sequences, 2) Verify the resolved path starts with the intended base directory using startsWith(), 3) Use a whitelist of allowed filenames, 4) Reject paths containing '..' or absolute path indicators.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_22.CWE-22",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02668.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Path Traversal Vulnerability\n\nUser-controlled input flows directly into a file path without validation. The doSomething method stores user input in a HashMap under key 'keyB-94533' and retrieves it, making bar tainted. This value is then concatenated with TESTFILES_DIR and used to create a FileOutputStream, allowing an attacker to write to arbitrary files via path traversal sequences.\n\nImpact: An attacker can write to arbitrary files on the server filesystem, potentially overwriting critical system files, configuration files, or application code, leading to system compromise, denial of service, or remote code execution.\n\nFix: Validate and sanitize the file path: 1) Use Path.normalize() to resolve '..' sequences, 2) Verify the resolved path starts with the intended base directory using startsWith(), 3) Use a whitelist of allowed filenames, 4) Reject paths containing '..' or absolute path indicators.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-22"
          ],
          "owasp": "A5: Security Misconfiguration"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02679.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS)\n\nUser-controlled input flows into the HTTP response via out.format() without proper sanitization. The doSomething() method performs a ternary operation where (7*42)-106 = 188, and 188 > 200 is false, so bar = param (user input). This tainted data is then written to the response body via format(), and X-XSS-Protection is disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Sanitize user input before including it in HTTP responses using ESAPI.encoder().encodeForHTML() or similar context-appropriate encoding functions.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02693.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Reflected\n\nUser input from SeparateClassRequest.getTheValue() flows through doSomething() where it undergoes a StringBuilder.replace() operation that only modifies the last character to 'Z'. The modified user input is then written directly to the HTTP response via response.getWriter().println(bar). The X-XSS-Protection header is explicitly disabled. Even though the last character is replaced, the rest of the user input remains unescaped and can contain malicious JavaScript.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using OWASP ESAPI encoder (e.g., ESAPI.encoder().encodeForHTML()) or similar HTML encoding before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02694.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Reflected via Switch Statement\n\nUser input from SeparateClassRequest.getTheValue() flows through doSomething() where a switch statement on guess.charAt(2) evaluates to 'C' (the third character of \"ABC\"). Case 'C' assigns param (user input) to bar. This tainted value is then written directly to the HTTP response via response.getWriter().println(bar) with X-XSS-Protection disabled.\n\nImpact: An attacker can inject malicious JavaScript code that will be executed in the victim's browser, potentially leading to session hijacking, credential theft, or defacement.\n\nFix: Apply proper output encoding using OWASP ESAPI encoder (e.g., ESAPI.encoder().encodeForHTML()) or similar HTML encoding before writing user input to the response.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02700.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.util.Random().nextBytes() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values. An attacker who observes several random values can predict future values and forge session cookies.\n\nImpact: An attacker can predict the rememberMe cookie values and forge authentication cookies, leading to unauthorized access to user accounts and session hijacking.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02701.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe security token. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers, compromising the security of the authentication mechanism.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02702.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe security token. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers, compromising the security of the authentication mechanism.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: new java.security.SecureRandom().nextDouble();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02703.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe security token. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers, compromising the security of the authentication mechanism.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: new java.security.SecureRandom().nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02704.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe security token. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers, compromising the security of the authentication mechanism.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: new java.security.SecureRandom().nextFloat();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02705.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe security token. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers, compromising the security of the authentication mechanism.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: new java.security.SecureRandom().nextGaussian();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02706.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe security token. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers, compromising the security of the authentication mechanism.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: new java.security.SecureRandom().nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02707.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe security token. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers, compromising the security of the authentication mechanism.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: new java.security.SecureRandom().nextInt();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02708.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a rememberMe security token. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers, compromising the security of the authentication mechanism.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: new java.security.SecureRandom().nextLong();",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02718.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via Reflected User Input\n\nUser-controlled input from SeparateClassRequest flows through doSomething() where it undergoes string manipulations (StringBuilder operations, Base64 encoding/decoding, split) and is passed through ThingFactory.createThing().doSomething() which is a pass-through that returns the input unchanged. The tainted value 'bar' is then written directly to the HTTP response without encoding, and XSS protection is explicitly disabled. This allows an attacker to inject malicious JavaScript.\n\nImpact: An attacker can inject arbitrary JavaScript code that will execute in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or redirecting to malicious sites.\n\nFix: Use ESAPI.encoder().encodeForHTML() or similar HTML encoding before writing user input to the response. Remove the X-XSS-Protection: 0 header or set it to 1.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02722.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session (putValue with user-controlled key)\n\nUser-controlled data from request parameter 'BenchmarkTest02722' flows through HTML encoding (ESAPI.encoder().encodeForHTML()) and is then used as the KEY in session.putValue(bar, \"10340\"). HTML encoding does NOT prevent trust boundary violations - the issue is storing user data in a trusted context (session), not the format. The user controls the session attribute name, which can lead to session manipulation attacks.\n\nImpact: An attacker can control session attribute names, potentially overwriting critical session data, bypassing authentication checks, or causing denial of service by exhausting session storage.\n\nFix: Validate and whitelist the session key name against a fixed set of allowed values before storing in session. Never allow user input to directly control session attribute names. Use a fixed key name and store the user input as the value only after proper validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02723.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session (putValue with user-controlled key)\n\nUser-controlled data from request parameter 'BenchmarkTest02723' is appended with '_SafeStuff' but the original user input is still part of the string used as the KEY in session.putValue(bar, \"10340\"). The user controls the session attribute name prefix, which can lead to session manipulation attacks.\n\nImpact: An attacker can control session attribute names, potentially overwriting critical session data, bypassing authentication checks, or causing denial of service by exhausting session storage.\n\nFix: Validate and whitelist the session key name against a fixed set of allowed values before storing in session. Never allow user input to directly control session attribute names. Use a fixed key name and store the user input as the value only after proper validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02724.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session (putValue with user-controlled key)\n\nUser-controlled data from request parameter 'BenchmarkTest02724' flows through a switch statement. The switch evaluates guess.charAt(2) which is 'C', matching case 'C' which assigns param to bar. This tainted value is then used as the KEY in session.putValue(bar, \"10340\"). The user controls the session attribute name.\n\nImpact: An attacker can control session attribute names, potentially overwriting critical session data, bypassing authentication checks, or causing denial of service by exhausting session storage.\n\nFix: Validate and whitelist the session key name against a fixed set of allowed values before storing in session. Never allow user input to directly control session attribute names. Use a fixed key name and store the user input as the value only after proper validation.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02726.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session (setAttribute with user-controlled value)\n\nUser-controlled data from request parameter 'BenchmarkTest02726' flows through substring manipulation (removing last character) and is then stored as the VALUE in session.setAttribute(\"userid\", bar). The user input is stored directly in the session without validation, creating a trust boundary violation.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other attacks that rely on trusted session data.\n\nFix: Validate and sanitize user input before storing in session. Implement strict input validation rules, whitelist allowed characters, and consider encrypting or signing session data to maintain integrity.",
        "severity": "HIGH",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00003.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm via Runtime Configuration\n\nThe hash algorithm is loaded from an external properties file at runtime using benchmarkprops.getProperty('hashAlg1', 'SHA512'). While the default is SHA512 (strong), the algorithm can be configured to use weak algorithms like MD5 or SHA-1 by modifying the benchmark.properties file. This runtime configuration makes the system vulnerable to weak hash algorithm selection.\n\nImpact: If the properties file is modified to specify a weak algorithm like MD5 or SHA-1, the system will use that weak algorithm for hashing sensitive values. Weak hash algorithms are vulnerable to collision attacks and pre-image attacks, compromising the security of hashed data.\n\nFix: Hardcode a strong hash algorithm (SHA-256, SHA-384, SHA-512, or SHA-3 variants) instead of loading it from a properties file. If runtime configuration is required, implement strict validation to only allow strong algorithms from a whitelist.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00004.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled input from cookie 'BenchmarkTest00004' is used directly as the session attribute key name via request.getSession().setAttribute(param, '10340'). The user controls what key name is stored in the session, not just the value. This violates the trust boundary between user-controlled data and the trusted session storage mechanism. Note that HTML encoding (encodeForHTML) does not prevent trust boundary violations.\n\nImpact: An attacker can pollute the session namespace by creating arbitrary session attributes with attacker-controlled key names. This can lead to session fixation, privilege escalation, or interference with application logic that relies on specific session attribute names.\n\nFix: Never use user-controlled input as session attribute key names. Use a fixed, application-controlled key name and validate/sanitize the user input before storing it as the value. If dynamic keys are required, use a whitelist of allowed key names or prefix user input with a fixed string.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00031.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest00031' is stored directly into the HTTP session via putValue() without validation. The parameter value is retrieved from request.getParameterMap() and stored in session with key 'userid'. While the output is HTML-encoded, the trust boundary violation occurs when unvalidated user input is stored in the trusted session context.\n\nImpact: An attacker can inject arbitrary data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks depending on how the session data is used elsewhere in the application.\n\nFix: Validate and sanitize the user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. Consider using a separate data structure for untrusted data or implementing additional validation layers.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00066.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value for authentication purposes. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict the rememberMe cookie values and forge authentication cookies to impersonate other users.\n\nFix: Use java.security.SecureRandom instead of Math.random() for security-sensitive random number generation: SecureRandom sr = new SecureRandom(); double value = sr.nextDouble();",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00067.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value for authentication purposes. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict the rememberMe cookie values and forge authentication cookies to impersonate other users.\n\nFix: Use java.security.SecureRandom instead of Math.random() for security-sensitive random number generation: SecureRandom sr = new SecureRandom(); double value = sr.nextDouble();",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00068.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value for authentication purposes. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker can predict the rememberMe cookie values and forge authentication cookies to impersonate other users.\n\nFix: Use java.security.SecureRandom instead of Math.random() for security-sensitive random number generation: SecureRandom sr = new SecureRandom(); double value = sr.nextDouble();",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00070.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security purposes. The hash is used to store sensitive password data.\n\nImpact: SHA-1 collisions can be generated, allowing attackers to forge password hashes or reverse-engineer the original values. This compromises the security of stored credentials.\n\nFix: Use a strong hashing algorithm like SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00087.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with setSecure(false), which means it can be transmitted over unencrypted HTTP connections. This exposes the cookie value to interception via man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: cookie.setSecure(true); This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00169.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false (cookie.setSecure(false)). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception.\n\nImpact: An attacker performing a man-in-the-middle attack on an unencrypted HTTP connection could intercept the cookie value, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: 'cookie.setSecure(true)' to ensure the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00170.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false (cookie.setSecure(false)). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception.\n\nImpact: An attacker performing a man-in-the-middle attack on an unencrypted HTTP connection could intercept the cookie value, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: 'cookie.setSecure(true)' to ensure the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00223.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe application uses SHA-1 (SHA1) via MessageDigest.getInstance(\"SHA1\", provider[0]) for hashing sensitive data. SHA-1 is cryptographically broken and vulnerable to collision attacks. While the data flow shows that `bar` receives user input from the header name, the primary vulnerability is the use of the weak SHA-1 algorithm itself, regardless of what data is hashed.\n\nImpact: An attacker may be able to generate collisions, potentially compromising the integrity of hashed data. SHA-1 should not be used for any security-sensitive operations.\n\nFix: Replace SHA-1 with a strong hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00241.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe application creates a cookie with the secure flag explicitly set to false via cookie.setSecure(false). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network path could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00251.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Data Stored in Session\n\nUser-controlled data from a non-standard HTTP header name is stored directly into the HTTP session without validation. The code extracts the first non-standard header name via request.getHeaderNames(), splits it, and stores it in the session using putValue(). This violates the trust boundary between user input and trusted session storage.\n\nImpact: An attacker can inject arbitrary data into the session storage by controlling HTTP header names. This could lead to session poisoning, privilege escalation, or other session-based attacks depending on how the session data is used elsewhere in the application.\n\nFix: Validate and sanitize the header name before storing it in the session. Implement a whitelist of acceptable values or ensure the data conforms to expected patterns. Consider whether storing user-controlled header names in the session is necessary for the application's functionality.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00252.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Attribute Key\n\nUser-controlled data from a non-standard HTTP header name is used as the key name in session.setAttribute(). After list manipulation (remove(0)), bar contains 'moresafe' (a constant), but this constant is derived from user input (param) that was added to the list. The user controls which header name becomes the session attribute key.\n\nImpact: An attacker can control the names of session attributes by manipulating HTTP header names. This could allow overwriting critical session attributes, causing denial of service, or interfering with application logic that depends on specific session attribute names.\n\nFix: Never use user-controlled data as session attribute keys. Use predefined constant strings for session attribute names. If dynamic keys are required, use a mapping from user input to safe, predefined keys.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00266.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing, which is cryptographically weak and vulnerable to collision attacks. SHA-1 has been deprecated for security-sensitive applications since 2017.\n\nImpact: An attacker could potentially generate hash collisions, compromising the integrity of the hashed data. This is particularly dangerous when hashing passwords or other sensitive values for authentication or integrity verification.\n\nFix: Replace SHA-1 with a stronger hash algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00267.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing, which is cryptographically weak and vulnerable to collision attacks.\n\nImpact: An attacker could potentially generate hash collisions, compromising the integrity of the hashed data.\n\nFix: Replace SHA-1 with SHA-256 or stronger. For password hashing, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00268.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing, which is cryptographically weak and vulnerable to collision attacks.\n\nImpact: An attacker could potentially generate hash collisions, compromising the integrity of the hashed data.\n\nFix: Replace SHA-1 with SHA-256 or stronger. For password hashing, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00269.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing, which is cryptographically weak and vulnerable to collision attacks.\n\nImpact: An attacker could potentially generate hash collisions, compromising the integrity of the hashed data.\n\nFix: Replace SHA-1 with SHA-256 or stronger. For password hashing, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00272.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm (MD5)\n\nThe code uses MD5 hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and should not be used for security purposes. MD5 is vulnerable to collision attacks and pre-image attacks.\n\nImpact: An attacker could potentially generate collisions or reverse the hash, compromising the integrity and confidentiality of hashed data. This is especially critical when hashing passwords or other sensitive data.\n\nFix: Replace MD5 with a strong cryptographic hash function such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00273.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configurable Hash Algorithm\n\nThe hash algorithm is loaded from a properties file at runtime via benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). While the default is secure (SHA512), the algorithm can be changed via configuration to a weak algorithm like MD5 or SHA1, creating a potential security vulnerability.\n\nImpact: If the properties file is modified to specify a weak hash algorithm (MD5, SHA1), the application would use that weak algorithm, making it vulnerable to collision and pre-image attacks. This allows an attacker who can modify the configuration to weaken the cryptographic security.\n\nFix: Hard-code a strong hash algorithm (SHA-256 or stronger) instead of loading it from configuration. If configurability is required, validate the algorithm against a whitelist of approved strong algorithms before use.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00274.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configurable Hash Algorithm\n\nThe hash algorithm is loaded from a properties file at runtime via benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). While the default is secure (SHA512), the algorithm can be changed via configuration to a weak algorithm like MD5 or SHA1, creating a potential security vulnerability.\n\nImpact: If the properties file is modified to specify a weak hash algorithm (MD5, SHA1), the application would use that weak algorithm, making it vulnerable to collision and pre-image attacks. This allows an attacker who can modify the configuration to weaken the cryptographic security.\n\nFix: Hard-code a strong hash algorithm (SHA-256 or stronger) instead of loading it from configuration. If configurability is required, validate the algorithm against a whitelist of approved strong algorithms before use.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00300.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false (cookie.setSecure(false)). This allows the cookie to be transmitted over unencrypted HTTP connections, making it vulnerable to interception by network attackers.\n\nImpact: An attacker performing a man-in-the-middle attack on an unencrypted HTTP connection can intercept the cookie value, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS connections: cookie.setSecure(true);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00321.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data in Session Key Name\n\nUser-controlled data from the 'BenchmarkTest00321' HTTP header is stored as a session attribute key name via request.getSession().putValue(bar, \"10340\"). The data flows from request.getHeaders() through HTML encoding to the session. HTML encoding does NOT prevent trust boundary violations - it only sanitizes for XSS. Storing unvalidated user input in the session trust boundary allows attackers to pollute the session namespace.\n\nImpact: An attacker can control session attribute key names, potentially overwriting legitimate session data, causing denial of service, or interfering with application logic that relies on specific session keys.\n\nFix: Validate and sanitize user input before storing in session. Use a whitelist of allowed values or prefix user data with a constant string. Do not use user-controlled data as session key names.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00324.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from the 'BenchmarkTest00324' HTTP header is stored in the session via request.getSession().putValue(\"userid\", bar). The data flows from request.getHeaders() through HTML encoding to the session. HTML encoding does NOT prevent trust boundary violations - it only sanitizes for XSS. Storing unvalidated user input directly in the session trust boundary violates the trust boundary between user-controlled and application-controlled data.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other attacks that rely on trusted session data.\n\nFix: Validate and sanitize user input before storing in session. Implement proper input validation, use whitelists for allowed values, and consider using session data only for application-generated identifiers.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00325.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from the 'BenchmarkTest00325' HTTP header is stored in the session via request.getSession().putValue(\"userid\", bar). The data flows from request.getHeaders() through HTML encoding (StringEscapeUtils.escapeHtml) to the session. HTML encoding does NOT prevent trust boundary violations - it only sanitizes for XSS. Storing unvalidated user input directly in the session trust boundary violates the trust boundary between user-controlled and application-controlled data.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other attacks that rely on trusted session data.\n\nFix: Validate and sanitize user input before storing in session. Implement proper input validation, use whitelists for allowed values, and consider using session data only for application-generated identifiers.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00326.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data in Session Key Name\n\nUser-controlled data from the 'BenchmarkTest00326' HTTP header is used as a session attribute key name via request.getSession().setAttribute(bar, \"10340\"). The condition (500 / 42) + 196 > 200 evaluates to TRUE (207 > 200), so bar is assigned the user-controlled param value. Storing unvalidated user input as a session key name allows attackers to pollute the session namespace.\n\nImpact: An attacker can control session attribute key names, potentially overwriting legitimate session data, causing denial of service, or interfering with application logic that relies on specific session keys.\n\nFix: Validate and sanitize user input before using as session keys. Use a whitelist of allowed values or use user data only as session values, not keys. Never allow user-controlled data to determine session attribute names.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00327.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from the 'BenchmarkTest00327' HTTP header is stored in the session via request.getSession().setAttribute(\"userid\", bar). The data flows from request.getHeaders() through ThingFactory.createThing().doSomething() (which is a pass-through that returns its input unchanged) to the session. Storing unvalidated user input directly in the session trust boundary violates the trust boundary between user-controlled and application-controlled data.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other attacks that rely on trusted session data.\n\nFix: Validate and sanitize user input before storing in session. Implement proper input validation, use whitelists for allowed values, and consider using session data only for application-generated identifiers.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00346.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing, which is cryptographically weak and vulnerable to collision attacks. SHA-1 has been deprecated for security-sensitive applications since 2017.\n\nImpact: An attacker may be able to generate collisions, potentially compromising the integrity of hashed data or enabling forgery attacks.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. Use MessageDigest.getInstance(\"SHA-256\") or stronger.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00348.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is explicitly set with the secure flag set to false. This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception via man-in-the-middle attacks.\n\nImpact: An attacker on the network can intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: cookie.setSecure(true);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00371.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) for hashing, which is cryptographically weak and vulnerable to collision attacks. SHA-1 has been deprecated by NIST since 2011 and should not be used for security-sensitive operations.\n\nImpact: An attacker could potentially generate hash collisions, compromising the integrity of the hashed data. This is particularly concerning when hashing passwords or other sensitive values.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00372.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm MD5 Used\n\nThe code uses MD5 for hashing, which is cryptographically broken and vulnerable to collision attacks. MD5 has been considered insecure since 2004 and should not be used for any security-sensitive operations.\n\nImpact: An attacker can easily generate hash collisions with MD5, completely compromising the integrity of the hashed data. This is especially dangerous when hashing passwords or other sensitive values.\n\nFix: Replace MD5 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00401.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' cookie value. java.util.Random is not cryptographically secure and produces predictable values. An attacker who observes a few random values can predict future values, potentially allowing session hijacking or authentication bypass.\n\nImpact: An attacker could predict the rememberMe cookie values and impersonate other users by forging valid session cookies.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: 'int randNumber = new java.security.SecureRandom().nextInt(99);'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00402.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value. java.util.Random is not cryptographically secure and produces predictable values. An attacker who observes a few random values can predict future values, potentially allowing session hijacking or authentication bypass.\n\nImpact: An attacker could predict the rememberMe cookie values and impersonate other users by forging valid session cookies.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: 'int r = new java.security.SecureRandom().nextInt();'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00403.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with setSecure(false), which means it will be transmitted over unencrypted HTTP connections. This exposes the cookie value to network eavesdropping and man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value in plaintext, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: 'cookie.setSecure(true);' to ensure the cookie is only transmitted over HTTPS.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00462.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1\n\nThe code uses SHA-1 hashing algorithm which is cryptographically weak and has known collision vulnerabilities. SHA-1 should not be used for security-sensitive operations like password hashing or integrity verification.\n\nImpact: Attackers can potentially generate collisions or reverse the hash, compromising the integrity and confidentiality of hashed data. This is especially critical when hashing passwords or sensitive values.\n\nFix: Use a stronger hashing algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Replace 'SHA1' with 'SHA-256' or stronger.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00464.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1\n\nThe code uses SHA-1 hashing algorithm which is cryptographically weak and has known collision vulnerabilities. SHA-1 should not be used for security-sensitive operations like password hashing or integrity verification.\n\nImpact: Attackers can potentially generate collisions or reverse the hash, compromising the integrity and confidentiality of hashed data. This is especially critical when hashing passwords or sensitive values.\n\nFix: Use a stronger hashing algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Replace 'SHA1' with 'SHA-256' or stronger.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00465.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm MD5\n\nThe code uses MD5 hashing algorithm which is cryptographically broken and has severe collision vulnerabilities. MD5 should never be used for security-sensitive operations like password hashing or integrity verification.\n\nImpact: Attackers can easily generate collisions or reverse MD5 hashes, completely compromising the security of hashed data. MD5 is considered fundamentally insecure for any cryptographic purpose.\n\nFix: Use a stronger hashing algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Replace 'MD5' with 'SHA-256' or stronger.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00471.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via printf with User Input\n\nUser input from request parameter 'BenchmarkTest00471' is HTML-escaped and then output to the HTTP response via printf(). While HtmlUtils.htmlEscape() provides XSS protection, the X-XSS-Protection header is explicitly disabled (set to 0), which removes browser-level XSS protections. The HTML escaping is effective, but the disabled XSS protection header weakens the defense-in-depth posture.\n\nImpact: If the HTML escaping were bypassed or removed in future code changes, attackers could inject malicious JavaScript that executes in victims' browsers, potentially stealing session cookies, performing actions on behalf of users, or defacing the page.\n\nFix: Remove the line 'response.setHeader(\"X-XSS-Protection\", \"0\");' to enable browser XSS protections. Continue using HtmlUtils.htmlEscape() for output encoding. Consider implementing Content Security Policy (CSP) headers for additional protection.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00474.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) via println with User Input\n\nUser input from request parameter 'BenchmarkTest00474' is HTML-escaped and output to the HTTP response. While HtmlUtils.htmlEscape() provides effective XSS protection, the X-XSS-Protection header is explicitly disabled, removing browser-level defenses.\n\nImpact: If the HTML escaping were bypassed or removed in future code changes, attackers could inject malicious JavaScript. The disabled XSS protection header weakens defense-in-depth.\n\nFix: Remove the line 'response.setHeader(\"X-XSS-Protection\", \"0\");' to enable browser XSS protections. Continue using HtmlUtils.htmlEscape() for output encoding.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00491.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nA cookie is created with the secure flag explicitly set to false. This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network path could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00508.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled input from request parameter 'BenchmarkTest00508' is appended with '_SafeStuff' and then stored directly in the HTTP session via setAttribute(). While the input is concatenated with a safe string, the user-controlled portion is still stored in the trusted session context without validation. The session is a trusted boundary that should not contain unvalidated user input.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the session data is later retrieved and used.\n\nFix: Validate and sanitize user input before storing it in the session. Implement strict input validation to ensure only expected values are stored. Consider using a whitelist approach or encoding the data appropriately for its intended use context.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00531.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(\"SHA1\", provider[0]) or MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. SHA-1 has known collision vulnerabilities that allow attackers to generate two different inputs that produce the same hash output.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. This is especially critical when hashing passwords or sensitive data.\n\nFix: Replace SHA-1 with a strong cryptographic hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00532.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. SHA-1 has known collision vulnerabilities that allow attackers to generate two different inputs that produce the same hash output.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. This is especially critical when hashing passwords or sensitive data.\n\nFix: Replace SHA-1 with a strong cryptographic hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00533.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. SHA-1 has known collision vulnerabilities that allow attackers to generate two different inputs that produce the same hash output.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. This is especially critical when hashing passwords or sensitive data.\n\nFix: Replace SHA-1 with a strong cryptographic hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00534.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. SHA-1 has known collision vulnerabilities that allow attackers to generate two different inputs that produce the same hash output.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. This is especially critical when hashing passwords or sensitive data.\n\nFix: Replace SHA-1 with a strong cryptographic hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00536.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm MD5\n\nThe code uses MD5 as the hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and should not be used for security-sensitive operations. MD5 has severe collision vulnerabilities that allow attackers to easily generate two different inputs that produce the same hash output.\n\nImpact: An attacker could exploit MD5 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. MD5 is considered completely insecure for cryptographic purposes and can be broken in seconds with modern hardware.\n\nFix: Replace MD5 with a strong cryptographic hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00537.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm MD5\n\nThe code uses MD5 as the hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and should not be used for security-sensitive operations. MD5 has severe collision vulnerabilities that allow attackers to easily generate two different inputs that produce the same hash output.\n\nImpact: An attacker could exploit MD5 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. MD5 is considered completely insecure for cryptographic purposes and can be broken in seconds with modern hardware.\n\nFix: Replace MD5 with a strong cryptographic hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00540.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm from Properties File\n\nThe code loads the hash algorithm from a properties file via benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\"). This allows the hash algorithm to be configured at runtime, which could result in a weak algorithm being used if the properties file specifies MD5, SHA-1, or another broken algorithm. The configuration-based approach makes it difficult to ensure only strong algorithms are used.\n\nImpact: If the properties file is configured with a weak algorithm like MD5 or SHA-1, the application will use that weak algorithm for hashing sensitive data, exposing it to collision attacks and other cryptographic vulnerabilities. An attacker who can modify the properties file could force the use of a weak algorithm.\n\nFix: Hardcode a strong hash algorithm (SHA-256, SHA-384, SHA-512, or SHA-3) directly in the code instead of loading it from a properties file. If configuration is required, implement a whitelist that only allows strong algorithms and rejects weak ones like MD5, SHA-1, etc. For password hashing, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00565.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie is explicitly set with the secure flag set to false. This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: cookie.setSecure(true);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00566.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie is explicitly set with the secure flag set to false. This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: cookie.setSecure(true);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00631.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. SHA-1 has known collision vulnerabilities that allow attackers to generate two different inputs that produce the same hash output.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. This is especially critical when hashing passwords or sensitive data.\n\nFix: Replace SHA-1 with a strong cryptographic hash function such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00634.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. SHA-1 has known collision vulnerabilities that allow attackers to generate two different inputs that produce the same hash output.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. This is especially critical when hashing passwords or sensitive data.\n\nFix: Replace SHA-1 with a strong cryptographic hash function such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00635.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. SHA-1 has known collision vulnerabilities that allow attackers to generate two different inputs that produce the same hash output.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. This is especially critical when hashing passwords or sensitive data.\n\nFix: Replace SHA-1 with a strong cryptographic hash function such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00636.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. SHA-1 has known collision vulnerabilities that allow attackers to generate two different inputs that produce the same hash output.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. This is especially critical when hashing passwords or sensitive data.\n\nFix: Replace SHA-1 with a strong cryptographic hash function such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00637.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm MD5\n\nThe code uses MD5 as the hashing algorithm via MessageDigest.getInstance(). MD5 is cryptographically broken and should not be used for any security-sensitive operations. MD5 has severe collision vulnerabilities that allow attackers to easily generate two different inputs that produce the same hash output.\n\nImpact: An attacker can exploit MD5 collision vulnerabilities to forge data, bypass integrity checks, or compromise password storage security. MD5 is considered completely insecure for cryptographic purposes.\n\nFix: Replace MD5 with a strong cryptographic hash function such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00652.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security-Sensitive Operation\n\nThe code uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers who observe previous outputs or know the seed.\n\nImpact: An attacker could predict the rememberMe cookie values, allowing them to forge authentication cookies and hijack user sessions without knowing credentials.\n\nFix: Replace java.util.Random with java.security.SecureRandom for all security-sensitive random number generation: `byte[] bytes = new byte[10]; java.security.SecureRandom.getInstanceStrong().nextBytes(bytes);`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00653.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security-Sensitive Operation\n\nThe code uses java.util.Random to generate a 'rememberMe' cookie value for session management. The ternary condition `(7 * 42) - 106 > 200` evaluates to FALSE (188 > 200 is false), so `bar` is assigned `param`, but this is irrelevant to the weak random vulnerability. The primary issue is that java.util.Random is not cryptographically secure and its output can be predicted.\n\nImpact: An attacker could predict the rememberMe cookie values, allowing them to forge authentication cookies and hijack user sessions without knowing credentials.\n\nFix: Replace java.util.Random with java.security.SecureRandom: `int r = java.security.SecureRandom.getInstanceStrong().nextInt();`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00654.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used for Security-Sensitive Operation\n\nThe code uses java.util.Random to generate a 'rememberMe' cookie value for session management. java.util.Random is a pseudorandom number generator that is not cryptographically secure and can be predicted by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values, allowing them to forge authentication cookies and hijack user sessions without knowing credentials.\n\nFix: Replace java.util.Random with java.security.SecureRandom: `long l = java.security.SecureRandom.getInstanceStrong().nextLong();`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00668.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from request parameter 'BenchmarkTest00668' is HTML-encoded and then stored as a session key via HttpSession.putValue(). HTML encoding only prevents XSS (CWE-79) but does NOT sanitize for trust boundary violations (CWE-501). The user controls the session key name, which crosses the trust boundary between user input and the trusted session storage context.\n\nImpact: An attacker can control session key names, potentially overwriting legitimate session attributes, causing session confusion, or interfering with application logic that relies on specific session keys.\n\nFix: Do not use user input as session keys. Use a predefined constant key name and store user data as the value only after proper validation. If dynamic keys are required, validate against a strict whitelist of allowed key names.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00670.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from request parameter 'BenchmarkTest00670' is minimally transformed (last character replaced with 'Z') and then stored as a session key via HttpSession.putValue(). The user still controls the majority of the session key name, which crosses the trust boundary between user input and the trusted session storage context.\n\nImpact: An attacker can control session key names, potentially overwriting legitimate session attributes, causing session confusion, or interfering with application logic that relies on specific session keys.\n\nFix: Do not use user input as session keys. Use a predefined constant key name and store user data as the value only after proper validation. If dynamic keys are required, validate against a strict whitelist of allowed key names.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00702.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.lang.Math.random() to generate a random value for a security-sensitive purpose (rememberMe cookie key). Math.random() is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe key values, allowing them to forge authentication cookies and impersonate users.\n\nFix: Replace Math.random() with java.security.SecureRandom for all security-sensitive random number generation.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00703.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - SHA-1 Used\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could potentially perform collision attacks or reverse the hash to recover sensitive data. SHA-1 is considered weak and unsuitable for cryptographic purposes.\n\nFix: Replace SHA-1 with a stronger hash algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00704.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - SHA-1 Used\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could potentially perform collision attacks or reverse the hash to recover sensitive data. SHA-1 is considered weak and unsuitable for cryptographic purposes.\n\nFix: Replace SHA-1 with a stronger hash algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00705.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - SHA-1 Used\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could potentially perform collision attacks or reverse the hash to recover sensitive data. SHA-1 is considered weak and unsuitable for cryptographic purposes.\n\nFix: Replace SHA-1 with a stronger hash algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00708.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - MD5 Used\n\nThe code uses MD5 hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could easily perform collision attacks or reverse the hash to recover sensitive data. MD5 is considered completely broken and unsuitable for any cryptographic purposes.\n\nFix: Replace MD5 with a stronger hash algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00710.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm\n\nThe hash algorithm is loaded from a properties file at runtime. If the properties file is misconfigured or compromised to specify a weak algorithm (MD5, SHA-1), the system would use an insecure hash function.\n\nImpact: If the configuration is changed to use a weak algorithm like MD5 or SHA-1, sensitive data could be compromised through collision or preimage attacks.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) in the code rather than loading it from configuration. If configuration is required, validate that only approved strong algorithms are used.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00736.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false (cookie.setSecure(false)). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception.\n\nImpact: An attacker performing a man-in-the-middle attack on an unencrypted HTTP connection can intercept the cookie value, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: 'cookie.setSecure(true)' to ensure the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00820.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is explicitly created with the secure flag set to false using cookie.setSecure(false). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by network attackers.\n\nImpact: An attacker performing a man-in-the-middle attack on an unencrypted HTTP connection can intercept the cookie value, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00821.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false via cookie.setSecure(false). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker intercepting HTTP traffic can steal the cookie value, potentially leading to session hijacking or unauthorized access to user data.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00868.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing sensitive data. SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The algorithm is vulnerable to collision attacks, making it unsuitable for password hashing or integrity verification.\n\nImpact: An attacker may be able to generate collisions or reverse the hash through known attacks against SHA-1, compromising the security of hashed passwords or data integrity checks.\n\nFix: Replace SHA-1 with a strong cryptographic hash function such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00869.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing sensitive data. SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The algorithm is vulnerable to collision attacks.\n\nImpact: An attacker may be able to generate collisions or reverse the hash through known attacks against SHA-1, compromising the security of hashed passwords or data integrity checks.\n\nFix: Replace SHA-1 with a strong cryptographic hash function such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00870.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing sensitive data. SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The algorithm is vulnerable to collision attacks.\n\nImpact: An attacker may be able to generate collisions or reverse the hash through known attacks against SHA-1, compromising the security of hashed passwords or data integrity checks.\n\nFix: Replace SHA-1 with a strong cryptographic hash function such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00871.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. This is particularly concerning as the code appears to be hashing and storing password-related data (writing to 'passwordFile.txt').\n\nImpact: An attacker could potentially exploit weaknesses in SHA-1 to create hash collisions, compromise password integrity, or reverse-engineer hashed values. SHA-1 has known collision vulnerabilities that make it unsuitable for security purposes.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use a dedicated password hashing function like bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\", \"SUN\") or use a proper password hashing library.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00872.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. This is particularly concerning as the code appears to be hashing and storing password-related data (writing to 'passwordFile.txt').\n\nImpact: An attacker could potentially exploit weaknesses in SHA-1 to create hash collisions, compromise password integrity, or reverse-engineer hashed values. SHA-1 has known collision vulnerabilities that make it unsuitable for security purposes.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use a dedicated password hashing function like bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\", \"SUN\") or use a proper password hashing library.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00901.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt(99) to generate a random number for a 'rememberMe' cookie value. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'int randNumber = new java.security.SecureRandom().nextInt(99);'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00902.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt() to generate a random number for a 'rememberMe' cookie value. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: 'int r = new java.security.SecureRandom().nextInt();'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00903.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false. This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: 'cookie.setSecure(true);'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00960.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() uses a predictable pseudo-random number generator that is not cryptographically secure. An attacker can predict future values and forge authentication tokens.\n\nImpact: An attacker can predict the rememberMe token values and forge authentication cookies to impersonate other users, leading to unauthorized access and session hijacking.\n\nFix: Use java.security.SecureRandom instead of Math.random() for generating security-sensitive tokens: `SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[16]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00961.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) via MessageDigest.getInstance(\"SHA1\", \"SUN\") for hashing sensitive data. SHA-1 is cryptographically broken and should not be used for security purposes. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge hash values or reverse-engineer hashed data, compromising the integrity and confidentiality of sensitive information stored in passwordFile.txt.\n\nFix: Replace SHA-1 with a strong hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00963.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm MD5 Used\n\nThe code uses MD5 via MessageDigest.getInstance(\"MD5\") for hashing sensitive data. MD5 is cryptographically broken with known collision vulnerabilities and should not be used for security purposes. The vulnerability is the algorithm choice itself.\n\nImpact: An attacker could exploit MD5 collision vulnerabilities to forge hash values or reverse-engineer hashed data, compromising the integrity and confidentiality of sensitive information stored in passwordFile.txt.\n\nFix: Replace MD5 with a strong hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00964.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file at runtime (benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\")). This allows the algorithm to be externally configured, potentially allowing a weak algorithm to be specified. The default fallback \"SHA5\" is not a valid algorithm name (should be \"SHA-512\"), which would cause NoSuchAlgorithmException.\n\nImpact: If the properties file is compromised or misconfigured, a weak hash algorithm like MD5 or SHA-1 could be used, compromising the security of hashed data. The invalid default would cause runtime failures.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) directly in the code rather than loading it from external configuration. If configuration is required, validate that only approved strong algorithms are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00965.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file at runtime (benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\")). This allows the algorithm to be externally configured, potentially allowing a weak algorithm to be specified. The default fallback \"SHA5\" is not a valid algorithm name.\n\nImpact: If the properties file is compromised or misconfigured, a weak hash algorithm like MD5 or SHA-1 could be used, compromising the security of hashed data.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) directly in the code rather than loading it from external configuration. If configuration is required, validate that only approved strong algorithms are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00966.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file at runtime (benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\")). This allows the algorithm to be externally configured, potentially allowing a weak algorithm to be specified.\n\nImpact: If the properties file is compromised or misconfigured, a weak hash algorithm like MD5 or SHA-1 could be used, compromising the security of hashed data.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) directly in the code rather than loading it from external configuration. If configuration is required, validate that only approved strong algorithms are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00967.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file at runtime (benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\")). This allows the algorithm to be externally configured, potentially allowing a weak algorithm to be specified.\n\nImpact: If the properties file is compromised or misconfigured, a weak hash algorithm like MD5 or SHA-1 could be used, compromising the security of hashed data.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) directly in the code rather than loading it from external configuration. If configuration is required, validate that only approved strong algorithms are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00977.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false (cookie.setSecure(false)). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: `cookie.setSecure(true);`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00991.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from a cookie is stored directly as a session attribute key via putValue(). The cookie value flows through HtmlUtils.htmlEscape() but HTML escaping does not prevent trust boundary violations. An attacker can control the session key name, potentially overwriting critical session attributes.\n\nImpact: An attacker could manipulate session state by controlling attribute key names, potentially leading to session fixation, privilege escalation, or application logic bypass.\n\nFix: Validate and sanitize the cookie value against a whitelist of allowed session key names before storing in the session. Do not allow user input to directly control session attribute keys.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00994.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Value\n\nUser-controlled data from a cookie is stored directly as a session attribute value via putValue(). The cookie value flows through HtmlUtils.htmlEscape() but HTML escaping does not prevent trust boundary violations. The session is a trusted context and should not contain unvalidated user input.\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning, where malicious data persists across requests and may be used in security-sensitive operations without proper validation.\n\nFix: Validate and sanitize the cookie value before storing in the session. Implement proper input validation to ensure only expected, safe values are stored in session attributes.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00995.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from a cookie is stored directly as a session attribute key via setAttribute(). The cookie value is split but remains user-controlled. An attacker can control the session key name, potentially overwriting critical session attributes.\n\nImpact: An attacker could manipulate session state by controlling attribute key names, potentially leading to session fixation, privilege escalation, or application logic bypass.\n\nFix: Validate and sanitize the cookie value against a whitelist of allowed session key names before storing in the session. Do not allow user input to directly control session attribute keys.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01041.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm via Runtime Configuration\n\nThe hash algorithm is loaded from an external properties file at runtime. If the properties file is configured with a weak algorithm (MD5, SHA-1), the application will use that weak algorithm for hashing sensitive data (passwords). The algorithm choice is not hardcoded and depends on external configuration.\n\nImpact: If the properties file contains a weak hash algorithm like MD5 or SHA-1, an attacker who obtains the hashed passwords could use rainbow tables or brute force attacks to recover the original passwords much more easily than with a strong algorithm.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) instead of loading it from a properties file. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of MessageDigest.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01042.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm via Runtime Configuration\n\nThe hash algorithm is loaded from an external properties file at runtime. If the properties file is configured with a weak algorithm (MD5, SHA-1), the application will use that weak algorithm for hashing sensitive data (passwords). The algorithm choice is not hardcoded and depends on external configuration.\n\nImpact: If the properties file contains a weak hash algorithm like MD5 or SHA-1, an attacker who obtains the hashed passwords could use rainbow tables or brute force attacks to recover the original passwords much more easily than with a strong algorithm.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) instead of loading it from a properties file. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of MessageDigest.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01043.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm via Runtime Configuration\n\nThe hash algorithm is loaded from an external properties file at runtime. If the properties file is configured with a weak algorithm (MD5, SHA-1), the application will use that weak algorithm for hashing sensitive data (passwords). The algorithm choice is not hardcoded and depends on external configuration.\n\nImpact: If the properties file contains a weak hash algorithm like MD5 or SHA-1, an attacker who obtains the hashed passwords could use rainbow tables or brute force attacks to recover the original passwords much more easily than with a strong algorithm.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) instead of loading it from a properties file. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of MessageDigest.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01044.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm via Runtime Configuration\n\nThe hash algorithm is loaded from an external properties file at runtime. If the properties file is configured with a weak algorithm (MD5, SHA-1), the application will use that weak algorithm for hashing sensitive data (passwords). The algorithm choice is not hardcoded and depends on external configuration.\n\nImpact: If the properties file contains a weak hash algorithm like MD5 or SHA-1, an attacker who obtains the hashed passwords could use rainbow tables or brute force attacks to recover the original passwords much more easily than with a strong algorithm.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) instead of loading it from a properties file. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of MessageDigest.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01045.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm via Runtime Configuration\n\nThe hash algorithm is loaded from an external properties file at runtime. If the properties file is configured with a weak algorithm (MD5, SHA-1), the application will use that weak algorithm for hashing sensitive data (passwords). The algorithm choice is not hardcoded and depends on external configuration.\n\nImpact: If the properties file contains a weak hash algorithm like MD5 or SHA-1, an attacker who obtains the hashed passwords could use rainbow tables or brute force attacks to recover the original passwords much more easily than with a strong algorithm.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) instead of loading it from a properties file. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of MessageDigest.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01061.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false via cookie.setSecure(false). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker intercepting HTTP traffic can steal the cookie value, potentially leading to session hijacking or other security compromises depending on the cookie's purpose.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01119.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker, compromising the session management mechanism.\n\nImpact: An attacker can predict or brute-force the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.lang.Math.random() with java.security.SecureRandom for generating security-sensitive values like session tokens. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01123.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations like password hashing. The algorithm is vulnerable to collision attacks.\n\nImpact: An attacker could potentially generate collisions or reverse the hash, compromising the integrity and confidentiality of hashed data. This is especially critical since the code appears to be hashing and storing sensitive values in a password file.\n\nFix: Replace SHA-1 with a strong hashing algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\", \"SUN\")",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01134.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false (cookie.setSecure(false)). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01165.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm (SHA-1)\n\nThe code uses SHA-1 hashing algorithm which is cryptographically weak and vulnerable to collision attacks. SHA-1 has been deprecated for security-sensitive applications.\n\nImpact: An attacker may be able to generate collisions, compromising the integrity of hashed data. For password storage, this could allow authentication bypass.\n\nFix: Use a strong hashing algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01166.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm (SHA-1)\n\nThe code uses SHA-1 hashing algorithm which is cryptographically weak and vulnerable to collision attacks. SHA-1 has been deprecated for security-sensitive applications.\n\nImpact: An attacker may be able to generate collisions, compromising the integrity of hashed data. For password storage, this could allow authentication bypass.\n\nFix: Use a strong hashing algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01167.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm (MD5)\n\nThe code uses MD5 hashing algorithm which is cryptographically broken and vulnerable to collision attacks. MD5 should not be used for any security-sensitive purposes.\n\nImpact: An attacker can easily generate collisions, completely compromising the integrity of hashed data. For password storage, this allows trivial authentication bypass.\n\nFix: Use a strong hashing algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01168.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm\n\nThe hashing algorithm is loaded from a properties file at runtime. While the default is SHA512 (secure), the actual algorithm used depends on external configuration which could be modified to use a weak algorithm like MD5 or SHA1.\n\nImpact: If the properties file is compromised or misconfigured, a weak hashing algorithm could be used, compromising data integrity and security.\n\nFix: Hardcode the use of a strong hashing algorithm (SHA-256 or stronger) in the code rather than loading it from configuration. If configuration is required, validate that only approved strong algorithms are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01185.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is explicitly set with the secure flag as false, allowing it to be transmitted over unencrypted HTTP connections.\n\nImpact: The cookie can be intercepted by attackers performing man-in-the-middle attacks on unencrypted connections, potentially leading to session hijacking.\n\nFix: Set the secure flag to true: cookie.setSecure(true); to ensure the cookie is only transmitted over HTTPS.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01186.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is explicitly set with the secure flag as false, allowing it to be transmitted over unencrypted HTTP connections.\n\nImpact: The cookie can be intercepted by attackers performing man-in-the-middle attacks on unencrypted connections, potentially leading to session hijacking.\n\nFix: Set the secure flag to true: cookie.setSecure(true); to ensure the cookie is only transmitted over HTTPS.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01187.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is explicitly set with the secure flag as false, allowing it to be transmitted over unencrypted HTTP connections.\n\nImpact: The cookie can be intercepted by attackers performing man-in-the-middle attacks on unencrypted connections, potentially leading to session hijacking.\n\nFix: Set the secure flag to true: cookie.setSecure(true); to ensure the cookie is only transmitted over HTTPS.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01203.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from the HTTP header 'BenchmarkTest01203' is stored directly into the HttpSession via putValue() without validation. The data flows from request.getHeaders() through a HashMap and is then stored in the session as 'userid'. This violates trust boundaries by placing untrusted user input into a trusted session context.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. Consider using a separate data structure for user-provided data that is clearly marked as untrusted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01204.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from the HTTP header 'BenchmarkTest01204' is stored directly into the HttpSession via putValue() without validation. The data flows through a complex propagation chain including StringBuilder operations, HashMap storage, Base64 encoding/decoding, and reflection (ThingFactory.createThing().doSomething()), but remains tainted throughout. The final tainted value is stored in the session as 'userid'.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. Consider using a separate data structure for user-provided data that is clearly marked as untrusted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01206.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from the HTTP header 'BenchmarkTest01206' is stored directly into the HttpSession via putValue() without validation. The data flows from request.getHeaders() through minor string manipulation (StringBuilder.replace()) but remains tainted. The final tainted value is stored in the session as 'userid'.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. Consider using a separate data structure for user-provided data that is clearly marked as untrusted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01244.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 in BenchmarkTest01244\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The code appears to be hashing sensitive values (passwords) for storage.\n\nImpact: SHA-1 collisions can be generated, allowing attackers to forge hash values or crack hashed passwords more easily than with modern algorithms.\n\nFix: Use SHA-256, SHA-384, SHA-512, or SHA-3 family algorithms for hashing. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01246.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 in BenchmarkTest01246\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The code appears to be hashing sensitive values (passwords) for storage. Additionally, the switch statement evaluates `guess.charAt(2)` where guess=\"ABC\", resulting in 'C', which matches case 'C' and assigns param (user input) to bar, but this is not a vulnerability since the hash algorithm itself is the issue.\n\nImpact: SHA-1 collisions can be generated, allowing attackers to forge hash values or crack hashed passwords more easily than with modern algorithms.\n\nFix: Use SHA-256, SHA-384, SHA-512, or SHA-3 family algorithms for hashing. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01247.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm MD5 in BenchmarkTest01247\n\nThe code uses MD5 hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken with known collision vulnerabilities and should not be used for security-sensitive operations. The code appears to be hashing sensitive values (passwords) for storage.\n\nImpact: MD5 collisions can be easily generated, allowing attackers to forge hash values or crack hashed passwords. MD5 is completely unsuitable for password storage or any security-critical hashing.\n\nFix: Use SHA-256, SHA-384, SHA-512, or SHA-3 family algorithms for hashing. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01248.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm in BenchmarkTest01248\n\nThe code loads the hash algorithm from a properties file via `benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\")`. While the default is SHA512 (secure), the algorithm is runtime-configurable from an external source. If the properties file is modified to specify a weak algorithm like MD5 or SHA1, the system becomes vulnerable. This represents a configuration-based weakness.\n\nImpact: If the properties file is compromised or misconfigured to use weak algorithms (MD5, SHA1), password hashes become vulnerable to collision attacks and easier cracking.\n\nFix: Hardcode the use of strong hash algorithms (SHA-256 or stronger) in the code rather than loading from configuration files. For password hashing, use dedicated password hashing functions like bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01249.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm in BenchmarkTest01249\n\nThe code loads the hash algorithm from a properties file via `benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\")`. The default value \"SHA5\" is not a valid algorithm name (would throw NoSuchAlgorithmException), but more importantly, the algorithm is runtime-configurable from an external source. If the properties file specifies a weak algorithm like MD5 or SHA1, the system becomes vulnerable.\n\nImpact: If the properties file is configured to use weak algorithms (MD5, SHA1), password hashes become vulnerable to collision attacks and easier cracking.\n\nFix: Hardcode the use of strong hash algorithms (SHA-256 or stronger) in the code rather than loading from configuration files. For password hashing, use dedicated password hashing functions like bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01250.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm in BenchmarkTest01250\n\nThe code loads the hash algorithm from a properties file via `benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\")`. The default value \"SHA5\" is not a valid algorithm name (would throw NoSuchAlgorithmException), but more importantly, the algorithm is runtime-configurable from an external source. If the properties file specifies a weak algorithm like MD5 or SHA1, the system becomes vulnerable. The user input flows through ThingFactory.createThing().doSomething() (a pass-through).\n\nImpact: If the properties file is configured to use weak algorithms (MD5, SHA1), password hashes become vulnerable to collision attacks and easier cracking.\n\nFix: Hardcode the use of strong hash algorithms (SHA-256 or stronger) in the code rather than loading from configuration files. For password hashing, use dedicated password hashing functions like bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01280.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie is explicitly set with setSecure(false), which allows the cookie to be transmitted over unencrypted HTTP connections. This exposes the cookie value to network eavesdropping and man-in-the-middle attacks.\n\nImpact: An attacker on the network path could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: cookie.setSecure(true); This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01281.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false via cookie.setSecure(false). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker intercepting HTTP traffic can steal the cookie value, potentially leading to session hijacking or other security breaches depending on the cookie's purpose.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01282.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false via cookie.setSecure(false). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker intercepting HTTP traffic can steal the cookie value, potentially leading to session hijacking or other security breaches depending on the cookie's purpose.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01283.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false via cookie.setSecure(false). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker intercepting HTTP traffic can steal the cookie value, potentially leading to session hijacking or other security breaches depending on the cookie's purpose.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01299.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request.getParameter(\"BenchmarkTest01299\") is passed through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and then stored directly in the HTTP session via request.getSession().putValue(\"userid\", bar) without validation. This violates the trust boundary between user input and trusted session storage.\n\nImpact: An attacker can inject arbitrary data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks depending on how the session data is used elsewhere in the application.\n\nFix: Validate and sanitize user input before storing it in the session. Implement whitelist validation to ensure only expected values are stored. Consider using a separate validated object or enum rather than storing raw user input directly in the session.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01333.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm (MD5)\n\nThe code uses MD5 (Message Digest 5) for hashing via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and unsuitable for security purposes due to collision vulnerabilities. The weakness is in the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially generate collisions, allowing them to create different inputs that produce the same hash value. This undermines the integrity guarantees that hashing is meant to provide, especially for password storage or data integrity verification.\n\nFix: Replace MD5 with a strong cryptographic hash function such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01334.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm (MD5)\n\nThe code uses MD5 (Message Digest 5) for hashing via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and unsuitable for security purposes due to collision vulnerabilities. The weakness is in the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially generate collisions, allowing them to create different inputs that produce the same hash value. This undermines the integrity guarantees that hashing is meant to provide, especially for password storage or data integrity verification.\n\nFix: Replace MD5 with a strong cryptographic hash function such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01374.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data as Session Key\n\nUser-controlled data from request parameter 'BenchmarkTest01374' is stored directly as a session key via request.getSession().putValue(bar, \"10340\"). The parameter value flows through Base64 encoding/decoding (which does not sanitize) and is then used as the session attribute name. This violates the trust boundary between user input and the trusted session storage.\n\nImpact: An attacker can control session key names, potentially overwriting critical session attributes, causing session fixation, or interfering with application logic that relies on specific session keys.\n\nFix: Validate and sanitize user input before using it as a session key. Use a whitelist of allowed key names or map user input to predefined safe keys. Never allow user input to directly control session attribute names.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01375.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest01375' is stored directly into the session via request.getSession().putValue(\"userid\", bar). The parameter flows through a complex propagation chain (StringBuilder, HashMap, Base64, split, ThingFactory.createThing().doSomething()) but remains tainted throughout. The data is stored in the trusted session context without validation.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other attacks when the session data is later retrieved and used by the application.\n\nFix: Validate and sanitize all user input before storing it in the session. Apply appropriate input validation based on expected data format and use case. Consider using HTML encoding only for display purposes, not as a trust boundary sanitizer.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01376.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest01376' is stored directly into the session via request.getSession().setAttribute(\"userid\", bar). The ternary condition (7*42) - 106 > 200 evaluates to 188 > 200 which is false, so bar is assigned the user parameter. This tainted data is then stored in the session without validation.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other attacks when the session data is later retrieved and used by the application.\n\nFix: Validate and sanitize all user input before storing it in the session. Apply appropriate input validation based on expected data format and use case.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01411.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially exploit weaknesses in SHA-1 to create hash collisions, compromising the integrity of password storage or other security mechanisms that rely on this hash.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2. Example: MessageDigest.getInstance(\"SHA-256\", \"SUN\")",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01455.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter name is stored directly into the HTTP session via putValue() without validation. The parameter name (derived from request.getParameterNames()) flows through doSomething() which performs a substring operation but does not sanitize the data, and is then stored in the session with key 'userid'.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the data is later retrieved and used.\n\nFix: Validate and sanitize user input before storing it in the session. Consider using a whitelist of allowed values or implementing proper input validation to ensure only expected data types and formats are stored in the trusted session context.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01456.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter name is stored directly into the HTTP session via putValue() without validation. The parameter name flows through doSomething() where the condition (500/42)+196 > 200 evaluates to true (207 > 200), causing bar to be assigned the tainted param value, which is then stored in the session.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the data is later retrieved and used.\n\nFix: Validate and sanitize user input before storing it in the session. Consider using a whitelist of allowed values or implementing proper input validation to ensure only expected data types and formats are stored in the trusted session context.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01457.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter name is stored directly into the HTTP session via putValue() without validation. The parameter name flows through doSomething() where a switch statement on 'C' (from 'ABC'.charAt(2)) assigns param to bar, which is then stored in the session with key 'userid'.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the data is later retrieved and used.\n\nFix: Validate and sanitize user input before storing it in the session. Consider using a whitelist of allowed values or implementing proper input validation to ensure only expected data types and formats are stored in the trusted session context.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01458.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Controls Session Key Name\n\nUser-controlled data from request parameter name is used as the session attribute key name via setAttribute() without validation. The parameter name flows through a complex propagation chain in doSomething() and ultimately controls the key name under which data is stored in the session. This allows an attacker to control session key names.\n\nImpact: An attacker can control session attribute key names, potentially overwriting existing session attributes, causing denial of service, or manipulating application state by controlling which session keys are set.\n\nFix: Never allow user input to control session attribute key names. Use a fixed, application-controlled key name and validate/sanitize the value before storing it in the session.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01503.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) hash algorithm via MessageDigest.getInstance(\"SHA1\"). SHA-1 is cryptographically broken and vulnerable to collision attacks. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: Attackers can generate collisions, potentially allowing them to forge data that produces the same hash value, compromising data integrity and authentication mechanisms that rely on this hash.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512: `MessageDigest md = MessageDigest.getInstance(\"SHA-256\", provider[0]);`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01504.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm MD5 Used\n\nThe code uses MD5 hash algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and vulnerable to collision attacks. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: Attackers can generate collisions, potentially allowing them to forge data that produces the same hash value, compromising data integrity and authentication mechanisms that rely on this hash.\n\nFix: Replace MD5 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512: `MessageDigest md = MessageDigest.getInstance(\"SHA-256\");`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01521.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe application creates a cookie with the secure flag explicitly set to false via cookie.setSecure(false). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks on insecure networks.\n\nImpact: An attacker on the network path could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or exposure of sensitive data stored in the cookie.\n\nFix: Set the secure flag to true by calling cookie.setSecure(true) to ensure the cookie is only transmitted over HTTPS connections. This prevents the cookie from being sent over unencrypted channels.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01551.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from request parameter 'BenchmarkTest01551' is stored directly into the HTTP session via setAttribute(). The parameter flows through SeparateClassRequest.getTheParameter() (which returns request.getParameter() unchanged), then through the Test.doSomething() method where '_SafeStuff' is appended, but the base value remains user-controlled. Even though HTML encoding is applied for display, the trust boundary violation occurs when unvalidated user input is stored in the session.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement a whitelist of allowed values or apply strict input validation rules.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01648.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Context\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict or brute-force the rememberMe cookie values, allowing them to hijack user sessions and impersonate legitimate users.\n\nFix: Use java.security.SecureRandom instead of Math.random() for generating security-sensitive tokens: 'SecureRandom sr = new SecureRandom(); byte[] token = new byte[16]; sr.nextBytes(token);'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01651.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) hash algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could potentially exploit weaknesses in SHA-1 to create hash collisions or reverse the hash, compromising the security of hashed passwords stored in passwordFile.txt.\n\nFix: Replace SHA-1 with a strong hash algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01653.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm MD5 Used\n\nThe code uses MD5 hash algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could exploit weaknesses in MD5 to create hash collisions or reverse the hash, compromising the security of hashed passwords stored in passwordFile.txt.\n\nFix: Replace MD5 with a strong hash algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01654.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file (benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\")). While the default is SHA-512 (secure), the algorithm can be changed via configuration to a weak algorithm like MD5 or SHA-1 without code changes.\n\nImpact: If the properties file is modified to specify a weak algorithm, the system would use that weak algorithm for password hashing, compromising security.\n\nFix: Hard-code a strong hash algorithm (SHA-256 or stronger) in the code rather than loading it from configuration. If configurability is required, validate that only approved strong algorithms can be used.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01655.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file (benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\")). The default value \"SHA5\" is not a valid algorithm name and would cause a NoSuchAlgorithmException. More importantly, the algorithm can be changed via configuration to a weak algorithm.\n\nImpact: If the properties file specifies a weak algorithm like MD5 or SHA-1, the system would use that weak algorithm for password hashing, compromising security.\n\nFix: Hard-code a strong hash algorithm (SHA-256 or stronger) in the code rather than loading it from configuration. If configurability is required, validate that only approved strong algorithms can be used.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01656.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file (benchmarkprops.getProperty(\"hashAlg2\", \"SHA5\")). The default value \"SHA5\" is not a valid algorithm name and would cause a NoSuchAlgorithmException. More importantly, the algorithm can be changed via configuration to a weak algorithm.\n\nImpact: If the properties file specifies a weak algorithm like MD5 or SHA-1, the system would use that weak algorithm for password hashing, compromising security.\n\nFix: Hard-code a strong hash algorithm (SHA-256 or stronger) in the code rather than loading it from configuration. If configurability is required, validate that only approved strong algorithms can be used.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_79.CWE-79",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01671.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Cross-Site Scripting (XSS) - Disabled XSS Protection\n\nThe code explicitly disables XSS protection with X-XSS-Protection: 0 header. While the user input is HTML-encoded via ESAPI.encoder().encodeForHTML(), the explicit disabling of browser XSS protection is a security misconfiguration that weakens defense-in-depth.\n\nImpact: Reduces browser-level XSS protection, making the application more vulnerable if the encoding is bypassed or fails.\n\nFix: Remove the X-XSS-Protection: 0 header or set it to '1; mode=block' to enable browser XSS protection.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-79"
          ],
          "owasp": "A7: Cross-Site Scripting (XSS)"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01682.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie is explicitly set with the secure flag set to false, allowing it to be transmitted over unencrypted HTTP connections.\n\nImpact: The cookie can be intercepted by attackers performing man-in-the-middle attacks on unencrypted HTTP traffic, potentially exposing sensitive session data.\n\nFix: Set the secure flag to true: `cookie.setSecure(true);` to ensure the cookie is only transmitted over HTTPS.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01683.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie is explicitly set with the secure flag set to false, allowing it to be transmitted over unencrypted HTTP connections.\n\nImpact: The cookie can be intercepted by attackers performing man-in-the-middle attacks on unencrypted HTTP traffic, potentially exposing sensitive session data.\n\nFix: Set the secure flag to true: `cookie.setSecure(true);` to ensure the cookie is only transmitted over HTTPS.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01711.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from the query string parameter 'BenchmarkTest01711' is stored directly into the HTTP session via setAttribute(). The doSomething() method evaluates the condition (500/42)+196 > 200, which equals 11+196=207 > 200 (true), so bar is assigned param (user input). This tainted data is then stored in the session without validation.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks.\n\nFix: Validate and sanitize user input before storing it in the session. Implement strict input validation rules and consider using a whitelist approach for acceptable values.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01757.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing, which is cryptographically weak and vulnerable to collision attacks. SHA-1 has been deprecated for security-sensitive applications since 2017.\n\nImpact: An attacker may be able to generate hash collisions, potentially compromising password storage, digital signatures, or integrity verification mechanisms.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01761.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. SHA-1 has known collision vulnerabilities that can be exploited by attackers.\n\nImpact: An attacker could potentially generate hash collisions, compromising the integrity of password storage or other security mechanisms relying on this hash function.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01765.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm\n\nThe hash algorithm is loaded from a properties file at runtime via benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). If the properties file is modified to specify a weak algorithm like MD5 or SHA-1, the application becomes vulnerable to weak hashing attacks. The algorithm choice should be hardcoded to a secure value.\n\nImpact: If an attacker can modify the properties file or if it is misconfigured, weak algorithms like MD5 or SHA-1 could be used, enabling hash collision attacks and compromising password security.\n\nFix: Hardcode the hash algorithm to a secure value like SHA-256 or SHA-512 instead of loading it from a configuration file. For password hashing, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01766.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm\n\nThe hash algorithm is loaded from a properties file at runtime via benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). If the properties file is modified to specify a weak algorithm like MD5 or SHA-1, the application becomes vulnerable to weak hashing attacks. The algorithm choice should be hardcoded to a secure value.\n\nImpact: If an attacker can modify the properties file or if it is misconfigured, weak algorithms like MD5 or SHA-1 could be used, enabling hash collision attacks and compromising password security.\n\nFix: Hardcode the hash algorithm to a secure value like SHA-256 or SHA-512 instead of loading it from a configuration file. For password hashing, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01782.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data flows through the doSomething method (which returns param unchanged after list manipulation) and is stored in the HTTP session. The bar variable contains user input from scr.getTheValue(), which is then used in the session context without validation.\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning attacks, where an attacker manipulates session data to escalate privileges or bypass security controls.\n\nFix: Validate and sanitize user input before storing it in the session, or avoid storing user-controlled data in the session entirely. Use server-generated, validated values instead.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01783.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data flows through ThingFactory.createThing().doSomething() (a pass-through that returns param unchanged) and is stored in the HTTP session without validation.\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning attacks, where an attacker manipulates session data to escalate privileges or bypass security controls.\n\nFix: Validate and sanitize user input before storing it in the session, or avoid storing user-controlled data in the session entirely. Use server-generated, validated values instead.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01784.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data flows through the doSomething method (which returns param unchanged after list manipulation) and is stored in the HTTP session without validation.\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning attacks, where an attacker manipulates session data to escalate privileges or bypass security controls.\n\nFix: Validate and sanitize user input before storing it in the session, or avoid storing user-controlled data in the session entirely. Use server-generated, validated values instead.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01785.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data flows through ThingFactory.createThing().doSomething() (a pass-through that returns param unchanged) and is stored in the HTTP session without validation.\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning attacks, where an attacker manipulates session data to escalate privileges or bypass security controls.\n\nFix: Validate and sanitize user input before storing it in the session, or avoid storing user-controlled data in the session entirely. Use server-generated, validated values instead.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01787.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data flows through HtmlUtils.htmlEscape() and is stored in the HTTP session. While HTML-escaped, this does not prevent trust boundary violations - the issue is storing user data in a trusted context (session), not the format.\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning attacks, where an attacker manipulates session data to escalate privileges or bypass security controls.\n\nFix: Validate and sanitize user input before storing it in the session, or avoid storing user-controlled data in the session entirely. Use server-generated, validated values instead.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01788.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data flows through the doSomething method (where bar = param due to the true condition) and is stored in the HTTP session without validation.\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning attacks, where an attacker manipulates session data to escalate privileges or bypass security controls.\n\nFix: Validate and sanitize user input before storing it in the session, or avoid storing user-controlled data in the session entirely. Use server-generated, validated values instead.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01789.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from scr.getTheValue() flows through the doSomething method (where bar = param due to the false condition in the ternary operator) and is used throughout the application without proper validation before being stored in session-like contexts.\n\nImpact: Storing unvalidated user input can lead to various attacks including session poisoning, where an attacker manipulates data to escalate privileges or bypass security controls.\n\nFix: Validate and sanitize user input before using it in security-sensitive contexts. Implement proper input validation and use server-generated values for security tokens.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01789.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is explicitly set with the secure flag set to false. This allows the cookie to be transmitted over unencrypted HTTP connections.\n\nImpact: An attacker performing a man-in-the-middle attack on an unencrypted connection can intercept the cookie value, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: `cookie.setSecure(true);`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01802.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored as Session Key\n\nUser-controlled data from SeparateClassRequest.getTheValue() flows through the doSomething() method and is stored directly as a session key via request.getSession().putValue(bar, \"10340\"). This violates the trust boundary between user input and the trusted session storage context.\n\nImpact: An attacker can control session key names, potentially overwriting legitimate session attributes, causing session confusion, or interfering with application logic that relies on specific session keys.\n\nFix: Validate and sanitize user input before using it as a session key. Use a whitelist of allowed key names or prefix user-controlled values with a constant string. Consider using a fixed set of session keys with user data stored as values instead.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01842.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used\n\nThe code uses java.lang.Math.random() to generate a random value for a 'rememberMe' authentication cookie. Math.random() is not cryptographically secure and should never be used for security-sensitive operations like session tokens or authentication keys.\n\nImpact: An attacker could predict the random values generated by Math.random(), allowing them to forge authentication cookies and impersonate other users, leading to unauthorized access.\n\nFix: Replace Math.random() with java.security.SecureRandom for all security-sensitive random number generation. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[16]; secureRandom.nextBytes(randomBytes);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01843.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator Used\n\nThe code uses java.lang.Math.random() to generate a random value for a 'rememberMe' authentication cookie. Math.random() is not cryptographically secure and should never be used for security-sensitive operations like session tokens or authentication keys.\n\nImpact: An attacker could predict the random values generated by Math.random(), allowing them to forge authentication cookies and impersonate other users, leading to unauthorized access.\n\nFix: Replace Math.random() with java.security.SecureRandom for all security-sensitive random number generation. Example: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[16]; secureRandom.nextBytes(randomBytes);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01844.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability exists regardless of what data is hashed - the algorithm choice itself is the security issue.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge hash values, compromise data integrity, or break authentication mechanisms that rely on these hashes.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. Use MessageDigest.getInstance(\"SHA-256\") or stronger variants.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01845.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability exists regardless of what data is hashed - the algorithm choice itself is the security issue.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge hash values, compromise data integrity, or break authentication mechanisms that rely on these hashes.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. Use MessageDigest.getInstance(\"SHA-256\") or stronger variants.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01846.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) as the hashing algorithm via MessageDigest.getInstance(). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability exists regardless of what data is hashed - the algorithm choice itself is the security issue.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge hash values, compromise data integrity, or break authentication mechanisms that rely on these hashes.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. Use MessageDigest.getInstance(\"SHA-256\") or stronger variants.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01853.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, making the token vulnerable to brute-force or prediction attacks.\n\nImpact: An attacker could predict or brute-force the rememberMe token, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens: new java.security.SecureRandom().nextBytes(bytes);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01854.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, making the token vulnerable to brute-force or prediction attacks.\n\nImpact: An attacker could predict or brute-force the rememberMe token, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01855.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, making the token vulnerable to brute-force or prediction attacks.\n\nImpact: An attacker could predict or brute-force the rememberMe token, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01856.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, making the token vulnerable to brute-force or prediction attacks.\n\nImpact: An attacker could predict or brute-force the rememberMe token, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01857.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, making the token vulnerable to brute-force or prediction attacks.\n\nImpact: An attacker could predict or brute-force the rememberMe token, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01858.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, making the token vulnerable to brute-force or prediction attacks.\n\nImpact: An attacker could predict or brute-force the rememberMe token, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01859.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, making the token vulnerable to brute-force or prediction attacks.\n\nImpact: An attacker could predict or brute-force the rememberMe token, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01860.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security Token\n\nThe application uses java.util.Random to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values, making the token vulnerable to brute-force or prediction attacks.\n\nImpact: An attacker could predict or brute-force the rememberMe token, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of java.util.Random for generating security-sensitive tokens.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01861.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nA cookie is created with the secure flag explicitly set to false via cookie.setSecure(false). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: cookie.setSecure(true). This ensures the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01911.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", provider[0]) or MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially exploit SHA-1 collision vulnerabilities to forge hash values, compromising the integrity of password storage or other security mechanisms relying on this hash.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01955.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key\n\nUser-controlled data from request header 'BenchmarkTest01955' is used as the session key name in putValue(). The header value flows through Base64 encode/decode (which is a pass-through operation) and is then used directly as the session attribute key. This allows an attacker to control what keys are stored in the session, potentially overwriting legitimate session attributes.\n\nImpact: An attacker can manipulate session storage by controlling the key names, potentially overwriting security-critical session attributes or causing session confusion attacks.\n\nFix: Do not use user-controlled data as session attribute keys. Use a fixed, application-defined key name instead. If dynamic keys are required, validate the input against a strict whitelist of allowed key names.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01958.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from request header 'BenchmarkTest01958' is stored directly into the HttpSession as a value without proper validation. The header value flows through doSomething() where only the last character is replaced with 'Z', but the data remains user-controlled and is then stored in the session under the 'userid' key via putValue().\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning attacks, where malicious data persists across requests and may be used in security decisions or displayed to other users.\n\nFix: Validate and sanitize all user input before storing it in the session. Implement strict input validation rules appropriate for the expected data type and use case. Consider using session data only for server-generated identifiers rather than user-supplied values.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01960.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data from request header 'BenchmarkTest01960' is stored directly into the HttpSession as a value without proper validation. The header value flows through doSomething() where only the last character is removed via substring(), but the data remains user-controlled and is then stored in the session under the 'userid' key via setAttribute().\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning attacks, where malicious data persists across requests and may be used in security decisions or displayed to other users.\n\nFix: Validate and sanitize all user input before storing it in the session. Implement strict input validation rules appropriate for the expected data type and use case. Consider using session data only for server-generated identifiers rather than user-supplied values.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01996.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file using benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). While the default is SHA512 (secure), the algorithm can be changed at runtime via the properties file to a weak algorithm like MD5 or SHA1. This creates a configuration-based vulnerability where an attacker with access to the properties file could downgrade the hash algorithm.\n\nImpact: If the properties file is modified to specify a weak hash algorithm (MD5, SHA1), password hashes could be vulnerable to collision attacks and rainbow table attacks, compromising stored credentials.\n\nFix: Hardcode a secure hash algorithm (SHA-256 or stronger) directly in the code instead of loading it from a properties file. If configuration is required, validate that only approved strong algorithms are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest01997.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm from Properties File\n\nThe hash algorithm is loaded from a properties file using benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). While the default is SHA512 (secure), the algorithm can be changed at runtime via the properties file to a weak algorithm like MD5 or SHA1. This creates a configuration-based vulnerability where an attacker with access to the properties file could downgrade the hash algorithm.\n\nImpact: If the properties file is modified to specify a weak hash algorithm (MD5, SHA1), password hashes could be vulnerable to collision attacks and rainbow table attacks, compromising stored credentials.\n\nFix: Hardcode a secure hash algorithm (SHA-256 or stronger) directly in the code instead of loading it from a properties file. If configuration is required, validate that only approved strong algorithms are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02001.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random().nextFloat()\n\nThe code uses java.util.Random().nextFloat() to generate a random value for a 'rememberMe' cookie key. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. This is used for session management, making it a security-sensitive context.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: java.security.SecureRandom.getInstance(\"SHA1PRNG\").nextFloat()",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02002.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random().nextInt()\n\nThe code uses java.util.Random().nextInt(99) to generate a random value for a 'rememberMe' cookie key. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. This is used for session management, making it a security-sensitive context.\n\nImpact: An attacker could predict the rememberMe cookie values (limited to 0-98), potentially allowing session hijacking or unauthorized access to user accounts. The small range makes brute-force attacks even more feasible.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: java.security.SecureRandom.getInstance(\"SHA1PRNG\").nextInt(99)",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02003.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random().nextInt()\n\nThe code uses java.util.Random().nextInt() to generate a random value for a 'rememberMe' cookie key. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. This is used for session management, making it a security-sensitive context.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: java.security.SecureRandom.getInstance(\"SHA1PRNG\").nextInt()",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02004.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator - java.util.Random().nextLong()\n\nThe code uses java.util.Random().nextLong() to generate a random value for a 'rememberMe' cookie key. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker. This is used for session management, making it a security-sensitive context.\n\nImpact: An attacker could predict the rememberMe cookie values, potentially allowing session hijacking or unauthorized access to user accounts.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographically secure random number generation: java.security.SecureRandom.getInstance(\"SHA1PRNG\").nextLong()",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02005.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false (cookie.setSecure(false)). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: cookie.setSecure(true)",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02038.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.lang.Math.random() to generate a rememberMe cookie value for session management. Math.random() is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session token generation.\n\nImpact: An attacker can predict or brute-force the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.lang.Math.random() with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02039.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.lang.Math.random() to generate a rememberMe cookie value for session management. Math.random() is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session token generation.\n\nImpact: An attacker can predict or brute-force the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.lang.Math.random() with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02040.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe application uses java.lang.Math.random() to generate a rememberMe cookie value for session management. Math.random() is not cryptographically secure and produces predictable values, making it unsuitable for security-sensitive operations like session token generation.\n\nImpact: An attacker can predict or brute-force the rememberMe cookie values, potentially hijacking user sessions and gaining unauthorized access to user accounts.\n\nFix: Replace java.lang.Math.random() with java.security.SecureRandom for generating security-sensitive tokens: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02042.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 Used\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could potentially exploit weaknesses in SHA-1 to create hash collisions, compromising the integrity of hashed data. This is especially critical when hashing passwords or other sensitive data.\n\nFix: Replace SHA-1 with a stronger hash algorithm like SHA-256, SHA-384, or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02043.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm\n\nThe code loads the hash algorithm from a properties file with a default value of \"SHA5\" (which is invalid and would throw NoSuchAlgorithmException). The algorithm is runtime-configured, allowing potential misconfiguration to use weak algorithms like MD5 or SHA-1.\n\nImpact: If the properties file is misconfigured to specify a weak algorithm (MD5, SHA-1), the system would use cryptographically broken hashing. This could allow attackers to exploit hash collisions or brute-force attacks.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) instead of loading it from configuration. If runtime configuration is required, validate the algorithm against a whitelist of approved strong algorithms before use.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02044.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm\n\nThe code loads the hash algorithm from a properties file with a default value of \"SHA5\" (which is invalid and would throw NoSuchAlgorithmException). The algorithm is runtime-configured, allowing potential misconfiguration to use weak algorithms like MD5 or SHA-1.\n\nImpact: If the properties file is misconfigured to specify a weak algorithm (MD5, SHA-1), the system would use cryptographically broken hashing. This could allow attackers to exploit hash collisions or brute-force attacks.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) instead of loading it from configuration. If runtime configuration is required, validate the algorithm against a whitelist of approved strong algorithms before use.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02061.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict the rememberMe cookie values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: `int r = new java.security.SecureRandom().nextInt();`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02061.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from the request header (param) flows through doSomething() and is stored directly in the HTTP session via setAttribute(). The ternary condition `(7*42)-106 > 200` evaluates to `294-106=188 > 200` which is FALSE, so bar is assigned param (user input).\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning, where attackers inject malicious data into trusted session storage.\n\nFix: Validate and sanitize user input before storing it in the session. Consider using a whitelist approach or encoding the data appropriately.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02062.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe cookie values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: `int r = new java.security.SecureRandom().nextInt();`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02063.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' cookie value for session management. java.util.Random is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe cookie values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: `long l = new java.security.SecureRandom().nextLong();`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02063.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from the request header (param) flows through doSomething() where it's split and the first element is assigned to bar, then stored in the HTTP session via setAttribute().\n\nImpact: Storing unvalidated user input in the session can lead to session poisoning, where attackers inject malicious data into trusted session storage.\n\nFix: Validate and sanitize user input before storing it in the session. Consider using a whitelist approach or encoding the data appropriately.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02084.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from HTTP header 'BenchmarkTest02084' is passed through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and stored directly into HttpSession via setAttribute(). The data flows: request.getHeaders() \u2192 param \u2192 doSomething(param) \u2192 bar \u2192 session.setAttribute('userid', bar). ThingFactory.createThing().doSomething() is a pass-through method that returns its input unchanged, so bar contains the tainted header value.\n\nImpact: An attacker can inject malicious data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks when the session data is later retrieved and used.\n\nFix: Validate and sanitize user input before storing it in the session. Implement strict input validation rules, whitelist acceptable values, and consider using a separate validation layer before session storage.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02087.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Input Stored in Session\n\nUser-controlled data from HTTP header 'BenchmarkTest02087' is passed through ThingFactory.createThing().doSomething() (a pass-through that returns input unchanged) and used in a SQL query. While the primary vulnerability here is SQL injection, the pattern of using unsanitized user input directly is a trust boundary violation.\n\nImpact: An attacker can inject malicious SQL commands, potentially leading to unauthorized data access, data modification, or complete database compromise.\n\nFix: Use parameterized queries for all user input. Replace string concatenation with PreparedStatement parameter binding: statement.setString(2, bar).",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02117.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe code uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values that can be guessed by attackers.\n\nImpact: An attacker could predict or brute-force the rememberMe cookie values, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Replace Math.random() with java.security.SecureRandom for cryptographically secure random number generation: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02118.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 for hashing sensitive values. SHA-1 is cryptographically broken and vulnerable to collision attacks. It should not be used for security-sensitive operations.\n\nImpact: An attacker could potentially generate collisions or reverse the hash through known attacks against SHA-1, compromising the integrity and confidentiality of hashed data.\n\nFix: Replace SHA-1 with a stronger hash algorithm like SHA-256, SHA-384, or SHA-512: MessageDigest.getInstance(\"SHA-256\")",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02141.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session key. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker who observes previous outputs or knows the seed.\n\nImpact: An attacker could predict the rememberMe cookie values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: `long l = new java.security.SecureRandom().nextLong();`",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02142.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie is created with setSecure(false), which means it will be transmitted over unencrypted HTTP connections. This exposes the cookie value to network eavesdropping and man-in-the-middle attacks.\n\nImpact: An attacker on the network can intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: `cookie.setSecure(true);` to ensure the cookie is only transmitted over HTTPS.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02165.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User-Controlled Session Key Name\n\nUser-controlled data (from request parameter 'BenchmarkTest02165') is used as the key name in HttpSession.putValue(). Even though the data is HTML-encoded, HTML encoding does not prevent trust boundary violations. The issue is storing user-controlled data in a trusted context (session), allowing an attacker to control session attribute names.\n\nImpact: An attacker can control session attribute names, potentially overwriting critical session data or causing application logic errors by manipulating session keys.\n\nFix: Do not use user-controlled data as session attribute names. Use a fixed, application-controlled key name instead. If dynamic keys are required, validate against a strict whitelist of allowed values.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_501.CWE-501",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02167.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Trust Boundary Violation - User Data Stored in Session\n\nUser-controlled data (from request parameter 'BenchmarkTest02167') is stored directly into HttpSession via setAttribute() without validation. The ThingFactory.createThing().doSomething() method is a pass-through that returns user input unchanged. This violates the trust boundary between user-controlled data and the trusted session context.\n\nImpact: An attacker can inject arbitrary data into the session, potentially leading to session poisoning, privilege escalation, or other session-based attacks depending on how the session data is used elsewhere in the application.\n\nFix: Validate and sanitize user input before storing it in the session. Implement strict input validation against expected formats and values. Consider using indirect references (e.g., mapping user input to safe internal values) rather than storing raw user data in the session.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-501"
          ],
          "owasp": "A2: Broken Authentication"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02209.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator for Security-Sensitive Operation\n\nThe code uses java.lang.Math.random() to generate a rememberMe cookie value for session management. Math.random() is not cryptographically secure and produces predictable values. An attacker who can observe or predict the random values can forge session cookies.\n\nImpact: An attacker can predict or brute-force the rememberMe cookie values, allowing them to impersonate other users and hijack their sessions.\n\nFix: Replace Math.random() with java.security.SecureRandom for all security-sensitive random number generation: SecureRandom secureRandom = new SecureRandom(); byte[] randomBytes = new byte[32]; secureRandom.nextBytes(randomBytes); String rememberMeKey = Base64.getEncoder().encodeToString(randomBytes);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02211.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially find collisions or reverse the hash, compromising the integrity and confidentiality of hashed data. This is especially critical when hashing passwords or other sensitive values.\n\nFix: Replace SHA-1 with a stronger hashing algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02212.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially find collisions or reverse the hash, compromising the integrity and confidentiality of hashed data. This is especially critical when hashing passwords or other sensitive values.\n\nFix: Replace SHA-1 with a stronger hashing algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02213.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could potentially find collisions or reverse the hash, compromising the integrity and confidentiality of hashed data. This is especially critical when hashing passwords or other sensitive values.\n\nFix: Replace SHA-1 with a stronger hashing algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02217.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm (MD5)\n\nThe code uses MD5 hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker could easily find collisions or reverse the hash, compromising the integrity and confidentiality of hashed data. MD5 is particularly weak and has been broken for decades.\n\nFix: Replace MD5 with a stronger hashing algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02219.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hashing Algorithm (Runtime-Configured)\n\nThe code uses a runtime-configured hashing algorithm loaded from a properties file via benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). While the default is SHA512 (secure), the algorithm can be changed at runtime to a weak algorithm like MD5 or SHA-1 through the properties file, creating a potential security vulnerability.\n\nImpact: If the properties file is modified to specify a weak hashing algorithm (MD5, SHA-1), the system would use that weak algorithm, compromising the security of hashed data. An attacker with access to modify the properties file could downgrade the security.\n\nFix: Hardcode a strong hashing algorithm (SHA-256 or stronger) directly in the code rather than loading it from a configuration file. If runtime configuration is required, validate that only approved strong algorithms are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02307.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe application uses SHA-1 (MessageDigest.getInstance(\"SHA1\")) for hashing sensitive values. SHA-1 is cryptographically broken and vulnerable to collision attacks. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: An attacker may be able to generate collisions, potentially forging authentication tokens, bypassing integrity checks, or compromising password storage security if used for that purpose.\n\nFix: Replace SHA-1 with a strong cryptographic hash function like SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02308.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Use of Weak Cryptographic Hash Algorithm SHA-1\n\nThe application uses SHA-1 (MessageDigest.getInstance(\"SHA1\", \"SUN\")) for hashing sensitive values. SHA-1 is cryptographically broken and vulnerable to collision attacks.\n\nImpact: An attacker may be able to generate collisions, potentially compromising the security of hashed values, authentication mechanisms, or integrity checks.\n\nFix: Replace SHA-1 with a strong cryptographic hash function like SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02339.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with `setSecure(false)`, allowing it to be transmitted over unencrypted HTTP connections. This exposes the cookie value to network eavesdropping attacks.\n\nImpact: An attacker performing a man-in-the-middle attack on an unencrypted connection can intercept the cookie value, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true: `cookie.setSecure(true)` to ensure the cookie is only transmitted over HTTPS connections.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02385.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing, which is cryptographically weak and vulnerable to collision attacks. SHA-1 has been deprecated for security-sensitive applications since 2017.\n\nImpact: An attacker may be able to generate hash collisions, potentially bypassing authentication mechanisms or integrity checks that rely on this hash.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512. Update the code to use MessageDigest.getInstance('SHA-256') or stronger.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02386.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (SHA-1)\n\nThe code uses SHA-1 (SHA1) for hashing, which is cryptographically weak and vulnerable to collision attacks. SHA-1 has been deprecated for security-sensitive applications since 2017.\n\nImpact: An attacker may be able to generate hash collisions, potentially bypassing authentication mechanisms or integrity checks that rely on this hash.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, or SHA-512. Update the code to use MessageDigest.getInstance('SHA-256', 'SUN') or stronger.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02387.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (MD5)\n\nThe code uses MD5 for hashing, which is cryptographically broken and vulnerable to collision attacks. MD5 should not be used for any security-sensitive purposes.\n\nImpact: An attacker can easily generate hash collisions, completely bypassing any authentication or integrity checks that rely on MD5 hashing.\n\nFix: Replace MD5 with a strong hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02388.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Cryptographic Hash Algorithm (MD5)\n\nThe code uses MD5 for hashing, which is cryptographically broken and vulnerable to collision attacks. MD5 should not be used for any security-sensitive purposes.\n\nImpact: An attacker can easily generate hash collisions, completely bypassing any authentication or integrity checks that rely on MD5 hashing.\n\nFix: Replace MD5 with a strong hash algorithm such as SHA-256, SHA-384, or SHA-512. For password hashing, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02421.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: 'double stuff = new java.security.SecureRandom().nextGaussian();'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02422.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextGaussian() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: 'double stuff = new java.security.SecureRandom().nextGaussian();'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02423.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt(99) to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: 'int randNumber = new java.security.SecureRandom().nextInt(99);'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02424.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: 'int r = new java.security.SecureRandom().nextInt();'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02425.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextInt() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: 'int r = new java.security.SecureRandom().nextInt();'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02426.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator (java.util.Random)\n\nThe code uses java.util.Random().nextLong() to generate a 'rememberMe' session token. java.util.Random is not cryptographically secure and produces predictable values that can be guessed by an attacker.\n\nImpact: An attacker could predict the rememberMe token values, allowing them to forge authentication cookies and impersonate other users.\n\nFix: Replace java.util.Random with java.security.SecureRandom for cryptographic operations: 'long l = new java.security.SecureRandom().nextLong();'",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02427.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false (cookie.setSecure(false)). This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception.\n\nImpact: An attacker performing a man-in-the-middle attack on an unencrypted HTTP connection could intercept the cookie value and potentially hijack the user's session.\n\nFix: Set the secure flag to true: 'cookie.setSecure(true);' to ensure the cookie is only transmitted over HTTPS.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_330.CWE-330",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02473.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Random Number Generator\n\nThe application uses java.lang.Math.random() to generate a 'rememberMe' cookie value for session management. Math.random() is not cryptographically secure and produces predictable values.\n\nImpact: An attacker could predict the rememberMe token values, allowing session hijacking and unauthorized access to user accounts.\n\nFix: Use java.security.SecureRandom instead of Math.random() for generating security-sensitive tokens: SecureRandom sr = new SecureRandom(); byte[] token = new byte[16]; sr.nextBytes(token);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-330"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02474.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - SHA-1\n\nThe application uses SHA-1 hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security purposes.\n\nImpact: SHA-1 collisions can be generated, allowing attackers to forge data or bypass integrity checks. For password hashing, this is particularly dangerous.\n\nFix: Use SHA-256 or stronger (SHA-384, SHA-512, SHA3-256). For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02475.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - MD5\n\nThe application uses MD5 hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken with known collision vulnerabilities and should not be used for security purposes.\n\nImpact: MD5 collisions can be easily generated, allowing attackers to forge data, bypass integrity checks, or crack password hashes.\n\nFix: Use SHA-256 or stronger (SHA-384, SHA-512, SHA3-256). For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02476.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - MD5\n\nThe application uses MD5 hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken with known collision vulnerabilities and should not be used for security purposes.\n\nImpact: MD5 collisions can be easily generated, allowing attackers to forge data, bypass integrity checks, or crack password hashes.\n\nFix: Use SHA-256 or stronger (SHA-384, SHA-512, SHA3-256). For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02478.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm from Configuration\n\nThe application loads the hash algorithm from a properties file with benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). While the default is SHA512 (secure), the algorithm can be configured externally, potentially allowing a weak algorithm like MD5 or SHA-1 to be specified.\n\nImpact: If the properties file is modified to specify a weak algorithm, the application becomes vulnerable to hash collision attacks.\n\nFix: Hardcode a secure algorithm (SHA-256 or stronger) instead of loading it from configuration. If configuration is required, validate the algorithm against a whitelist of secure algorithms before use.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02507.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe cookie 'SomeCookie' is created with the secure flag explicitly set to false. This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or information disclosure.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: cookie.setSecure(true);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02573.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 in BenchmarkTest02573\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability is the algorithm choice itself, regardless of what data is hashed.\n\nImpact: SHA-1 is vulnerable to collision attacks. An attacker could potentially generate two different inputs that produce the same hash, compromising data integrity and authentication mechanisms.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3 variants. Use MessageDigest.getInstance(\"SHA-256\") or stronger.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02574.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm SHA-1 in BenchmarkTest02574\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\", \"SUN\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. The vulnerability is the algorithm choice itself.\n\nImpact: SHA-1 is vulnerable to collision attacks. An attacker could potentially generate two different inputs that produce the same hash, compromising data integrity and authentication mechanisms.\n\nFix: Replace SHA-1 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3 variants.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02575.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm MD5 in BenchmarkTest02575\n\nThe code uses MD5 hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and should not be used for security-sensitive operations like password hashing. The vulnerability is the algorithm choice itself.\n\nImpact: MD5 is vulnerable to collision attacks and can be cracked quickly with modern hardware. An attacker could generate hash collisions or crack hashed passwords.\n\nFix: Replace MD5 with a stronger hash algorithm such as SHA-256, SHA-384, SHA-512, or SHA-3 variants. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02577.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Hash Algorithm in BenchmarkTest02577\n\nThe hash algorithm is loaded from a properties file at runtime via benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"). While the default is SHA-512 (secure), the algorithm can be changed via configuration to a weak algorithm like MD5 or SHA-1 without code changes, creating a potential security misconfiguration vulnerability.\n\nImpact: If the properties file is modified to specify a weak algorithm (MD5, SHA-1), the system would use cryptographically broken hashing without any code-level protection.\n\nFix: Hardcode a strong hash algorithm (SHA-256 or stronger) in the code rather than loading it from configuration. If configuration is required, validate that only approved strong algorithms are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02670.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - SHA-1\n\nThe code uses SHA-1 hashing algorithm via MessageDigest.getInstance(\"SHA1\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations. Collision attacks against SHA-1 are practical, allowing attackers to create different inputs that produce the same hash value.\n\nImpact: An attacker can exploit SHA-1 weaknesses to create hash collisions, potentially bypassing authentication mechanisms, forging digital signatures, or compromising data integrity checks that rely on SHA-1 hashes.\n\nFix: Replace SHA-1 with SHA-256 or stronger: use MessageDigest.getInstance(\"SHA-256\") or SHA-512. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2 instead of general-purpose hash functions.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02671.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - SHA-1\n\nThe code uses SHA-1 (SHA1) hashing algorithm via MessageDigest.getInstance(\"SHA1\"). SHA-1 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could potentially perform collision attacks or reverse the hash to recover sensitive data. SHA-1 is considered weak and vulnerable to collision attacks.\n\nFix: Use a strong hashing algorithm like SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02674.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - MD5\n\nThe code uses MD5 hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could easily perform collision attacks or use rainbow tables to reverse MD5 hashes. MD5 is fundamentally broken for cryptographic purposes.\n\nFix: Use a strong hashing algorithm like SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02675.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Weak Hash Algorithm - MD5\n\nThe code uses MD5 hashing algorithm via MessageDigest.getInstance(\"MD5\"). MD5 is cryptographically broken and should not be used for security-sensitive operations like password hashing.\n\nImpact: An attacker could easily perform collision attacks or use rainbow tables to reverse MD5 hashes. MD5 is fundamentally broken for cryptographic purposes.\n\nFix: Use a strong hashing algorithm like SHA-256, SHA-384, SHA-512, or SHA-3. For password hashing specifically, use bcrypt, scrypt, PBKDF2, or Argon2.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_328.CWE-328",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02677.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Runtime-Configured Weak Hash Algorithm\n\nThe hashing algorithm is loaded from a properties file at runtime. The algorithm name comes from benchmarkprops.getProperty(\"hashAlg1\", \"SHA512\"), making it configurable. If the properties file is modified to specify a weak algorithm like MD5 or SHA-1, the system becomes vulnerable.\n\nImpact: An attacker who can modify the properties file could configure the system to use a weak hashing algorithm, making password hashes vulnerable to collision attacks or brute force.\n\nFix: Hardcode a strong hashing algorithm in the code rather than loading it from configuration. If configuration is required, validate that only approved strong algorithms (SHA-256, SHA-384, SHA-512, SHA-3) are accepted.",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-328"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02709.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe application explicitly sets the secure flag to false on a cookie. This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or other security compromises.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: cookie.setSecure(true);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    },
    {
      "check_id": "cwe_614.CWE-614",
      "path": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest02710.java",
      "start": {
        "line": 1,
        "col": 1
      },
      "end": {
        "line": 1,
        "col": 100
      },
      "extra": {
        "message": "Insecure Cookie - Missing Secure Flag\n\nThe application explicitly sets the secure flag to false on a cookie. This allows the cookie to be transmitted over unencrypted HTTP connections, exposing it to interception by attackers performing man-in-the-middle attacks.\n\nImpact: An attacker on the network could intercept the cookie value during transmission over HTTP, potentially leading to session hijacking or other security compromises.\n\nFix: Set the secure flag to true to ensure the cookie is only transmitted over HTTPS: cookie.setSecure(true);",
        "severity": "MEDIUM",
        "metadata": {
          "cwe": [
            "CWE-614"
          ],
          "owasp": "A6: Sensitive Data Exposure"
        }
      }
    }
  ]
}